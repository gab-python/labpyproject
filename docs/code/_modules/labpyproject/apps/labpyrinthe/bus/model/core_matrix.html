

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>labpyproject.apps.labpyrinthe.bus.model.core_matrix &mdash; Documentation labpyproject </title>
  

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home" alt="Documentation Home"> labpyproject
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../labpyproject.html">labpyproject</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../labpyproject.apps.html">labpyproject.apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.html">labpyproject.apps.labpyrinthe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.html">labpyproject.apps.labpyrinthe.app</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.app_types.html">app_types</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.app_types.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.app.app_types.AppTypes.html">AppTypes</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.app_types.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.application.html">application</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.application.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.app.application.AppManager.html">AppManager</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.app.application.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.html">labpyproject.apps.labpyrinthe.bus</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.html">labpyproject.apps.labpyrinthe.bus.commands</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html">cmd_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.CommandHelper.html">CommandHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html">cmd_manager</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.CommandManager.html">CommandManager</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html">gamble_datas</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleDataSet.html">GambleDataSet</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleDataObject.html">GambleDataObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.PseudoActions.html">PseudoActions</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleSearch.html">GambleSearch</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html">targets</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetObject.html">TargetObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetPath.html">TargetPath</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetPathStep.html">TargetPathStep</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.html">labpyproject.apps.labpyrinthe.bus.helpers</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html">exchange_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.ExchangeHelper.html">ExchangeHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html">game_configuration</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.GameConfiguration.html">GameConfiguration</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html">lab_generator</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.LabGenerator.html">LabGenerator</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html">lab_manager</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.LabManager.html">LabManager</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html">lab_parser</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.LabParser.html">LabParser</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.html">labpyproject.apps.labpyrinthe.bus.model</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html">core_matrix</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html">LabHelper</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html">LabLevel</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html">Matrice</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html">AnimatedLayer</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html">Case</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html">CaseRobot</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html">CaseDanger</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade.html">CaseGrenade</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html">CaseAnimation</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html">CaseBonus</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.player.html">player</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.player.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.player.LabPlayer.html">LabPlayer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.model.player.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html">game_manager</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.game_manager.GameManager.html">GameManager</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.html">labpyproject.apps.labpyrinthe.gui</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.html">labpyproject.apps.labpyrinthe.gui.skinBase</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html">GUIBase</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBase.html">GUIBase</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBaseNoThread.html">GUIBaseNoThread</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBaseThreaded.html">GUIBaseThreaded</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html">colors</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.colors.ColorHelper.html">ColorHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html">interfaces</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneCarte.html">AbstractZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneCommand.html">AbstractZoneCommand</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZonePartie.html">AbstractZonePartie</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneBots.html">AbstractZoneBots</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneMenu.html">AbstractZoneMenu</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractScreenContent.html">AbstractScreenContent</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractScreenWait.html">AbstractScreenWait</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractSwitch.html">AbstractSwitch</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractInput.html">AbstractInput</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html">screen_wait_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.ScreenWaitBase.html">ScreenWaitBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html">skin_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.SkinBase.html">SkinBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html">zone_bots_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.ZoneBotsBase.html">ZoneBotsBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html">zone_carte_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.ZoneCarteBase.html">ZoneCarteBase</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.ItemObjectBase.html">ItemObjectBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html">zone_command_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.ZoneCommandBase.html">ZoneCommandBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html">zone_menu_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.ZoneMenuBase.html">ZoneMenuBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html">zone_partie_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.ZonePartieBase.html">ZonePartieBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.html">labpyproject.apps.labpyrinthe.gui.skinConsole</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html">pub_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.PublicationHelper.html">PublicationHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.html">labpyproject.apps.labpyrinthe.gui.skinPygame</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html">botview</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.botview.BotView.html">BotView</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html">footer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.footer.Footer.html">Footer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html">header</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.header.Header.html">Header</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html">screen_wait</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.ScreenWait.html">ScreenWait</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.ScaledText.html">ScaledText</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.SimplePreloader.html">SimplePreloader</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html">skinPygame</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.SkinPygame.html">SkinPygame</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html">uitools</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WImage.html">WImage</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WText.html">WText</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WEntry.html">WEntry</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WButton.html">WButton</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.Spacer.html">Spacer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html">zone_bots</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.ZoneBots.html">ZoneBots</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.BotList.html">BotList</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.BotItem.html">BotItem</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html">zone_carte</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ZoneCarte.html">ZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ItemObject.html">ItemObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.CaseView.html">CaseView</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.BotViewCarte.html">BotViewCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ZoneDangerRobot.html">ZoneDangerRobot</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html">zone_command</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.ZoneCommand.html">ZoneCommand</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html">zone_menu</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.ZoneMenu.html">ZoneMenu</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.MenuButton.html">MenuButton</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html">zone_partie</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.ZonePartie.html">ZonePartie</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.html">labpyproject.apps.labpyrinthe.gui.skinTkinter</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html">header</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.header.Header.html">Header</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html">screen_wait</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.ScreenWait.html">ScreenWait</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html">skinTkinter</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.SkinTkinter.html">SkinTkinter</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html">uitools</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CustomEntry.html">CustomEntry</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSwitch.html">CanvasSwitch</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasImage.html">CanvasImage</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSpacer.html">CanvasSpacer</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSeparateur.html">CanvasSeparateur</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html">zone_bots</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.ZoneBots.html">ZoneBots</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html">zone_carte</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.ZoneCarte.html">ZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.ItemObject.html">ItemObject</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html">zone_command</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.ZoneCommand.html">ZoneCommand</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html">zone_menu</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.ZoneMenu.html">ZoneMenu</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html">zone_partie</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.ZonePartie.html">ZonePartie</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html">GUIConsole</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.GUIConsole.GUIConsole.html">GUIConsole</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.GUIConsole.ThreadInput.html">ThreadInput</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html">GUIPygame</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.GUIPygame.GUIPygame.html">GUIPygame</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html">GUITk</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../../../api/labpyproject.apps.labpyrinthe.gui.GUITk.GUITk.html">GUITk</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.clientConsole.html">clientConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.clientPygame.html">clientPygame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.serverConsole.html">serverConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.standaloneConsole.html">standaloneConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.standalonePygame.html">standalonePygame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.apps.labpyrinthe.standaloneTkinter.html">standaloneTkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../labpyproject.core.html">labpyproject.core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.app.html">labpyproject.core.app</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.app.app_components.html">app_components</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.app.app_components.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.ThreadableComp.html">ThreadableComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.APPComp.html">APPComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.SatelliteExchangeObject.html">SatelliteExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.AbstractSatelliteComp.html">AbstractSatelliteComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.DelayedAction.html">DelayedAction</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.SatelliteComp.html">SatelliteComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.SatelliteCompNoThread.html">SatelliteCompNoThread</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.GUIExchangeObject.html">GUIExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.AbstractGUIComp.html">AbstractGUIComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.GUIComp.html">GUIComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.GUICompNoThread.html">GUICompNoThread</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.NETExchangeObject.html">NETExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.NETComp.html">NETComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.app.app_components.BUSINESSComp.html">BUSINESSComp</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.app.app_components.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.io.html">labpyproject.core.io</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.io.custom_IO.html">custom_IO</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.io.custom_IO.html#functions">Functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.io.custom_IO.get_file_list.html">get_file_list</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.io.custom_IO.load_obj_from_file.html">load_obj_from_file</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.io.custom_IO.load_text_file.html">load_text_file</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.io.custom_IO.save_obj_in_file.html">save_obj_in_file</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.net.html">labpyproject.core.net</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.net.custom_TCP.html">custom_TCP</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.net.custom_TCP.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.CustomTCPServerContainer.html">CustomTCPServerContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.ThreadedTCPServer.html">ThreadedTCPServer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.CustomTCPRequestHandler.html">CustomTCPRequestHandler</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.ParseDataError.html">ParseDataError</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.CustomRequestHelper.html">CustomRequestHelper</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.net.custom_TCP.CustomTCPThreadedClient.html">CustomTCPThreadedClient</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.net.custom_TCP.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.patterns.html">labpyproject.core.patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.patterns.design_patterns.html">design_patterns</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.patterns.design_patterns.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.patterns.design_patterns.Singleton.html">Singleton</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.patterns.design_patterns.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.html">labpyproject.core.pygame</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.core.html">core</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.core.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.BoxModelObject.html">BoxModelObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.MetricValue.html">MetricValue</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html">BoundedMetricValue</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.VirtualItem.html">VirtualItem</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.VirtualContainer.html">VirtualContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.CustomSprite.html">CustomSprite</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.RealContainer.html">RealContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.RootContainer.html">RootContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.LayerManager.html">LayerManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.LayerStack.html">LayerStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.core.LocalLayer.html">LocalLayer</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.core.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.events.html">events</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.events.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.events.CustomEventManager.html">CustomEventManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.events.GUIEventManager.html">GUIEventManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.events.CustomBaseControl.html">CustomBaseControl</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.events.CustomBaseInput.html">CustomBaseInput</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.events.CustomBaseButton.html">CustomBaseButton</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.events.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.widgets.html">widgets</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.widgets.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Background.html">Background</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Image.html">Image</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Text.html">Text</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Entry.html">Entry</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.TextButton.html">TextButton</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Button.html">Button</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Stack.html">Stack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.HStack.html">HStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.VStack.html">VStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Canvas.html">Canvas</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.HBox.html">HBox</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.VBox.html">VBox</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.pygame.widgets.Root.html">Root</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.pygame.widgets.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.queue.html">labpyproject.core.queue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.queue.queue_tools.html">queue_tools</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.queue.queue_tools.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.queue.queue_tools.QueueManager.html">QueueManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.queue.queue_tools.QueueSimpleClient.html">QueueSimpleClient</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.queue.queue_tools.QueueSwitcher.html">QueueSwitcher</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.queue.queue_tools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../../labpyproject.core.random.html">labpyproject.core.random</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../labpyproject.core.random.custom_random.html">custom_random</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.random.custom_random.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../../../api/labpyproject.core.random.custom_random.CustomRandom.html">CustomRandom</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../../labpyproject.core.random.custom_random.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">labpyproject</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../../index.html">Code du module</a> &raquo;</li>
        
      <li>labpyproject.apps.labpyrinthe.bus.model.core_matrix</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Code source de labpyproject.apps.labpyrinthe.bus.model.core_matrix</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Données de modélisation et services statiques :</span>

<span class="sd">    * LabHelper : Helper statique portant des données de modélisation</span>

<span class="sd">Part géométrique de la modélisation du jeu :</span>

<span class="sd">    * LabLevel : modélise le labyrinthe (pile de matrices &amp; couches animées)</span>
<span class="sd">    * Matrice : modélise une couche  de cases (avec gestion de cache)</span>
<span class="sd">    * AnimatedLayer : couche dédiée aux animations</span>
<span class="sd">    * Case : classe de base d&#39;une case</span>
<span class="sd">    * CaseRobot, CaseDanger, CaseGrenade, CaseAnimation, CaseBonus : subclasses de Case</span>

<span class="sd">.. note::</span>
<span class="sd">   Idéalement ce module aurait été découpé mais des problèmes d&#39;import circulaire</span>
<span class="sd">   (et le manque de temps pour créer des pseudos interfaces via abc.ABCMeta) imposent</span>
<span class="sd">   cette forme.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># imports :</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">attrgetter</span><span class="p">,</span> <span class="n">itemgetter</span>
<span class="kn">import</span> <span class="nn">labpyproject.core.random.custom_random</span> <span class="k">as</span> <span class="nn">cr</span>

<span class="c1"># Evite l&#39;ajout non désiré de certains imports à la doc sphinx</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;LabHelper&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LabLevel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Matrice&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AnimatedLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Case&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CaseRobot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CaseDanger&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CaseGrenade&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CaseAnimation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CaseBonus&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="c1"># classes</span>
<div class="viewcode-block" id="LabHelper"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper">[docs]</a><span class="k">class</span> <span class="nc">LabHelper</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper statique</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#-----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Variables statiques</span>
    <span class="c1">#-----------------------------------------------------------------------------------------------</span>
    <span class="c1"># rôles des différentes cases :</span>
    <span class="n">CASE_VIDE</span> <span class="o">=</span> <span class="s2">&quot;vide&quot;</span>  <span class="c1">#: identifie une case vide</span>
    <span class="n">CASE_MUR</span> <span class="o">=</span> <span class="s2">&quot;mur&quot;</span>  <span class="c1">#: identifie une case mur</span>
    <span class="n">CASE_MUR_PERIMETRE</span> <span class="o">=</span> <span class="s2">&quot;mur_perimetre&quot;</span>  <span class="c1">#: identifie une case mur de périmètre</span>
    <span class="n">CASE_PORTE</span> <span class="o">=</span> <span class="s2">&quot;porte&quot;</span>  <span class="c1">#: identifie une case porte</span>
    <span class="n">CASE_SORTIE</span> <span class="o">=</span> <span class="s2">&quot;sortie&quot;</span>  <span class="c1">#: identifie une case sortie</span>
    <span class="n">CASE_ROBOT</span> <span class="o">=</span> <span class="s2">&quot;robot&quot;</span>  <span class="c1">#: identifie une case robot</span>
    <span class="n">CASE_BONUS</span> <span class="o">=</span> <span class="s2">&quot;bonus&quot;</span>  <span class="c1">#: identifie une case bonus</span>
    <span class="n">CASE_DANGER</span> <span class="o">=</span> <span class="s2">&quot;danger&quot;</span>  <span class="c1">#: identifie une case danger</span>
    <span class="n">CASE_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;grenade&quot;</span>  <span class="c1">#: identifie une case grenade</span>
    <span class="n">CASE_ANIMATION</span> <span class="o">=</span> <span class="s2">&quot;animation&quot;</span>  <span class="c1">#: identifie une case animation</span>
    <span class="n">CASE_TARGET</span> <span class="o">=</span> <span class="s2">&quot;target&quot;</span>  <span class="c1">#: identifie une case cible</span>
    <span class="n">CASE_DEBUG</span> <span class="o">=</span> <span class="s2">&quot;debug&quot;</span>  <span class="c1">#: identifie une case de debug</span>
    <span class="n">FULL_CASETYPES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_MUR</span><span class="p">,</span>
        <span class="n">CASE_MUR_PERIMETRE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
        <span class="n">CASE_ROBOT</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
        <span class="n">CASE_DANGER</span><span class="p">,</span>
        <span class="n">CASE_GRENADE</span><span class="p">,</span>
        <span class="n">CASE_ANIMATION</span><span class="p">,</span>
        <span class="n">CASE_TARGET</span><span class="p">,</span>
        <span class="n">CASE_DEBUG</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: liste des types de cases supportés</span>
    <span class="c1"># liste des cases avec notion de z-index :</span>
    <span class="n">ZINDEX_CASE_LIST</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_MUR_PERIMETRE</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_SORTIE</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_VIDE</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_PORTE</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_MUR</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_DANGER</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_BONUS</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_ROBOT</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_GRENADE</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_ANIMATION</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_TARGET</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;typecase&quot;</span><span class="p">:</span> <span class="n">CASE_DEBUG</span><span class="p">},</span>
    <span class="p">)</span>  <span class="c1">#: répartition des types de cases par zindex</span>
    <span class="c1"># change log : liste des zindexs pour la génération de clef de comparaison (réseau)</span>
    <span class="c1"># couches de sortie à robots inclus</span>
    <span class="n">ZINDEX_LOGS_KEY</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span>
    <span class="p">)</span>  <span class="c1">#: liste réduite de zindex pour la génération de clefs de cohérence</span>
    <span class="c1"># interdépendances entre types de cases :</span>
    <span class="n">LINKED_CASETYPES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR_PERIMETRE</span><span class="p">,</span>
        <span class="n">CASE_MUR</span><span class="p">,</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: cases interdépendantes</span>
    <span class="c1"># liste réduite des cases pour création de cartes texte à parser</span>
    <span class="n">LIMITED_CASETYPES</span> <span class="o">=</span> <span class="n">LINKED_CASETYPES</span>  <span class="c1">#: liste réduite de types de cases pour la génération de carte texte</span>
    <span class="c1"># Types de cases à exclure des changelogs d&#39;étape :</span>
    <span class="n">STEP_CHANGE_LOGS_EXCLUDED</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_ANIMATION</span>
    <span class="p">]</span>  <span class="c1">#: types de cases à exclure des changelogs d&#39;étapes</span>
    <span class="c1"># Liste des zindexs pour la recherche de cases de mêmes coords :</span>
    <span class="c1"># couches de sortie à robots inclus</span>
    <span class="n">ZINDEX_COORDS_SEARCH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span>
    <span class="p">)</span>  <span class="c1">#: liste des zindexs pour la recherche de cases superposées</span>
    <span class="c1"># autres variables liées aux cases</span>
    <span class="n">FAMILLE_CASES_LIBRES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases libres</span>
    <span class="n">FAMILLE_CASES_DANGERS</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_DANGER</span><span class="p">]</span>  <span class="c1">#: famille de cases dangers</span>
    <span class="n">FAMILLE_CASES_RISQUES</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_DANGER</span><span class="p">,</span> <span class="n">CASE_ROBOT</span><span class="p">]</span>  <span class="c1">#: famille de cases risquées</span>
    <span class="n">FAMILLE_CASES_ADVERSAIRES</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_ROBOT</span><span class="p">]</span>  <span class="c1">#: famille de cases adversaires</span>
    <span class="n">FAMILLE_CASES_BONUS</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_BONUS</span><span class="p">]</span>  <span class="c1">#: famille de cases bonus</span>
    <span class="n">FAMILLE_CASES_MURS</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_MUR</span><span class="p">]</span>  <span class="c1">#: famille de cases mur</span>
    <span class="n">FAMILLE_CASES_PERIMETRE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR_PERIMETRE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases périmètre</span>
    <span class="n">FAMILLE_CASES_NO_ACTION</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR_PERIMETRE</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases ne pouvant subir d&#39;action</span>
    <span class="n">FAMILLE_CASES_UNDELETABLE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_MUR_PERIMETRE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
        <span class="n">CASE_ROBOT</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases indestructibles</span>
    <span class="n">FAMILLE_CASES_NO_ANIMATION</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR_PERIMETRE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases non animées</span>
    <span class="n">FAMILLE_TARGET</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
        <span class="n">CASE_MUR</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases cibles</span>
    <span class="n">FAMILLE_NO_TARGET</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_MUR_PERIMETRE</span><span class="p">]</span>  <span class="c1">#: famille de cases non cibles</span>
    <span class="n">FAMILLE_DESTRUCTION</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR</span><span class="p">,</span>
        <span class="n">CASE_ROBOT</span><span class="p">,</span>
        <span class="n">CASE_DANGER</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases destructibles</span>
    <span class="n">FAMILLE_MOVE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_SORTIE</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
        <span class="n">CASE_DANGER</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases sur lesquelles on peut bouger</span>
    <span class="n">FAMILLE_BUILD_DOOR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_MUR</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases sur lesquelles contruire une porte</span>
    <span class="n">FAMILLE_BUILD_WALL</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases sur lesquelles construire un mur</span>
    <span class="n">FAMILLE_KILL</span> <span class="o">=</span> <span class="p">[</span><span class="n">CASE_ROBOT</span><span class="p">]</span>  <span class="c1">#: famille de cases pouvant être tuées</span>
    <span class="n">FAMILLE_GRENADE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_ROBOT</span><span class="p">,</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
        <span class="n">CASE_MUR</span><span class="p">,</span>
        <span class="n">CASE_DANGER</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases pouvant recevoir une grenade</span>
    <span class="n">FAMILLE_MINE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_VIDE</span><span class="p">,</span>
        <span class="n">CASE_PORTE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases pouvant recevoir une mine</span>
    <span class="n">FAMILLE_EXPORT_DICT</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CASE_ROBOT</span><span class="p">,</span>
        <span class="n">CASE_BONUS</span><span class="p">,</span>
        <span class="n">CASE_DANGER</span><span class="p">,</span>
        <span class="n">CASE_GRENADE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: famille de cases à exporter par dict</span>
    <span class="n">TYPE_CASES_LIBRES</span> <span class="o">=</span> <span class="s2">&quot;TYPE_CASES_LIBRES&quot;</span>  <span class="c1">#: type de la famille FAMILLE_CASES_LIBRES</span>
    <span class="n">TYPE_CASES_RISQUES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;TYPE_CASES_RISQUES&quot;</span>  
    <span class="p">)</span> <span class="c1">#: type de la famille FAMILLE_CASES_RISQUES</span>
    <span class="n">TYPE_CASES_ADVERSAIRES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;TYPE_CASES_ADVERSAIRES&quot;</span>  
    <span class="p">)</span> <span class="c1">#: type de la famille FAMILLE_CASES_ADVERSAIRES</span>
    <span class="n">TYPE_CASES_BONUS</span> <span class="o">=</span> <span class="s2">&quot;TYPE_CASES_BONUS&quot;</span>  <span class="c1">#: type de la famille FAMILLE_CASES_BONUS</span>
    <span class="n">TYPE_CASES_DANGERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;TYPE_CASES_DANGERS&quot;</span>  
    <span class="p">)</span> <span class="c1">#: type de la famille FAMILLE_CASES_DANGERS</span>
    <span class="n">TYPE_CASES_MURS</span> <span class="o">=</span> <span class="s2">&quot;TYPE_CASES_MURS&quot;</span>  <span class="c1">#: type de la famille FAMILLE_CASES_MURS</span>
    <span class="n">TYPE_CASES_PERIMETRE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;TYPE_CASES_PERIMETRE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: type de la famille FAMILLE_CASES_PERIMETRE</span>
    <span class="n">TYPE_CASES_NO_ACTION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;TYPE_CASES_NO_ACTION&quot;</span>  
    <span class="p">)</span> <span class="c1">#: type de la famille FAMILLE_CASES_NO_ACTION</span>
    <span class="c1"># clefs de mesure</span>
    <span class="n">NOMBRE_CASES_LIBRES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;NOMBRE_CASES_LIBRES&quot;</span>  
    <span class="p">)</span> <span class="c1">#: clef de mesure nombre de cases libres</span>
    <span class="n">DELTA_MAIN</span> <span class="o">=</span> <span class="s2">&quot;DELTA_MAIN&quot;</span>  <span class="c1">#: clef de mesure distance à la cible principale</span>
    <span class="c1"># géométrie</span>
    <span class="n">AXIS_X</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>  <span class="c1">#: axe x</span>
    <span class="n">AXIS_Y</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>  <span class="c1">#: axe y</span>
    <span class="n">DIR_POS</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1">#: sens +</span>
    <span class="n">DIR_NEG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1">#: sens -</span>
    <span class="c1"># paramètres liés aux extras</span>
    <span class="n">BONUS_DENSITE</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1">#: densité de bonus (par défaut)</span>
    <span class="n">DANGER_DENSITE</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1">#: densité de mines (par défaut)</span>
    <span class="c1"># animations :</span>
    <span class="n">CHAR_REPR_EXPLOSION</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion</span>
    <span class="n">CHAR_REPR_EXPLOSION_1</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 1</span>
    <span class="n">CHAR_REPR_EXPLOSION_2</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 2</span>
    <span class="n">CHAR_REPR_EXPLOSION_3</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 3</span>
    <span class="n">CHAR_REPR_EXPLOSION_4</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 4</span>
    <span class="n">CHAR_REPR_EXPLOSION_5</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 5</span>
    <span class="n">CHAR_REPR_EXPLOSION_6</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>  <span class="c1">#: caractère d&#39;affichage explosion 6</span>
    <span class="n">ANIMATION_EXPLOSION_FACES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CHAR_REPR_EXPLOSION_1</span><span class="p">,</span>
        <span class="n">CHAR_REPR_EXPLOSION_2</span><span class="p">,</span>
        <span class="n">CHAR_REPR_EXPLOSION_3</span><span class="p">,</span>
        <span class="n">CHAR_REPR_EXPLOSION_4</span><span class="p">,</span>
        <span class="n">CHAR_REPR_EXPLOSION_5</span><span class="p">,</span>
        <span class="n">CHAR_REPR_EXPLOSION_6</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: liste des caractères d&#39;affichage d&#39;explosion</span>
    <span class="c1"># ANIMATION_STEP_DURATION = 1 / 8</span>
    <span class="n">ANIMATION_MOVE_DURATION</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1">#: durée d&#39;un déplacement d&#39;une case (secondes)</span>
    <span class="n">ANIMATION_FACE_DURATION</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span>  <span class="c1">#: durée d&#39;un changement d&#39;apparence (secondes)</span>
    <span class="c1"># tempos :</span>
    <span class="n">GAMBLE_TEMPO</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">12</span>  <span class="c1">#: deprecated</span>
    <span class="c1"># scénarios d&#39;animation pris en charge</span>
    <span class="n">ANIMATION_SCENARIO</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1">#: scénarios d&#39;animations</span>
    <span class="n">ANIMATION_SCENARIO</span><span class="p">[</span><span class="s2">&quot;EXPLOSION&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;EXPLOSION&quot;</span>  <span class="c1">#: scénarios d&#39;animations</span>
    <span class="c1"># résolution d&#39;animation : case (défaut) ou pixels (si GUI graphique)</span>
    <span class="n">ANIMATION_RESOLUTION_CASE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;ANIMATION_RESOLUTION_CASE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: gui console mouvement case à case obligatoire</span>
    <span class="n">ANIMATION_RESOLUTION_PIXEL</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;ANIMATION_RESOLUTION_PIXEL&quot;</span>  
    <span class="p">)</span> <span class="c1">#: gui graphique mouvement en pixel possible</span>
    <span class="n">ANIMATION_RESOLUTION</span> <span class="o">=</span> <span class="n">ANIMATION_RESOLUTION_CASE</span>  <span class="c1">#: résolution d&#39;animation</span>
    <span class="c1"># caractères associés aux rôles dans les fichiers txt des cartes (valeurs par défaut)</span>
    <span class="n">CHAR_TXT_VIDE</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>  <span class="c1">#: caractère de parsing case vide</span>
    <span class="n">CHAR_TXT_MUR</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span>  <span class="c1">#: caractère de parsing mur</span>
    <span class="n">CHAR_TXT_PORTE</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>  <span class="c1">#: caractère de parsing porte</span>
    <span class="n">CHAR_TXT_SORTIE</span> <span class="o">=</span> <span class="s2">&quot;u&quot;</span>  <span class="c1">#: caractère de parsing sortie</span>
    <span class="n">CHAR_TXT_ROBOT</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>  <span class="c1">#: deprecated</span>
    <span class="n">CHAR_TXT_DANGER</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span>  <span class="c1">#: deprecated</span>
    <span class="n">CHAR_TXT_BONUS</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>  <span class="c1">#: deprecated</span>
    <span class="n">CHAR_TXT_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span>  <span class="c1">#: deprecated</span>
    <span class="c1"># caractères d&#39;affichage des différents rôles (valeurs par défaut)</span>
    <span class="n">CHAR_REPR_VIDE</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>  <span class="c1">#: caractère d&#39;affichage case vide</span>
    <span class="n">CHAR_REPR_MUR</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">9608</span><span class="p">)</span>  <span class="c1">#: caractère d&#39;affichage mur</span>
    <span class="n">CHAR_REPR_PORTE</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">9618</span><span class="p">)</span>  <span class="c1">#: caractère d&#39;affichage porte</span>
    <span class="n">CHAR_REPR_SORTIE</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>  <span class="c1">#: caractère d&#39;affichage sortie</span>
    <span class="n">CHAR_REPR_ROBOT</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span>  <span class="c1">#: caractère d&#39;affichage robot</span>
    <span class="n">CHAR_REPR_DANGER</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>  <span class="c1">#: caractère d&#39;affichage mine</span>
    <span class="n">CHAR_REPR_BONUS</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>  <span class="c1">#: caractère d&#39;affichage bonus</span>
    <span class="n">CHAR_REPR_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>  <span class="c1">#: caractère d&#39;affichage grenade</span>
    <span class="n">CHAR_REPR_TARGET</span> <span class="o">=</span> <span class="s2">&quot;$&quot;</span>  <span class="c1">#: caractère d&#39;affichage cible</span>
    <span class="c1"># en multi joueur les char_repr des robots sont gérés au niveau supérieur</span>
    <span class="c1"># Directions :</span>
    <span class="n">LEFT</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>  <span class="c1">#: identifie la direction gauche</span>
    <span class="n">RIGHT</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>  <span class="c1">#: identifie la direction droite</span>
    <span class="n">TOP</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>  <span class="c1">#: identifie la direction haut</span>
    <span class="n">BOTTOM</span> <span class="o">=</span> <span class="s2">&quot;bottom&quot;</span>  <span class="c1">#: identifie la direction bas</span>
    <span class="n">LIST_DIRECTIONS</span> <span class="o">=</span> <span class="p">[</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">RIGHT</span><span class="p">,</span> <span class="n">TOP</span><span class="p">,</span> <span class="n">BOTTOM</span><span class="p">]</span>  <span class="c1">#: liste des ids de directions</span>
    <span class="c1"># Caractères de commandes (valeurs par défaut)</span>
    <span class="n">CHAR_LEFT</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span>  <span class="c1">#: caractère de commande gauche</span>
    <span class="n">CHAR_RIGHT</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span>  <span class="c1">#: caractère de commande droite</span>
    <span class="n">CHAR_TOP</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>  <span class="c1">#: caractère de commande haut</span>
    <span class="n">CHAR_BOTTOM</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>  <span class="c1">#: caractère de commande bas</span>
    <span class="n">CHAR_HELP</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span>  <span class="c1">#: caractère de commande aide</span>
    <span class="n">CHAR_MENU</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>  <span class="c1">#: caractère de commande menu</span>
    <span class="n">CHAR_QUIT</span> <span class="o">=</span> <span class="s2">&quot;q&quot;</span>  <span class="c1">#: caractère de commande quitter</span>
    <span class="n">CHAR_MUR</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>  <span class="c1">#: caractère de commande construire mur</span>
    <span class="n">CHAR_PORTE</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>  <span class="c1">#: caractère de commande construire porte</span>
    <span class="n">CHAR_START</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>  <span class="c1">#: caractère de commande commencer la partie</span>
    <span class="n">CHAR_RESET_QUEUE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;r&quot;</span>  
    <span class="p">)</span> <span class="c1">#: caractère de commande effacer les commandes (non implémenté)</span>
    <span class="n">CHAR_KILL</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span>  <span class="c1">#: caractère de commande tuer un voisin</span>
    <span class="n">CHAR_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span>  <span class="c1">#: caractère de commande lancer de grenade</span>
    <span class="n">CHAR_MINE</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>  <span class="c1">#: caractère de commande poser une mine</span>
    <span class="c1"># commandes générales</span>
    <span class="n">ACTION_HELP</span> <span class="o">=</span> <span class="s2">&quot;ACTION_HELP&quot;</span>  <span class="c1">#: identifie la commande globale aide</span>
    <span class="n">ACTION_MENU</span> <span class="o">=</span> <span class="s2">&quot;ACTION_MENU&quot;</span>  <span class="c1">#: identifie la commande globale menu</span>
    <span class="n">ACTION_QUIT</span> <span class="o">=</span> <span class="s2">&quot;ACTION_QUIT&quot;</span>  <span class="c1">#: identifie la commande globale quitter</span>
    <span class="n">ACTION_START</span> <span class="o">=</span> <span class="s2">&quot;ACTION_START&quot;</span>  <span class="c1">#: identifie la commande globale commencer</span>
    <span class="n">ACTION_RESET_QUEUE</span> <span class="o">=</span> <span class="s2">&quot;ACTION_RESET_QUEUE&quot;</span>  <span class="c1">#: identifie la commande globale effacer les commandes (non implémenté)</span>
    <span class="c1"># commandes de robot :</span>
    <span class="n">ACTION_MOVE</span> <span class="o">=</span> <span class="s2">&quot;ACTION_MOVE&quot;</span>  <span class="c1">#: identifie la commande se déplacer</span>
    <span class="n">ACTION_CREATE_DOOR</span> <span class="o">=</span> <span class="s2">&quot;ACTION_CREATE_DOOR&quot;</span>  <span class="c1">#: identifie la commande créer une porte</span>
    <span class="n">ACTION_CREATE_WALL</span> <span class="o">=</span> <span class="s2">&quot;ACTION_CREATE_WALL&quot;</span>  <span class="c1">#: identifie la commande créer un mur</span>
    <span class="n">ACTION_KILL</span> <span class="o">=</span> <span class="s2">&quot;ACTION_KILL&quot;</span>  <span class="c1">#: identifie la commande tuer</span>
    <span class="n">ACTION_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;ACTION_GRENADE&quot;</span>  <span class="c1">#: identifie la commande lancer de grenade</span>
    <span class="n">ACTION_MINE</span> <span class="o">=</span> <span class="s2">&quot;ACTION_MINE&quot;</span>  <span class="c1">#: identifie la commande poser une mine</span>
    <span class="c1"># regexp des commandes liées au jeu :</span>
    <span class="n">REGEXP_GAME</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="s2">&quot;gamecmd=[A-Za-z0-9_]+&amp;?&quot;</span>
    <span class="p">)</span>  <span class="c1">#: expression régulière d&#39;une commande à parser</span>
    <span class="n">REGEXP_SEQ_LIST</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="s2">&quot;\[[A-Za-z0-9_\.,\+\-]*\]&quot;</span>
    <span class="p">)</span>  <span class="c1">#: expression régulière liste</span>
    <span class="n">REGEXP_SEQ_TUPLE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="s2">&quot;\([A-Za-z0-9_\.,\+\-]*\)&quot;</span>
    <span class="p">)</span>  <span class="c1">#: expression régulière tuple</span>
    <span class="n">REGEXP_SEQ_DICT</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="s2">&quot;\{[A-Za-z0-9_\.,:\+\-#]*\}&quot;</span>
    <span class="p">)</span>  <span class="c1">#: expression régulière dict</span>
    <span class="n">REGEXP_INT</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;0</span><span class="si">{1}</span><span class="s2">|^[1-9]</span><span class="si">{1}</span><span class="s2">[0-9]*&quot;</span><span class="p">)</span>  <span class="c1">#: expression régulière int</span>
    <span class="n">REGEXP_FLOAT</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;[0-9]</span><span class="si">{1}</span><span class="s2">\.[0-9]*&quot;</span><span class="p">)</span>  <span class="c1">#: expression régulière float</span>
    <span class="c1"># distances considérées pour les mesures de densité</span>
    <span class="n">DENSITE_LARGEUR</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1">#: largeur par défaut pour les mesures de densité</span>
    <span class="n">DENSITE_PROFONDEUR</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1">#: hauteur par défaut pour les mesures de densités</span>
    <span class="c1">#-----&gt; Paramétrage : setter</span>
<div class="viewcode-block" id="LabHelper.set_navigation_chars"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.set_navigation_chars">[docs]</a>    <span class="k">def</span> <span class="nf">set_navigation_chars</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifie les caractères de navigation par défaut</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **params : un dict {&quot;left&quot;:char, ...}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cle</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_LEFT</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_RIGHT</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TOP</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_BOTTOM</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;aide&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_HELP</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;menu&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_MENU</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;quitter&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_QUIT</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;mur&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_MUR</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;porte&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_PORTE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_START</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;reset_queue&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_RESET_QUEUE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;kill&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_KILL</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;grenade&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_GRENADE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;mine&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_MINE</span> <span class="o">=</span> <span class="n">val</span></div>

    <span class="n">set_navigation_chars</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">set_navigation_chars</span><span class="p">)</span>

<div class="viewcode-block" id="LabHelper.set_parsing_chars"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.set_parsing_chars">[docs]</a>    <span class="k">def</span> <span class="nf">set_parsing_chars</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifie les caractères à identifier lors du parsing des cartes txt</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **params : un dict {&quot;vide&quot;:char, ...}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cle</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;vide&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_VIDE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;mur&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_MUR</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;porte&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_PORTE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;sortie&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_SORTIE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;robot&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_ROBOT</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;danger&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_DANGER</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;bonus&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_BONUS</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;grenade&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_GRENADE</span> <span class="o">=</span> <span class="n">val</span></div>

    <span class="n">set_parsing_chars</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">set_parsing_chars</span><span class="p">)</span>

<div class="viewcode-block" id="LabHelper.set_graphic_chars"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.set_graphic_chars">[docs]</a>    <span class="k">def</span> <span class="nf">set_graphic_chars</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifie les caractères d&#39;affichages des cartes</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **params : un dict {&quot;vide&quot;:char, ...}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cle</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;vide&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_VIDE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;mur&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_MUR</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;porte&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_PORTE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;sortie&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_SORTIE</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;robot&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_ROBOT</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;danger&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_DANGER</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;bonus&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_BONUS</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">cle</span> <span class="o">==</span> <span class="s2">&quot;grenade&quot;</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_GRENADE</span> <span class="o">=</span> <span class="n">val</span></div>

    <span class="n">set_graphic_chars</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">set_graphic_chars</span><span class="p">)</span>
    <span class="c1">#-----&gt; Paramétrage : getters</span>
<div class="viewcode-block" id="LabHelper.get_role_of_char"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.get_role_of_char">[docs]</a>    <span class="k">def</span> <span class="nf">get_role_of_char</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le rôle (mur, porte, sortie, vide, robot...) associé à un caractère</span>
<span class="sd">        d&#39;une carte textuelle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_VIDE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_VIDE</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_MUR</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_MUR</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_PORTE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_PORTE</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_SORTIE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_SORTIE</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_ROBOT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_ROBOT</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_DANGER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_DANGER</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_BONUS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_BONUS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    <span class="n">get_role_of_char</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_role_of_char</span><span class="p">)</span>

<div class="viewcode-block" id="LabHelper.get_repr_for_role"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.get_repr_for_role">[docs]</a>    <span class="k">def</span> <span class="nf">get_repr_for_role</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le caractère d&#39;affichage associé à un rôle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_VIDE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_VIDE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_MUR</span> <span class="ow">or</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_MUR_PERIMETRE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_MUR</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_PORTE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_PORTE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_SORTIE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_SORTIE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_ROBOT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_ROBOT</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_DANGER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_DANGER</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_BONUS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_REPR_BONUS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="n">get_repr_for_role</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_repr_for_role</span><span class="p">)</span>

<div class="viewcode-block" id="LabHelper.get_txt_for_role"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.get_txt_for_role">[docs]</a>    <span class="k">def</span> <span class="nf">get_txt_for_role</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le caractère de parsing associé à un rôle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_VIDE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_VIDE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_MUR</span> <span class="ow">or</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_MUR_PERIMETRE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_MUR</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_PORTE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_PORTE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_SORTIE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_SORTIE</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_ROBOT</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_ROBOT</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_DANGER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_DANGER</span>
        <span class="k">elif</span> <span class="n">role</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_BONUS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CHAR_TXT_BONUS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="n">get_txt_for_role</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_txt_for_role</span><span class="p">)</span></div>


<div class="viewcode-block" id="LabLevel"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel">[docs]</a><span class="k">class</span> <span class="nc">LabLevel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Niveau multi-couches (matrices, couches animées) modélisant la carte d&#39;une partie.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Applat complet :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
        <span class="c1"># Applat partiel dédié au parsing :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsing_flat_matrice</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
        <span class="c1"># Indicateur de mise à jour :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_matrice_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Cache de typecase sur l&#39;applat complet :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># cache d&#39;applats :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Couches :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_layers</span><span class="p">()</span>
        <span class="c1"># ref de la sortie :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># log de modifications :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_log_increment</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_level_before_changes</span><span class="p">()</span>

    <span class="c1">#-----&gt; Méthodes de base</span>
    <span class="k">def</span> <span class="nf">_create_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les différentes couches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># init :</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_CASE_LIST</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># couches par type de case</span>
        <span class="k">for</span> <span class="n">zdict</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_CASE_LIST</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span>
            <span class="n">typecase</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;typecase&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ANIMATION</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DEBUG</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span> <span class="o">=</span> <span class="n">AnimatedLayer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">AnimatedLayer</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
        <span class="c1"># liste limitée d&#39;indexs pour parsing :</span>
        <span class="n">limitedtypes</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LIMITED_CASETYPES</span>
        <span class="k">for</span> <span class="n">layermat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">layermat</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">limitedtypes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layermat</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_zindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le zindex de la couche associée à typecase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">zdict</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_CASE_LIST</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span>
            <span class="n">tc</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;typecase&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tc</span> <span class="o">==</span> <span class="n">typecase</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">z</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_typecase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Réciproque de _get_zindex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">zdict</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_CASE_LIST</span><span class="p">:</span>
            <span class="n">zi</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span>
            <span class="n">typecase</span> <span class="o">=</span> <span class="n">zdict</span><span class="p">[</span><span class="s2">&quot;typecase&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">zi</span> <span class="o">==</span> <span class="n">z</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">typecase</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="LabLevel.move_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.move_case">[docs]</a>    <span class="k">def</span> <span class="nf">move_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Déplace une case aux coordonnées nextx, nexty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coords1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="n">coords2</span> <span class="o">=</span> <span class="p">(</span><span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">)</span>
        <span class="c1"># change log :</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coords1</span><span class="p">,</span> <span class="n">coords2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_change_log</span><span class="p">(</span><span class="s2">&quot;move&quot;</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
        <span class="c1"># déplacement :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">case</span><span class="o">.</span><span class="n">type_case</span><span class="p">]</span><span class="o">.</span><span class="n">move_case</span><span class="p">(</span><span class="n">case</span><span class="p">,</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">)</span>
        <span class="c1"># gestion des interdépendances (suppressions, discard de cache) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_dependancies</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">type_case</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="LabLevel.set_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.set_case">[docs]</a>    <span class="k">def</span> <span class="nf">set_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute ou modifie une case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">typecase</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">type_case</span>
        <span class="c1"># debug : à supprimer</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_TARGET</span><span class="p">:</span>
            <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lc</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">delete_case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="c1"># change log :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_change_log</span><span class="p">(</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="p">[(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)])</span>
        <span class="c1"># ajout à la couche concernée :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
        <span class="n">case</span><span class="o">.</span><span class="n">on_case_added</span><span class="p">()</span>
        <span class="c1"># gestion des interdépendances (suppressions, discard de cache) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_dependancies</span><span class="p">(</span><span class="n">typecase</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="c1"># cas particulier des robots :</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ROBOT</span><span class="p">:</span>
            <span class="c1"># on enlève l&#39;éventuel bonus ou danger antérieur</span>
            <span class="n">others</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cases_with_same_coords</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="n">dellist</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">c</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">others</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">type_case</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_BONUS</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DANGER</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">dellist</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete_case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_handle_dependancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prend en charge les interdépendances entre cases (suppression, discard de cache). </span>
<span class="sd">        Les paramètres correspondent à une case crée ou modifiée</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">linkedtypes</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LINKED_CASETYPES</span>
        <span class="n">case_remove</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">list_tc</span> <span class="o">=</span> <span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="n">linkedtypes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="n">linkedtypes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tc</span> <span class="o">!=</span> <span class="n">typecase</span><span class="p">:</span>
                    <span class="n">linkedmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">tc</span><span class="p">]</span>
                    <span class="n">case_remove</span> <span class="o">=</span> <span class="n">linkedmat</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">case_remove</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="c1"># change log :</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_register_change_log</span><span class="p">(</span><span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="n">case_remove</span><span class="p">,</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
                        <span class="c1"># suppression :</span>
                        <span class="n">linkedmat</span><span class="o">.</span><span class="n">delete_case</span><span class="p">(</span><span class="n">case_remove</span><span class="p">)</span>
                        <span class="n">list_tc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span>
        <span class="c1"># Gestion du cache :</span>
        <span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="n">list_tc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_cache</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span>

<div class="viewcode-block" id="LabLevel.get_cases_with_same_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_cases_with_same_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_cases_with_same_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne toutes les cases de même coords que target</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_COORDS_SEARCH</span><span class="p">:</span>
            <span class="n">layermat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layermat</span><span class="p">,</span> <span class="n">Matrice</span><span class="p">):</span>
                <span class="n">matdict</span> <span class="o">=</span> <span class="n">layermat</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">matdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">rset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">matdict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layermat</span><span class="p">,</span> <span class="n">AnimatedLayer</span><span class="p">):</span>
                <span class="n">layset</span> <span class="o">=</span> <span class="n">layermat</span><span class="o">.</span><span class="n">get_set_cases</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">layset</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">rset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">rset</span> <span class="o">=</span> <span class="n">rset</span><span class="o">.</span><span class="n">difference</span><span class="p">({</span><span class="n">target</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">rset</span></div>

<div class="viewcode-block" id="LabLevel.delete_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.delete_case">[docs]</a>    <span class="k">def</span> <span class="nf">delete_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime une case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">typecase</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">type_case</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_UNDELETABLE</span><span class="p">:</span>
            <span class="c1"># change log :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_register_change_log</span><span class="p">(</span><span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="p">[(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)])</span>
            <span class="c1"># suppression :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span><span class="o">.</span><span class="n">delete_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_cache</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span></div>

<div class="viewcode-block" id="LabLevel.mark_case_as_modified"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.mark_case_as_modified">[docs]</a>    <span class="k">def</span> <span class="nf">mark_case_as_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute la case à la liste &quot;add&quot; des changelogs d&#39;étape</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">case</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cases_added&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cases_added&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case</span><span class="p">)</span></div>

<div class="viewcode-block" id="LabLevel.clear"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complete</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Efface une ou toutes les couches du niveau</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            typecase : typage du LabHelper</span>
<span class="sd">            complete : efface toutes les couches        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_change_log</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_typecase_cleared</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
            <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">complete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_on_typecase_cleared</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clear_change_log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_cache</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">complete</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_cache</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_on_typecase_cleared</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre le clear dans les changements d&#39;étape</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cleared_typecases&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cleared_typecases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>

<div class="viewcode-block" id="LabLevel.get_dimensions"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">get_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne w, h</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">fmat</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fmat</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="LabLevel.get_layer"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_layer">[docs]</a>    <span class="k">def</span> <span class="nf">get_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la matrice associée au type_case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LabLevel.get_sublevel"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_sublevel">[docs]</a>    <span class="k">def</span> <span class="nf">get_sublevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le sous niveau d&#39;origine x, y et de dims w, h</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="n">LabLevel</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sl</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">get_submatrice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sl</span></div>

<div class="viewcode-block" id="LabLevel.get_animation_matrice"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_animation_matrice">[docs]</a>    <span class="k">def</span> <span class="nf">get_animation_matrice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la projection de la couche d&#39;animation sous forme de matrice. </span>
<span class="sd">        Usage : animation de type &quot;face&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">anim_lay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ANIMATION</span><span class="p">)</span>
        <span class="n">anim_mat</span> <span class="o">=</span> <span class="n">anim_lay</span><span class="o">.</span><span class="n">project_layer_on_matrice</span><span class="p">(</span><span class="s2">&quot;anim_uid&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">anim_mat</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="s2">&quot;LabLevel :</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ch</span> <span class="o">+=</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot; len=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">()))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">ch</span>

    <span class="c1">#-----&gt; Cache</span>
<div class="viewcode-block" id="LabLevel.discard_cache"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.discard_cache">[docs]</a>    <span class="k">def</span> <span class="nf">discard_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsqu&#39;un changement de case (coords ou type) rend les applats obsolètes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LINKED_CASETYPES</span><span class="p">:</span>
                <span class="n">n0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">())</span>
                <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">n0</span> <span class="o">*</span> <span class="n">n1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># périmètre et sortie non crées</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_zindex</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">full</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">z</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_matrice_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="LabLevel.update_cache"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.update_cache">[docs]</a>    <span class="k">def</span> <span class="nf">update_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour les applats</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_flat_matrices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_matrice_updated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_build_fullflat_typecase_cache</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Applats du LabLevel en Matrices</span>
<div class="viewcode-block" id="LabLevel.get_flat_matrice"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_flat_matrice">[docs]</a>    <span class="k">def</span> <span class="nf">get_flat_matrice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">guidedicated</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la matrice représentant l&#39;applat de couches</span>
<span class="sd">        </span>
<span class="sd">        * si full = True : toutes les couches sont publiées</span>
<span class="sd">        * si full = False : seules les couches nécessaires au parsing le sont</span>
<span class="sd">        * si guidedicated = True : matrice dédiée aux GUIs graphiques, en pratique </span>
<span class="sd">          la même matrice que celle dédiée au parsing</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flat_matrice_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_cache</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guidedicated</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsing_flat_matrice</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsing_flat_matrice</span></div>

    <span class="k">def</span> <span class="nf">_update_flat_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour :</span>
<span class="sd">        </span>
<span class="sd">        * la matrice représentant les couches nécessaires au parsing</span>
<span class="sd">        * la matrice représentant l&#39;applat de toutes les couches</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># recherche de l&#39;index :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># cache invariant :</span>
        <span class="n">invcache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">get_invariant_cache</span><span class="p">()</span>
        <span class="c1"># on repart du dernier index à jour :</span>
        <span class="n">layer0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">maxzparse</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">zstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span>
            <span class="n">full_matstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">zstart</span><span class="p">]</span>
            <span class="n">parsezstart</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">zstart</span><span class="p">,</span> <span class="n">maxzparse</span><span class="p">)</span>
            <span class="n">parse_matstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">parsezstart</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zstart</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">full_matstart</span> <span class="o">=</span> <span class="n">parse_matstart</span> <span class="o">=</span> <span class="n">layer0</span>
        <span class="k">if</span> <span class="n">zstart</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># copies initiales :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsing_flat_matrice</span> <span class="o">=</span> <span class="n">parse_matstart</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span> <span class="o">=</span> <span class="n">full_matstart</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># cache matrice (niveau 3 : complet):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">set_matrice_cache</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">invariantcache</span><span class="o">=</span><span class="n">invcache</span><span class="p">)</span>
        <span class="c1"># Partie 1 :</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">zstart</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n1</span><span class="p">:</span>
            <span class="n">layermat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_limited_zindex_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">layermat</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parsing_flat_matrice</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Partie 2 :</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n2</span><span class="p">:</span>
            <span class="n">layermat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zindex_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">layermat</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">case</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
                    <span class="c1"># Applat complet</span>
                    <span class="k">if</span> <span class="n">case</span><span class="o">.</span><span class="n">type_case</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ROBOT</span><span class="p">:</span>
                        <span class="c1"># on ne publie pas les robots éliminés</span>
                        <span class="k">if</span> <span class="n">case</span><span class="o">.</span><span class="n">alive</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_full_cache_applats</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_case</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_zindex_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="c1">#-----&gt; Cache par type_case sur l&#39;applat complet</span>
    <span class="k">def</span> <span class="nf">_build_fullflat_typecase_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construit le cache par type_case sur self._full_flat_matrice après sa</span>
<span class="sd">        mise à jour</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># structure de données :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># familles de cases couramment utilisées :</span>
        <span class="n">familles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_LIBRES</span><span class="p">,</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_DANGERS</span><span class="p">,</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_ADVERSAIRES</span><span class="p">,</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_BONUS</span><span class="p">,</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_MURS</span><span class="p">,</span>
            <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_NO_ACTION</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="c1"># alimentation :</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">familles</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_name_for_typecase_famille</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># famille</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="c1"># types inclus</span>
                <span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">tclist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">get_case_by_type</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">tc</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tclist</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">tc</span><span class="p">]</span>
                    <span class="p">)</span>

<div class="viewcode-block" id="LabLevel.get_typecase_set"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_typecase_set">[docs]</a>    <span class="k">def</span> <span class="nf">get_typecase_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de cases associées à typecase dans l&#39;applat complet</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            typecase : famille courante (voir _build_fullflat_typecase_cache) ou type_case unitaire (dans LabHelper.FULL_CASETYPES)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flat_matrice_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_cache</span><span class="p">()</span>
        <span class="n">rset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">keyname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_name_for_typecase_famille</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keyname</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># mot clef associé à une famille de cases</span>
            <span class="n">typecase</span> <span class="o">=</span> <span class="n">keyname</span>
        <span class="k">if</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">rset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">typecase</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FULL_CASETYPES</span><span class="p">:</span>
            <span class="c1"># création de l&#39;entrée :</span>
            <span class="n">tclist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_flat_matrice</span><span class="o">.</span><span class="n">get_case_by_type</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tclist</span><span class="p">)</span>
            <span class="n">rset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fullflat_typecase_cache</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rset</span></div>

    <span class="k">def</span> <span class="nf">_get_name_for_typecase_famille</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">famille</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une chaine associée à la famille de cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_LIBRES</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_LIBRES</span>
        <span class="k">elif</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_DANGERS</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_DANGERS</span>
        <span class="k">elif</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_ADVERSAIRES</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_ADVERSAIRES</span>
        <span class="k">elif</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_BONUS</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_BONUS</span>
        <span class="k">elif</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_MURS</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_MURS</span>
        <span class="k">elif</span> <span class="n">famille</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_NO_ACTION</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TYPE_CASES_NO_ACTION</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="c1">#-----&gt; Change logs</span>
<div class="viewcode-block" id="LabLevel.init_level_before_changes"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.init_level_before_changes">[docs]</a>    <span class="k">def</span> <span class="nf">init_level_before_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les logs fins avant des changements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache d&#39;impacts :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_impact_cache</span><span class="p">()</span>
        <span class="c1"># chang log :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_change_log</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_level_before_step_change</span><span class="p">()</span></div>

<div class="viewcode-block" id="LabLevel.init_level_before_step_change"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.init_level_before_step_change">[docs]</a>    <span class="k">def</span> <span class="nf">init_level_before_step_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les logs de sous étape de transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># step change log :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_step_change_log</span><span class="p">()</span></div>

<div class="viewcode-block" id="LabLevel.get_change_log"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_change_log">[docs]</a>    <span class="k">def</span> <span class="nf">get_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les logs de modifications</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_change_log_key</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span></div>

<div class="viewcode-block" id="LabLevel.get_step_change_log"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_step_change_log">[docs]</a>    <span class="k">def</span> <span class="nf">get_step_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les logs de changement d&#39;étape</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span></div>

    <span class="k">def</span> <span class="nf">_init_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise le suivi des changements dans les différentes couches. </span>
<span class="sd">        Application : gestion fine du cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># Liste brute des coords ayant fait l&#39;objet d&#39;un changement</span>
        <span class="n">cl</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># détails par typecase:</span>
        <span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">cl</span><span class="p">[</span><span class="n">tc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span> <span class="s2">&quot;cleared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="c1"># incrément de version :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_log_increment</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cl</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log_increment</span>
        <span class="c1"># clef</span>
        <span class="n">cl</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_init_step_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs associés à une sous étape de transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s2">&quot;cases_added&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s2">&quot;cases_moved&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s2">&quot;cases_deleted&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s2">&quot;cleared_typecases&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_clear_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique que la couche de typecase a eu un clear</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="n">typecase</span><span class="p">][</span><span class="s2">&quot;cleared&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cl</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">tuppc</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">tuppc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cl</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]:</span>
                    <span class="n">cl</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuppc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_register_change_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typechange</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre un changement suite à une action unitaire</span>
<span class="sd">        </span>
<span class="sd">        * typechange : &quot;add&quot;, &quot;delete&quot;, &quot;move&quot;</span>
<span class="sd">        * coords : liste de tupples (x, y)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">typecase</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">type_case</span>
        <span class="k">for</span> <span class="n">tuppc</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">tuppc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tuppc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">tuppcint</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
                <span class="c1"># change log</span>
                <span class="k">if</span> <span class="n">tuppcint</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuppcint</span><span class="p">)</span>
                <span class="n">tcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="n">typecase</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tuppcint</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tcl</span><span class="p">[</span><span class="n">typechange</span><span class="p">]:</span>
                    <span class="n">tcl</span><span class="p">[</span><span class="n">typechange</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuppcint</span><span class="p">)</span>
                <span class="c1"># step change log :</span>
                <span class="k">if</span> <span class="n">tuppcint</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]:</span>
                    <span class="c1"># on enregistre toutes les coords :</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuppcint</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">typechange</span> <span class="o">==</span> <span class="s2">&quot;cleared&quot;</span><span class="p">:</span>
                    <span class="c1"># on enregistre tous les clears de changelogs</span>
                    <span class="k">if</span> <span class="n">typecase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cleared&quot;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cleared&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">typecase</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">typecase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">STEP_CHANGE_LOGS_EXCLUDED</span><span class="p">:</span>
                    <span class="c1"># cases animation omises</span>
                    <span class="k">if</span> <span class="n">typechange</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cases_added&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="n">typechange</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span>
                        <span class="ow">and</span> <span class="n">typecase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LINKED_CASETYPES</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cases_deleted&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">typechange</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_step_change_log</span><span class="p">[</span><span class="s2">&quot;cases_moved&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_change_log_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère une clef représentant les changements apportés.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">ZINDEX_LOGS_KEY</span><span class="p">:</span>
            <span class="n">tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_typecase</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="n">tc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">chl_tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_log</span><span class="p">[</span><span class="n">tc</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">chl_tc</span><span class="p">[</span><span class="s2">&quot;cleared&quot;</span><span class="p">]:</span>
                <span class="n">key</span> <span class="o">+=</span> <span class="s2">&quot;cleared&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="s2">&quot;move&quot;</span><span class="p">]:</span>
                    <span class="n">lcoords</span> <span class="o">=</span> <span class="n">chl_tc</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>
                    <span class="n">key</span> <span class="o">+=</span> <span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_key_for_listcoords</span><span class="p">(</span><span class="n">lcoords</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">key</span>

    <span class="k">def</span> <span class="nf">_create_key_for_listcoords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listcoords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère une clef en concaténant les nombres associés aux coords</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listcoords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Trie :</span>
            <span class="n">listcoords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">listcoords</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="c1"># Transcription :</span>
            <span class="k">for</span> <span class="n">coords</span> <span class="ow">in</span> <span class="n">listcoords</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">key</span>

    <span class="k">def</span> <span class="nf">_number_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un nombre associé aux coords (x, y)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="c1">#-----&gt; Utilitaires</span>
<div class="viewcode-block" id="LabLevel.get_case_sortie"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_case_sortie">[docs]</a>    <span class="k">def</span> <span class="nf">get_case_sortie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la case sortie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_SORTIE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layersdict</span><span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_SORTIE</span><span class="p">]</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">())[</span>
                    <span class="mi">0</span>
                <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="LabLevel.get_sortie_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_sortie_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_sortie_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coordonnées de la sortie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_case_sortie</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case_sortie</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">case</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="LabLevel.get_distance_between_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_distance_between_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_distance_between_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul la distance entre deux cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">case1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">case2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">case1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">case2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="LabLevel.get_path_length_between_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_path_length_between_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_path_length_between_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul la distance du chemin entre deux cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">case1</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">case2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">case1</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">case2</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="LabLevel.get_vector_for_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_vector_for_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_vector_for_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Retourne un tuple représentant le vecteur allant de c1 à c2</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">case2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">case1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">case1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="LabLevel.scalar_product"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.scalar_product">[docs]</a>    <span class="k">def</span> <span class="nf">scalar_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul le produit scalaire v1.v2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">vect1</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">vect2</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">vect1</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">vect2</span><span class="o">.</span><span class="n">y</span></div>

<div class="viewcode-block" id="LabLevel.get_dirs_for_vector"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_dirs_for_vector">[docs]</a>    <span class="k">def</span> <span class="nf">get_dirs_for_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une liste de directions associées au vecteur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">vect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">list_dirs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">list_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">TOP</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_dirs</span></div>

    <span class="c1">#-----&gt; Cache d&#39;impacts</span>
    <span class="k">def</span> <span class="nf">_init_impact_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les dicts de gestion du cache</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set des cases adjacentes impactées par un danger (non récursif)</span>
        <span class="c1"># clef = (x, y, impact), valeur = liste de cases</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_adj_impacted</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># set des cases pouvant être atteintes par un jet de grenade par le robot</span>
        <span class="c1"># dans la direction donnée</span>
        <span class="c1"># clef = (robot.x, robot.y, robot.uid, direction), valeur = liste de cases</span>
        <span class="c1"># rq: robot n&#39;est pas une clef valable, sa position peut changer lors</span>
        <span class="c1"># des calculs de recherche de coups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reachable_by_bot_in_dir</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># dict de toutes les cases impactées de façon récursive par un danger</span>
        <span class="c1"># clef = (x, y, impact), valeur = dict d&#39;impacts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_recursive_impacted</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># dict des dangers entourant une case</span>
        <span class="c1"># clef = (x, y), valeur = liste de cases dangers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_arround</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_impact_cache_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">cache_type</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recherche en cache d&#39;un résultat de calcul d&#39;impacts</span>
<span class="sd">        cache_type : adjacent, recursive, reachable, arround</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;not in cache&quot;</span>
        <span class="k">if</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;adjacent&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_adj_impacted</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;recursive&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_recursive_impacted</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;reachable&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">robot</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">direct</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reachable_by_bot_in_dir</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;arround&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_arround</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_set_impact_cache_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">cache_type</span><span class="p">,</span> <span class="n">valeur</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise en cache d&#39;un résultat de calcul d&#39;impacts</span>
<span class="sd">        </span>
<span class="sd">        * cache_type : adjacent, recursive, reachable</span>
<span class="sd">        * valeur : résultat à stocker</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;adjacent&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_adj_impacted</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;recursive&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">danger</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_recursive_impacted</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;reachable&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">robot</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">direct</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reachable_by_bot_in_dir</span>
        <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s2">&quot;arround&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dgr_arround</span>
        <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">valeur</span>

    <span class="c1">#-----&gt; Calcul d&#39;impacts</span>
<div class="viewcode-block" id="LabLevel.get_minelist_arround_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_minelist_arround_case">[docs]</a>    <span class="k">def</span> <span class="nf">get_minelist_arround_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recherche les mines comprises dans la matrice 5*5 centrée sur case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cachedlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;arround&quot;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedlist</span> <span class="o">!=</span> <span class="s2">&quot;not in cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedlist</span>
        <span class="c1"># coords des cases :</span>
        <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="c1"># Réduction des coordonnées</span>
        <span class="n">realset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
        <span class="n">finalset</span> <span class="o">=</span> <span class="n">coordset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
        <span class="c1"># set de cases associées :</span>
        <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matdict</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">matdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">])</span>
        <span class="c1"># extraction des cases dangers</span>
        <span class="n">dgrlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">caseset</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">type_case</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DANGER</span><span class="p">]</span>
        <span class="c1"># mise en cache :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;arround&quot;</span><span class="p">,</span> <span class="n">dgrlist</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">dgrlist</span></div>

<div class="viewcode-block" id="LabLevel.get_cases_reachable_by_grenade_in_dir"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_cases_reachable_by_grenade_in_dir">[docs]</a>    <span class="k">def</span> <span class="nf">get_cases_reachable_by_grenade_in_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">direct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set des cases atteignables par un jet de grenade</span>
<span class="sd">        dans la direction donnée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cached_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impact_cache_object</span><span class="p">(</span>
            <span class="s2">&quot;reachable&quot;</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="n">robot</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="n">direct</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cached_set</span> <span class="o">!=</span> <span class="s2">&quot;not in cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cached_set</span>
        <span class="c1"># calcul initial</span>
        <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="n">rset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">robot</span><span class="o">.</span><span class="n">has_grenade</span><span class="p">:</span>
            <span class="c1"># axe, sens :</span>
            <span class="k">if</span> <span class="n">direct</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">AXIS_X</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">AXIS_Y</span>
            <span class="k">if</span> <span class="n">direct</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">]:</span>
                <span class="n">sens</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">DIR_POS</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sens</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">DIR_NEG</span>
            <span class="c1"># dimensions :</span>
            <span class="n">portee</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span>
            <span class="n">puissance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">get_puissance_list</span><span class="p">(</span><span class="s2">&quot;grenade&quot;</span><span class="p">))</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="n">portee</span>
            <span class="k">if</span> <span class="n">puissance</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">puissance</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="c1"># rectangle primaire :</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">AXIS_X</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim_orth</span>
                <span class="n">prop</span><span class="p">,</span> <span class="n">prop_orth</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dim_orth</span><span class="p">,</span> <span class="n">dim</span>
                <span class="n">prop</span><span class="p">,</span> <span class="n">prop_orth</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span>
            <span class="n">pt</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">sens</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">DIR_POS</span><span class="p">:</span>
                <span class="n">pt</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">robot</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pt</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">robot</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">-</span> <span class="n">dim</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">prop_orth</span><span class="p">]</span> <span class="o">=</span> <span class="n">robot</span><span class="p">[</span><span class="n">prop_orth</span><span class="p">]</span> <span class="o">-</span> <span class="n">dim_orth</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">rset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="c1"># empreinte supplémentaire :</span>
            <span class="k">if</span> <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">gen_dim</span> <span class="o">=</span> <span class="n">dim_orth</span>
                <span class="n">last_pt</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
                <span class="n">last_pt</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">robot</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">+</span> <span class="n">sens</span> <span class="o">*</span> <span class="n">dim</span>
                <span class="n">last_pt</span><span class="p">[</span><span class="n">prop_orth</span><span class="p">]</span> <span class="o">=</span> <span class="n">robot</span><span class="p">[</span><span class="n">prop_orth</span><span class="p">]</span>
                <span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span> <span class="o">=</span> <span class="n">last_pt</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">last_pt</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
                <span class="n">gen_x</span><span class="p">,</span> <span class="n">gen_y</span> <span class="o">=</span> <span class="n">gen_center_x</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gen_center_y</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
                    <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_losange_coords</span>
                    <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">]:</span>
                    <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span>
                    <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_x</span><span class="p">,</span> <span class="n">gen_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">puissance</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>
                    <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_subshape_coords</span>
                    <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">]</span>
                <span class="n">empreinte_set</span> <span class="o">=</span> <span class="n">gen_empreinte</span><span class="p">(</span><span class="o">*</span><span class="n">gen_args</span><span class="p">)</span>
                <span class="n">rset</span> <span class="o">=</span> <span class="n">rset</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">empreinte_set</span><span class="p">)</span>
        <span class="c1"># Réduction des coordonnées</span>
        <span class="n">realset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
        <span class="n">finalset</span> <span class="o">=</span> <span class="n">rset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
        <span class="c1"># set de cases associées :</span>
        <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matdict</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">matdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">])</span>
        <span class="c1"># mise en cache :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;reachable&quot;</span><span class="p">,</span> <span class="n">caseset</span><span class="p">,</span> <span class="n">robot</span><span class="o">=</span><span class="n">robot</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="n">direct</span><span class="p">)</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">caseset</span></div>

<div class="viewcode-block" id="LabLevel.get_cases_adj_impacted_by_danger"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_cases_adj_impacted_by_danger">[docs]</a>    <span class="k">def</span> <span class="nf">get_cases_adj_impacted_by_danger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">casedanger</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set des cases impactées par l&#39;explosion d&#39;un danger</span>
<span class="sd">        sans récursivité. </span>
<span class="sd">        La case du danger n&#39;est pas comptée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cached_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;adjacent&quot;</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached_set</span> <span class="o">!=</span> <span class="s2">&quot;not in cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cached_set</span>
        <span class="c1"># calcul initial</span>
        <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="n">casedanger</span><span class="o">.</span><span class="n">danger_impact</span>
        <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">impact</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># set de coordonnées :</span>
            <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">gen_args</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">gen_x</span> <span class="o">=</span> <span class="n">gen_y</span> <span class="o">=</span> <span class="n">gen_center_x</span> <span class="o">=</span> <span class="n">gen_center_y</span> <span class="o">=</span> <span class="n">gen_dim</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">gen_dim</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">impact</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">gen_dim</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span> <span class="o">=</span> <span class="n">casedanger</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">casedanger</span><span class="o">.</span><span class="n">y</span>
            <span class="n">gen_x</span><span class="p">,</span> <span class="n">gen_y</span> <span class="o">=</span> <span class="n">gen_center_x</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gen_center_y</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">impact</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
                <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_losange_coords</span>
                <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">impact</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">]:</span>
                <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span>
                <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_x</span><span class="p">,</span> <span class="n">gen_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">impact</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>
                <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_subshape_coords</span>
                <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">]</span>
            <span class="n">rset</span> <span class="o">=</span> <span class="n">gen_empreinte</span><span class="p">(</span><span class="o">*</span><span class="n">gen_args</span><span class="p">)</span>
            <span class="c1"># Réduction des coordonnées</span>
            <span class="n">realset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
            <span class="n">finalset</span> <span class="o">=</span> <span class="n">rset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
            <span class="c1"># set de cases associées :</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">matdict</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
                <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">matdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">])</span>
            <span class="c1"># retire la case danger au besoin :</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="n">caseset</span><span class="o">.</span><span class="n">difference</span><span class="p">({</span><span class="n">casedanger</span><span class="p">,</span> <span class="kc">None</span><span class="p">})</span>
        <span class="c1"># mise en cache :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;adjacent&quot;</span><span class="p">,</span> <span class="n">caseset</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">caseset</span></div>

<div class="viewcode-block" id="LabLevel.xlook_for_cases_impacted"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.xlook_for_cases_impacted">[docs]</a>    <span class="k">def</span> <span class="nf">xlook_for_cases_impacted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">casedanger</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dictimpact</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identification récursive des cases impactées par l&#39;activation d&#39;un danger</span>
<span class="sd">        </span>
<span class="sd">        Retourne un dictionnaire :</span>
<span class="sd">        </span>
<span class="sd">        - dictimpact[&quot;danger_done&quot;] : usage interne</span>
<span class="sd">        - dictimp[&quot;flat_list&quot;] : liste (set) complète des cases impactées</span>
<span class="sd">        - dictimpact[0] : liste (set) de tupples (case, impact) des cases touchées au pas 0</span>
<span class="sd">        - ...</span>
<span class="sd">        - dictimpact[n] : liste (set) de tupples (case, impact) des cases touchées au pas n</span>
<span class="sd">        </span>
<span class="sd">        avec n : nombre de pas d&#39;animation.</span>
<span class="sd">        </span>
<span class="sd">        Rq importante : les données mises en cache ne comprennent pas le danger initial.</span>
<span class="sd">        En effet lors des calculs de commandes automatiques, on simule des explosions</span>
<span class="sd">        avec des grenades virtuelles. On n&#39;inclue le danger réel qu&#39;au dernier moment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cached_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;recursive&quot;</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="n">casedanger</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cached_dict</span> <span class="o">!=</span> <span class="s2">&quot;not in cache&quot;</span><span class="p">:</span>
                <span class="c1"># copie avec prise en compte de la case danger :</span>
                <span class="n">fulldict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_complete_recursive_impactdict_with_danger</span><span class="p">(</span>
                    <span class="n">cached_dict</span><span class="p">,</span> <span class="n">casedanger</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">fulldict</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">count</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="n">casedanger</span><span class="o">.</span><span class="n">danger_impact</span>
        <span class="n">dictimp</span> <span class="o">=</span> <span class="n">dictimpact</span>
        <span class="c1"># init du dict :</span>
        <span class="k">if</span> <span class="n">dictimp</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictimp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;danger_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;flat_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictimp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dictimp</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;danger_done&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;flat_list&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="n">dictimp</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">casedanger</span><span class="p">,</span> <span class="n">impact</span><span class="p">))</span>
        <span class="c1"># recherche des cases impactées :</span>
        <span class="n">casestouchees</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">casedanger</span><span class="o">.</span><span class="n">danger_type</span> <span class="o">==</span> <span class="n">CaseGrenade</span><span class="o">.</span><span class="n">DANGER_GRENADE</span><span class="p">:</span>
            <span class="n">casestouchees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cases_with_same_coords</span><span class="p">(</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="n">casesadj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cases_adj_impacted_by_danger</span><span class="p">(</span><span class="n">casedanger</span><span class="p">)</span>
        <span class="c1"># ajout des cases adjacentes :</span>
        <span class="n">casessuper</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">casesadj</span><span class="p">:</span>
            <span class="n">casestouchees</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="n">cwsm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cases_with_same_coords</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="n">casessuper</span> <span class="o">=</span> <span class="n">casessuper</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">cwsm</span><span class="p">)</span>
        <span class="c1"># cases superposées :</span>
        <span class="n">casestouchees</span> <span class="o">=</span> <span class="n">casestouchees</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">casessuper</span><span class="p">)</span>
        <span class="c1"># répartition dans les dict en fonction de la distance au danger :</span>
        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">casestouchees</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_distance_between_cases</span><span class="p">(</span><span class="n">case</span><span class="p">,</span> <span class="n">casedanger</span><span class="p">))</span>
            <span class="c1"># récursivité :</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">case</span><span class="p">)</span> <span class="o">==</span> <span class="n">CaseDanger</span> <span class="ow">and</span> <span class="n">case</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;danger_done&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xlook_for_cases_impacted</span><span class="p">(</span><span class="n">case</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">dictimpact</span><span class="o">=</span><span class="n">dictimp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictimp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dictimp</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="n">dictimp</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">case</span><span class="p">,</span> <span class="n">impact</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">case</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;flat_list&quot;</span><span class="p">]:</span>
                    <span class="n">dictimp</span><span class="p">[</span><span class="s2">&quot;flat_list&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
        <span class="c1"># finalisation :</span>
        <span class="n">resultdict</span> <span class="o">=</span> <span class="n">dictimp</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># mise en cache (sans la case danger initiale)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_impact_cache_object</span><span class="p">(</span><span class="s2">&quot;recursive&quot;</span><span class="p">,</span> <span class="n">dictimp</span><span class="p">,</span> <span class="n">danger</span><span class="o">=</span><span class="n">casedanger</span><span class="p">)</span>
            <span class="c1"># copie avec prise en compte de la case danger :</span>
            <span class="n">resultdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_complete_recursive_impactdict_with_danger</span><span class="p">(</span>
                <span class="n">dictimp</span><span class="p">,</span> <span class="n">casedanger</span>
            <span class="p">)</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">resultdict</span></div>

    <span class="k">def</span> <span class="nf">_complete_recursive_impactdict_with_danger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cacheddict</span><span class="p">,</span> <span class="n">danger</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une copie du dictionnaire généré par xlook_for_cases_impacted</span>
<span class="sd">        incluant la case danger</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">copydict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># copie des set</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cacheddict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">copydict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">cacheddict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># ajout de la case danger :</span>
        <span class="n">copydict</span><span class="p">[</span><span class="s2">&quot;flat_list&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">danger</span><span class="p">)</span>
        <span class="n">copydict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">danger</span><span class="p">,</span> <span class="n">danger</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">))</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">copydict</span>

    <span class="c1">#-----&gt; Zones d&#39;action des robots</span>
<div class="viewcode-block" id="LabLevel.update_bot_action_zones"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.update_bot_action_zones">[docs]</a>    <span class="k">def</span> <span class="nf">update_bot_action_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Interface de mise à jour des zones de mouvements et d&#39;attaque du robot. </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            nextgamble : si True limite la recherche aux coups à venir (considère </span>
<span class="sd">                la vitesse courante au lieu de la vitesse &quot;absolue&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">robot</span><span class="o">.</span><span class="n">alive</span><span class="p">:</span>
            <span class="c1"># zone de déplacement :</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">move_zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bot_move_zone</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="n">nextgamble</span><span class="p">)</span>
            <span class="c1"># zone d&#39;attaque :</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">attack_zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bot_attack_zone</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="n">nextgamble</span><span class="p">)</span></div>

<div class="viewcode-block" id="LabLevel.get_bot_move_zone"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_bot_move_zone">[docs]</a>    <span class="k">def</span> <span class="nf">get_bot_move_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de coords de la sous matrice de forme losange représentant</span>
<span class="sd">        le rayon de déplacement du robot.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            nextgamble : si True limite la recherche aux coups à venir (considère </span>
<span class="sd">                la vitesse courante au lieu de la vitesse &quot;absolue&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">nextgamble</span><span class="p">:</span>
            <span class="n">vit</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">current_vitesse</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vit</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span>
        <span class="n">subm</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_sublosange</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">robot</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">vit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subm</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">coordset</span> <span class="o">=</span> <span class="n">subm</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
            <span class="c1"># on exclue le périmètre</span>
            <span class="n">excludedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_typecase_set</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_MUR_PERIMETRE</span><span class="p">)</span>
            <span class="n">coordset</span> <span class="o">=</span> <span class="n">coordset</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">excludedset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coordset</span></div>

<div class="viewcode-block" id="LabLevel.get_bot_attack_zone"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_bot_attack_zone">[docs]</a>    <span class="k">def</span> <span class="nf">get_bot_attack_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de coords de la sous matrice représentant les cases</span>
<span class="sd">        pouvant être impactées par le robot.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            nextgamble : si True limite la recherche aux coups à venir (considère </span>
<span class="sd">                la vitesse courante au lieu de la vitesse &quot;absolue&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
        <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">robot</span><span class="o">.</span><span class="n">y</span>
        <span class="n">directions</span> <span class="o">=</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">robot</span><span class="o">.</span><span class="n">has_grenade</span> <span class="ow">or</span> <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Sans grenade la zone se résume à la zone de déplacement</span>
            <span class="n">coordset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bot_move_zone</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">nextgamble</span><span class="o">=</span><span class="n">nextgamble</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Avec grenade :</span>
            <span class="k">if</span> <span class="n">nextgamble</span><span class="p">:</span>
                <span class="n">vit</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">current_vitesse</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vit</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span>
            <span class="n">portee</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span>
            <span class="n">puissance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">get_puissance_list</span><span class="p">(</span><span class="s2">&quot;grenade&quot;</span><span class="p">))</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="n">portee</span> <span class="o">+</span> <span class="n">vit</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">puissance</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">dim_orth</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="c1"># zone d&#39;impact centrale :</span>
            <span class="n">central_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">h_x</span><span class="p">,</span> <span class="n">h_y</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">-</span> <span class="n">dim</span><span class="p">,</span> <span class="n">yr</span> <span class="o">-</span> <span class="n">dim_orth</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">h_w</span><span class="p">,</span> <span class="n">h_h</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim_orth</span>
            <span class="n">main_hrect_set</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">h_x</span><span class="p">,</span> <span class="n">h_y</span><span class="p">,</span> <span class="n">h_w</span><span class="p">,</span> <span class="n">h_h</span><span class="p">)</span>
            <span class="n">v_x</span><span class="p">,</span> <span class="n">v_y</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">-</span> <span class="n">dim_orth</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">yr</span> <span class="o">-</span> <span class="n">dim</span>
            <span class="n">v_w</span><span class="p">,</span> <span class="n">v_h</span> <span class="o">=</span> <span class="n">dim_orth</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">main_vrect_set</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">v_x</span><span class="p">,</span> <span class="n">v_y</span><span class="p">,</span> <span class="n">v_w</span><span class="p">,</span> <span class="n">v_h</span><span class="p">)</span>
            <span class="n">central_set</span> <span class="o">=</span> <span class="n">central_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">main_hrect_set</span><span class="p">,</span> <span class="n">main_vrect_set</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">puissance</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># empreintes supplémentaires</span>
                <span class="k">for</span> <span class="n">direct</span> <span class="ow">in</span> <span class="n">directions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">direct</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TOP</span><span class="p">]:</span>
                        <span class="n">sens</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sens</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">gen_dim</span> <span class="o">=</span> <span class="n">dim_orth</span>
                    <span class="k">if</span> <span class="n">direct</span> <span class="ow">in</span> <span class="p">[</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                        <span class="n">gen_x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">+</span> <span class="n">sens</span> <span class="o">*</span> <span class="n">dim</span>
                        <span class="n">gen_center_x</span> <span class="o">=</span> <span class="n">gen_x</span>
                        <span class="n">gen_y</span> <span class="o">=</span> <span class="n">yr</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span>
                        <span class="n">gen_center_y</span> <span class="o">=</span> <span class="n">yr</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gen_x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">-</span> <span class="n">gen_dim</span> <span class="o">//</span> <span class="mi">2</span>
                        <span class="n">gen_center_x</span> <span class="o">=</span> <span class="n">xr</span>
                        <span class="n">gen_y</span> <span class="o">=</span> <span class="n">yr</span> <span class="o">+</span> <span class="n">sens</span> <span class="o">*</span> <span class="n">dim</span>
                        <span class="n">gen_center_y</span> <span class="o">=</span> <span class="n">gen_y</span>
                    <span class="k">if</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
                        <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_losange_coords</span>
                        <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">puissance</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">]:</span>
                        <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span>
                        <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_x</span><span class="p">,</span> <span class="n">gen_y</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">,</span> <span class="n">gen_dim</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">puissance</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>
                        <span class="n">gen_empreinte</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_subshape_coords</span>
                        <span class="n">gen_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_center_x</span><span class="p">,</span> <span class="n">gen_center_y</span><span class="p">]</span>
                    <span class="n">empreinte_set</span> <span class="o">=</span> <span class="n">gen_empreinte</span><span class="p">(</span><span class="o">*</span><span class="n">gen_args</span><span class="p">)</span>
                    <span class="n">central_set</span> <span class="o">=</span> <span class="n">central_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">empreinte_set</span><span class="p">)</span>
            <span class="c1"># zone d&#39;impact liée à la vitesse :</span>
            <span class="n">vitesse_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">vit</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">vit</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">v_hrect_set</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span>
                        <span class="n">h_x</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">h_y</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">h_w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">h_h</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span>
                    <span class="p">)</span>
                    <span class="n">v_vrect_set</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span>
                        <span class="n">v_x</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">v_y</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">v_w</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">v_h</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span>
                    <span class="p">)</span>
                    <span class="n">vitesse_set</span> <span class="o">=</span> <span class="n">vitesse_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">v_hrect_set</span><span class="p">,</span> <span class="n">v_vrect_set</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="c1"># zone d&#39;impact globale :</span>
            <span class="n">coordset</span> <span class="o">=</span> <span class="n">central_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">vitesse_set</span><span class="p">)</span>
        <span class="c1"># Réduction des coordonnées</span>
        <span class="n">realset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="n">coordset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
        <span class="c1"># on exclue le périmètre</span>
        <span class="n">excludedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_typecase_set</span><span class="p">(</span><span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_MUR_PERIMETRE</span><span class="p">)</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="n">coordset</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">excludedset</span><span class="p">)</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">coordset</span></div>

<div class="viewcode-block" id="LabLevel.get_caseset_for_coordset"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.get_caseset_for_coordset">[docs]</a>    <span class="k">def</span> <span class="nf">get_caseset_for_coordset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de cases associé au set de coordonnées</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
            <span class="n">matdict</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">matdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordset</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">caseset</span></div>

<div class="viewcode-block" id="LabLevel.evaluate_bot_attack_proba_for_robot"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.evaluate_bot_attack_proba_for_robot">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate_bot_attack_proba_for_robot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">bot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evalue pour les cases de robot.move_zone la probabilité d&#39;attaque</span>
<span class="sd">        possible par bot. </span>
<span class="sd">        Rq : approximations rapides et sous évaluées. Méthode destinée à des</span>
<span class="sd">        situations désespérées.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- données</span>
        <span class="c1"># dict de retour (key=case, val=proba)</span>
        <span class="n">rdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># zone de mouvement de robot :</span>
        <span class="n">r_move_set</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">move_zone</span>
        <span class="n">r_move_c_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_caseset_for_coordset</span><span class="p">(</span><span class="n">r_move_set</span><span class="p">)</span>
        <span class="c1"># alimentation de rdict par des probas nulles</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r_move_c_set</span><span class="p">:</span>
            <span class="n">rdict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># intersection :</span>
        <span class="n">b_attack_set</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">attack_zone</span>
        <span class="n">inter_set</span> <span class="o">=</span> <span class="n">b_attack_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">r_move_set</span><span class="p">)</span>
        <span class="n">inter_cases_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_caseset_for_coordset</span><span class="p">(</span><span class="n">inter_set</span><span class="p">)</span>
        <span class="c1"># 2- qualification des directions en termes de densité de cases libres</span>
        <span class="c1"># exprimant la facilité de bot à se déplacer (approximation)</span>
        <span class="c1"># zone de mouvement de bot</span>
        <span class="n">b_move_set</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">move_zone</span>
        <span class="n">b_move_c_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_caseset_for_coordset</span><span class="p">(</span><span class="n">b_move_set</span><span class="p">)</span>
        <span class="n">dirdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">direct</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LIST_DIRECTIONS</span><span class="p">:</span>
            <span class="n">caseset</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">direct</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
                <span class="n">caseset</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b_move_c_set</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">bot</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">direct</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
                <span class="n">caseset</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b_move_c_set</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">bot</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">direct</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">TOP</span><span class="p">:</span>
                <span class="n">caseset</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b_move_c_set</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">bot</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">direct</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">:</span>
                <span class="n">caseset</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">b_move_c_set</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">bot</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>
            <span class="c1"># densité de cases libres dans la direction :</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">caseset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cvide</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">cdanger</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">caseset</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">type_case</span> <span class="ow">in</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">FAMILLE_CASES_LIBRES</span><span class="p">:</span>
                        <span class="n">cvide</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">c</span><span class="o">.</span><span class="n">type_case</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DANGER</span><span class="p">:</span>
                        <span class="n">cdanger</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">dvide</span> <span class="o">=</span> <span class="n">cvide</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">caseset</span><span class="p">)</span>
                <span class="n">ddanger</span> <span class="o">=</span> <span class="n">cdanger</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">caseset</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dvide</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ddanger</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">dirdict</span><span class="p">[</span><span class="n">direct</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vide&quot;</span><span class="p">:</span> <span class="n">dvide</span><span class="p">,</span> <span class="s2">&quot;danger&quot;</span><span class="p">:</span> <span class="n">ddanger</span><span class="p">}</span>
        <span class="c1"># 3- évaluation de la probabilité d&#39;attaque pour chaque case de</span>
        <span class="c1"># l&#39;intersection :</span>
        <span class="n">dmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bot</span><span class="o">.</span><span class="n">get_danger_radius</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">inter_cases_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">bot</span><span class="p">:</span>
                <span class="n">proba</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># vecteur bot / case</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vector_for_cases</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                <span class="n">listdirect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dirs_for_vector</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="c1"># densités moyennes de cases libres et dangers associées aux</span>
                <span class="c1"># directions</span>
                <span class="n">dvide</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ddanger</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">direct</span> <span class="ow">in</span> <span class="n">listdirect</span><span class="p">:</span>
                    <span class="n">dvide</span> <span class="o">+=</span> <span class="n">dirdict</span><span class="p">[</span><span class="n">direct</span><span class="p">][</span><span class="s2">&quot;vide&quot;</span><span class="p">]</span>
                    <span class="n">ddanger</span> <span class="o">+=</span> <span class="n">dirdict</span><span class="p">[</span><span class="n">direct</span><span class="p">][</span><span class="s2">&quot;danger&quot;</span><span class="p">]</span>
                <span class="n">dvide</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listdirect</span><span class="p">)</span>
                <span class="n">ddanger</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listdirect</span><span class="p">)</span>
                <span class="c1"># distance</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path_length_between_cases</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                <span class="c1"># proportion de déplacement : à valeur dans [0.5; 1]</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">dmax</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">dmax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="c1"># pseudo probabilité exprimant la facilité d&#39;accès à la case</span>
                <span class="k">if</span> <span class="n">robot</span><span class="o">.</span><span class="n">has_grenade</span><span class="p">:</span>
                    <span class="c1"># les dangers vont faciliter l&#39;approche / l&#39;attaque</span>
                    <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop</span> <span class="o">+</span> <span class="n">dvide</span> <span class="o">+</span> <span class="n">ddanger</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop</span> <span class="o">+</span> <span class="n">dvide</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">proba</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">proba</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">rdict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">proba</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">rdict</span></div></div>


<div class="viewcode-block" id="Matrice"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice">[docs]</a><span class="k">class</span> <span class="nc">Matrice</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une couche d&#39;un niveau de jeu</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cachelevel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">invariantcache</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cachelevel: niveau de cache</span>
<span class="sd">            invariantcache: cache invariant (coords)</span>
<span class="sd">        </span>
<span class="sd">        cachelevel à valeur dans :</span>
<span class="sd">        </span>
<span class="sd">        0. rien (défaut)</span>
<span class="sd">        1. liste et set complet de cases</span>
<span class="sd">        2. plus cache de lignes, colonnes et submatrices (subshapes) et des </span>
<span class="sd">            coords associées</span>
<span class="sd">        3. plus cache invariant (conservation des coords du cache de niveau 2)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># dict principal k=(case.x, case.y), v=case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># ref à une éventuelle Matrice mère</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_matrice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># propriétés géométriques</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_centerpoint</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="c1"># cache</span>
        <span class="c1"># Niveau de mise en cache:</span>
        <span class="c1"># 0 : rien (défaut)</span>
        <span class="c1"># 1 : liste et set complet de cases</span>
        <span class="c1"># 2: + cache de lignes, colonnes et submatrices (subshapes) et des coords associées</span>
        <span class="c1"># 3 : + cache invariant (conservation des coords du cache de niveau 2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># cache invariant (valeurs = liste de coords)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span> <span class="o">=</span> <span class="n">invariantcache</span>
        <span class="c1"># cache temporaire</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># initialisation du cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_cache</span><span class="p">(</span><span class="n">cachelevel</span><span class="p">)</span>

    <span class="c1">#-----&gt; Cache</span>
<div class="viewcode-block" id="Matrice.set_matrice_cache"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.set_matrice_cache">[docs]</a>    <span class="k">def</span> <span class="nf">set_matrice_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cachelevel</span><span class="p">,</span> <span class="n">invariantcache</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activation différée du cache interne avec cachelevel :</span>
<span class="sd">        </span>
<span class="sd">        0. (rien),</span>
<span class="sd">        1. (liste/set des cases, set de leurs coords),</span>
<span class="sd">        2. (plus lignes, colonnes, sous matrices)</span>
<span class="sd">        3. (plus cache invariant)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span> <span class="o">=</span> <span class="n">invariantcache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_cache</span><span class="p">(</span><span class="n">cachelevel</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_init_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cachelevel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les dicts de gestion du cache temporaire</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cachelevel : 0, 1, 2 ou 3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cachelevel</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cachelevel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">=</span> <span class="n">cachelevel</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># destruction du cache temporaire :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;theoric_coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;case_set&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;case_list&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;losange_coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;subshape_coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;submatrice&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;subshape&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;sublosange&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;impacted&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># - niveau 1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># cache de la liste complète de cases</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;case_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># cache du set complet de cases</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;case_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># cache du set de coords</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;theoric_coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># - niveau 2 :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># cache de lignes :</span>
            <span class="c1"># clef=index de ligne, valeur=ligne (list)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de colonnes :</span>
            <span class="c1"># clef=index de colonne, valeur=colonne (list)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;column&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de coords de rectangles :</span>
            <span class="c1"># clef=(x,y,w,h), valeur = set de coords</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;rectangle_coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de coordonnées de losanges :</span>
            <span class="c1"># clef=(xc,yc,dim), valeur = set de coords</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;losange_coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de coords de subshape :</span>
            <span class="c1"># clef=(x,y), valeur = set de coords</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;subshape_coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de sous matrices :</span>
            <span class="c1"># clef=(x,y,w,h,strictmode), valeur=submatrice</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;submatrice&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de subshapes :</span>
            <span class="c1"># clef=(x,y,shapefactor), valeur=subshape</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;subshape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cache de sous losanges :</span>
            <span class="c1"># clef=(xc, yc, dim), valeur=sublosange</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;sublosange&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># cases impactées par un danger :</span>
            <span class="c1"># clef=(x,y,impact), valeur=set de cases</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;impacted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># - niveau 3 :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># cache invariant :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;theoric_coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;losange_coords&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;subshape_coords&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;submatrice&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;subshape&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                    <span class="s2">&quot;sublosange&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
                <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Matrice.get_invariant_cache"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_invariant_cache">[docs]</a>    <span class="k">def</span> <span class="nf">get_invariant_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les données de cache invariantes fondées sur des listes</span>
<span class="sd">        de coordonnées</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span></div>

    <span class="k">def</span> <span class="nf">_set_cached_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cachedobj</span><span class="p">,</span> <span class="n">typeobject</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met en cache un objet</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cachedobj : l&#39;objet à mettre en cache</span>
<span class="sd">            typeobject (str): line, column, submatrice, subshape, sublosange, case_list, </span>
<span class="sd">                case_set, coords, theoric_coords, rectangle_coords, losange_coords, </span>
<span class="sd">                subshape_coords, impacted </span>
<span class="sd">            **kwargs : paramètres associés à l&#39;objet        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># filtrage en fonction du niveau de cache</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;case_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;case_set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;theoric_coords&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;case_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;case_set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;theoric_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="s2">&quot;column&quot;</span><span class="p">,</span>
            <span class="s2">&quot;submatrice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subshape&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sublosange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;impacted&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># objets simples</span>
        <span class="k">if</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;case_list&quot;</span><span class="p">,</span> <span class="s2">&quot;case_set&quot;</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="s2">&quot;theoric_coords&quot;</span><span class="p">]:</span>
            <span class="c1"># cache temporaire</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span> <span class="o">=</span> <span class="n">cachedobj</span>
            <span class="c1"># cache invariant :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="s2">&quot;theoric_coords&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span> <span class="o">=</span> <span class="n">cachedobj</span>
            <span class="c1"># fin des traitements</span>
            <span class="k">return</span>
        <span class="c1"># objets composés :</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">listargs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">listcoords</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;submatrice&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;strictmode&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;sublosange&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="s2">&quot;dim&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;subshape&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;shapefactor&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;losange_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="s2">&quot;dim&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;subshape_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;impacted&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;impact&quot;</span><span class="p">]</span>
            <span class="c1"># 1- Test de validité :</span>
            <span class="n">valide</span> <span class="o">=</span> <span class="n">cachedobj</span> <span class="o">!=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">listargs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">valide</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="c1"># 2- Mise en cache :</span>
            <span class="k">if</span> <span class="n">valide</span><span class="p">:</span>
                <span class="c1"># données</span>
                <span class="k">if</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">]:</span>
                    <span class="c1"># liste</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">listargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">cachedobj</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">listcoords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lk</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">listargs</span><span class="p">]</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">cachedobj</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;submatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;sublosange&quot;</span><span class="p">,</span> <span class="s2">&quot;subshape&quot;</span><span class="p">]:</span>
                            <span class="c1"># matrice</span>
                            <span class="n">listcoords</span> <span class="o">=</span> <span class="n">cachedobj</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
                        <span class="k">elif</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span>
                            <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span>
                        <span class="p">]:</span>
                            <span class="c1"># sets de coords</span>
                            <span class="n">listcoords</span> <span class="o">=</span> <span class="n">cachedobj</span>
                <span class="c1"># cache temporaire :</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="c1"># cache invariant :</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">listcoords</span>

    <span class="k">def</span> <span class="nf">_get_cached_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typeobject</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un objet mis en cache ou bien None</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            typeobject (str): line, column, submatrice, subshape, sublosange, case_list, </span>
<span class="sd">                case_set, coords, theoric_coords, rectangle_coords, losange_coords, </span>
<span class="sd">                subshape_coords, impacted </span>
<span class="sd">            **kwargs : paramètres associés à l&#39;objet</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># filtrage en fonction du niveau de cache</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;case_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;case_set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;theoric_coords&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;case_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;case_set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;theoric_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="s2">&quot;column&quot;</span><span class="p">,</span>
            <span class="s2">&quot;submatrice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subshape&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sublosange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;impacted&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># objets simples :</span>
        <span class="k">if</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;case_list&quot;</span><span class="p">,</span> <span class="s2">&quot;case_set&quot;</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="s2">&quot;theoric_coords&quot;</span><span class="p">]:</span>
            <span class="c1"># cache temporaire</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span>
            <span class="c1"># cache invariant :</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">value</span> <span class="o">==</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span>
                <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="s2">&quot;theoric_coords&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span>
        <span class="c1"># objets composés :</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">listargs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">listcoords</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;submatrice&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;strictmode&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;sublosange&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="s2">&quot;dim&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;subshape&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;shapefactor&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;losange_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="s2">&quot;dim&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;subshape_coords&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;impacted&quot;</span><span class="p">:</span>
                <span class="n">listargs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;impact&quot;</span><span class="p">]</span>
            <span class="c1"># 1- Test de validité :</span>
            <span class="n">valide</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">listargs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">valide</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="c1"># 2- Recherche dans le cache :</span>
            <span class="k">if</span> <span class="n">valide</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">listargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lk</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">listargs</span><span class="p">]</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span>
                <span class="c1"># recherche dans le cache temporaire :</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
                <span class="c1"># recherche dans le cache invariant :</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span>
                    <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">listcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invariant_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
                        <span class="c1"># reconstitution du cache temporaire :</span>
                        <span class="k">if</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">]:</span>
                            <span class="c1"># liste</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">listcoords</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">typeobject</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
                                <span class="n">value</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">value</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
                        <span class="k">elif</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;submatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;sublosange&quot;</span><span class="p">,</span> <span class="s2">&quot;subshape&quot;</span><span class="p">]:</span>
                            <span class="c1"># matrice</span>
                            <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                                <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">1</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">(</span><span class="n">cachelevel</span><span class="o">=</span><span class="n">cachelevel</span><span class="p">)</span>
                            <span class="n">cachedmatdict</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
                            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">listcoords</span><span class="p">:</span>
                                <span class="n">cachedmatdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">typeobject</span> <span class="ow">in</span> <span class="p">[</span>
                            <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span>
                        <span class="p">]:</span>
                            <span class="c1"># set de coords</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">listcoords</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="n">typeobject</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="c1">#-----&gt; Pptés géométriques</span>
<div class="viewcode-block" id="Matrice.get_dimensions"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">get_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne w, h</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span></div>

<div class="viewcode-block" id="Matrice.get_lefttop_point"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_lefttop_point">[docs]</a>    <span class="k">def</span> <span class="nf">get_lefttop_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le point haut gauche</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span></div>

<div class="viewcode-block" id="Matrice.get_center"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_center">[docs]</a>    <span class="k">def</span> <span class="nf">get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coords (x, y) du point équivalent au centre</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_centerpoint</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_centerpoint</span></div>

<div class="viewcode-block" id="Matrice.compute_dimensions"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.compute_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">compute_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul des dimensions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">minx</span> <span class="o">=</span> <span class="n">miny</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">xlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">ylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lk</span><span class="p">:</span>
                <span class="n">xlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">ylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">w</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">minx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xlist</span><span class="p">)</span>
            <span class="n">miny</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ylist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">minx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">miny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">miny</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_centerpoint</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lefttoppoint</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Matrice.get_diagonale_len"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_diagonale_len">[docs]</a>    <span class="k">def</span> <span class="nf">get_diagonale_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la dimension de sa diagonale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wm</span><span class="p">,</span> <span class="n">hm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wm</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">hm</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Gestion d&#39;une case</span>
<div class="viewcode-block" id="Matrice.get_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_case">[docs]</a>    <span class="k">def</span> <span class="nf">get_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Getter de case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Matrice.set_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.set_case">[docs]</a>    <span class="k">def</span> <span class="nf">set_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter de case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">case</span> <span class="o">!=</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
            <span class="ow">and</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="p">):</span>
            <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">)]</span> <span class="o">=</span> <span class="n">case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_case_changed</span><span class="p">(</span><span class="n">case</span><span class="p">)</span></div>

<div class="viewcode-block" id="Matrice.move_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.move_case">[docs]</a>    <span class="k">def</span> <span class="nf">move_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Déplace la case aux coordonnées nextx, nexty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oldx</span><span class="p">,</span> <span class="n">oldy</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[(</span><span class="n">oldx</span><span class="p">,</span> <span class="n">oldy</span><span class="p">)]</span>
        <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[(</span><span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">)]</span> <span class="o">=</span> <span class="n">case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_case_changed</span><span class="p">(</span><span class="n">case</span><span class="p">)</span></div>

<div class="viewcode-block" id="Matrice.delete_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.delete_case">[docs]</a>    <span class="k">def</span> <span class="nf">delete_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime une case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_case_changed</span><span class="p">(</span><span class="n">case</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_on_case_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour du cache</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;case_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;case_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">d1cache</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;column&quot;</span><span class="p">]]</span>
                <span class="n">d2cache</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;submatrice&quot;</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;subshape&quot;</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;sublosange&quot;</span><span class="p">],</span>
                <span class="p">]</span>
                <span class="n">d3cache</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_temp_cache</span><span class="p">[</span><span class="s2">&quot;impacted&quot;</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">d1c</span> <span class="ow">in</span> <span class="n">d1cache</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d1c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">d1c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">d2c</span> <span class="ow">in</span> <span class="n">d2cache</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">get_set_cases</span><span class="p">():</span>
                            <span class="k">del</span> <span class="n">d2c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">d3c</span> <span class="ow">in</span> <span class="n">d3cache</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d3c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">d3c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="c1">#-----&gt; Gestion globale</span>
<div class="viewcode-block" id="Matrice.copy"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une copie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newMat</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
        <span class="c1"># copie rapide (sans faire appel à set_case)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">newMat</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">newMat</span></div>

<div class="viewcode-block" id="Matrice.clear"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Efface  toutes les cases de la matrice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_cache</span><span class="p">()</span></div>

<div class="viewcode-block" id="Matrice.get_inner_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_inner_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_inner_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le dict d&#39;enregistrement des cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span></div>

<div class="viewcode-block" id="Matrice.get_signature"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_signature">[docs]</a>    <span class="k">def</span> <span class="nf">get_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une chaine constituée des cuid de ses cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">linemark</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">signature</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">cuid</span>
            <span class="n">signature</span> <span class="o">+=</span> <span class="n">linemark</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">signature</span></div>

    <span class="c1">#-----&gt; Getters de listes, sets, dicts</span>
<div class="viewcode-block" id="Matrice.get_list_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_list_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_list_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de toutes les cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cachelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;case_list&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachelist</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachelist</span>
        <span class="c1"># calcul et mise en cache :</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_cases_cache</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">lc</span></div>

<div class="viewcode-block" id="Matrice.get_set_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_set_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_set_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de toutes les cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cacheset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;case_set&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cacheset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cacheset</span>
        <span class="c1"># calcul et mise en cache :</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_cases_cache</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">sc</span></div>

    <span class="k">def</span> <span class="nf">_compute_cases_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met en cache la liste et le set de toutes les cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># calcul</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span> <span class="s2">&quot;case_list&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="s2">&quot;case_set&quot;</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">lc</span><span class="p">,</span> <span class="n">sc</span>

<div class="viewcode-block" id="Matrice.get_theoric_coords_set"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_theoric_coords_set">[docs]</a>    <span class="k">def</span> <span class="nf">get_theoric_coords_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de toutes les coordonnées possibles de la matrice. </span>
<span class="sd">        Rq : get_coords_set renvoit uniquement les coords utilisées</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cacheset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;theoric_coords&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cacheset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cacheset</span>
        <span class="c1"># calcul et mise en cache :</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lefttop_point</span><span class="p">()</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">coordset</span><span class="p">,</span> <span class="s2">&quot;theoric_coords&quot;</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">coordset</span></div>

<div class="viewcode-block" id="Matrice.get_coords_set"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_coords_set">[docs]</a>    <span class="k">def</span> <span class="nf">get_coords_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set de coords des cases de la matrice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache ?</span>
        <span class="n">cacheset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;coords&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cacheset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cacheset</span>
        <span class="c1"># calcul et mise en cache :</span>
        <span class="n">caseset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_set_cases</span><span class="p">()</span>
        <span class="n">coordset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">caseset</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">coordset</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">coordset</span></div>

<div class="viewcode-block" id="Matrice.get_segment"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_segment">[docs]</a>    <span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case1</span><span class="p">,</span> <span class="n">case2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Si case1 et case 2 sont sur la même ligne ou la même colonne, retourne la liste</span>
<span class="sd">        des cases constituant le segment (triée par coord croissante), ou None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">case1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case1</span><span class="o">.</span><span class="n">y</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">case2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case2</span><span class="o">.</span><span class="n">y</span>
        <span class="n">liste</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">liste</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">ly</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
            <span class="n">ly</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">ly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">ly</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">liste</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">:</span>
            <span class="n">ligne</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
            <span class="n">liste</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">lx</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]</span>
            <span class="n">lx</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lx</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ligne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">liste</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">liste</span></div>

<div class="viewcode-block" id="Matrice.get_line"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_line">[docs]</a>    <span class="k">def</span> <span class="nf">get_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste des cases de la ligne i</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache</span>
        <span class="n">cachedline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedline</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedline</span>
        <span class="c1"># calcul</span>
        <span class="n">ligne</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">yref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lefttop_point</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="n">yref</span><span class="p">:</span>
                <span class="n">ligne</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">ligne</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">ligne</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">ligne</span></div>

<div class="viewcode-block" id="Matrice.get_column"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_column">[docs]</a>    <span class="k">def</span> <span class="nf">get_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste des cases de la colonne j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache</span>
        <span class="n">cachedcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedcol</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedcol</span>
        <span class="c1"># calcul</span>
        <span class="n">col</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lefttop_point</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">j</span> <span class="o">+</span> <span class="n">xref</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">col</span></div>

<div class="viewcode-block" id="Matrice.get_cases_adjacentes"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_cases_adjacentes">[docs]</a>    <span class="k">def</span> <span class="nf">get_cases_adjacentes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le dict {&quot;top&quot;:, &quot;bottom&quot;:, &quot;left&quot;:, &quot;right&quot;:}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">cr</span> <span class="o">=</span> <span class="n">ct</span> <span class="o">=</span> <span class="n">cb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">cr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">h</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="n">cl</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="n">cr</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="n">ct</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="n">cb</span><span class="p">}</span></div>

<div class="viewcode-block" id="Matrice.get_cases_impacted_around"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_cases_impacted_around">[docs]</a>    <span class="k">def</span> <span class="nf">get_cases_impacted_around</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">danger_impact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le set des cases entourant case, impactées par un danger de puissance</span>
<span class="sd">        danger_impact</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">danger_impact</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">danger_impact</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">rset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># cache</span>
            <span class="n">cachedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span>
                <span class="s2">&quot;impacted&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">impact</span><span class="o">=</span><span class="n">danger_impact</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cachedset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cachedset</span>
            <span class="n">flatmatrice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flat_matrice</span><span class="p">()</span>
            <span class="n">coordset</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">danger_impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
                <span class="n">coordset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_losange_coords</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">danger_impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
                <span class="n">coordset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">danger_impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">):</span>
                <span class="n">coordset</span> <span class="o">=</span> <span class="n">flatmatrice</span><span class="o">.</span><span class="n">get_losange_coords</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">danger_impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
                <span class="n">coordset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subshape_coords</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">danger_impact</span> <span class="o">&gt;=</span> <span class="mi">25</span><span class="p">:</span>
                <span class="n">coordset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_submatrice</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coordset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># réduction aux coordonnées existantes :</span>
                <span class="n">realset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
                <span class="n">finalset</span> <span class="o">=</span> <span class="n">coordset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
                <span class="n">rset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">danger_impact</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
            <span class="c1"># mise en cache</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span>
                <span class="n">rset</span><span class="p">,</span> <span class="s2">&quot;impacted&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">impact</span><span class="o">=</span><span class="n">danger_impact</span>
            <span class="p">)</span>
            <span class="c1"># retour</span>
            <span class="k">return</span> <span class="n">rset</span></div>

<div class="viewcode-block" id="Matrice.get_case_by_type"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_case_by_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_case_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typecase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        retourne la liste des cases de type typecase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">type_case</span> <span class="o">==</span> <span class="n">typecase</span><span class="p">:</span>
                <span class="n">rl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rl</span></div>

    <span class="c1">#-----&gt; Référence à une éventuelle matrice mère</span>
    <span class="k">def</span> <span class="nf">_get_parent_matrice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_matrice</span>

    <span class="k">def</span> <span class="nf">_set_parent_matrice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">Matrice</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent_matrice</span> <span class="o">=</span> <span class="n">mat</span>

    <span class="n">parent_matrice</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_parent_matrice</span><span class="p">,</span> <span class="n">_set_parent_matrice</span>
    <span class="p">)</span>  <span class="c1">#: éventuelle matrice parente</span>

    <span class="c1">#-----&gt; Getters de sous matrices</span>
<div class="viewcode-block" id="Matrice.get_submatrice"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_submatrice">[docs]</a>    <span class="k">def</span> <span class="nf">get_submatrice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">strictmode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autocache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une sous matrice</span>
<span class="sd">        </span>
<span class="sd">        * si strictmode : retourne la sous matrice d&#39;origine x, y et de dims w, h ou None si</span>
<span class="sd">          les paramètres sont incohérents avec la géométrie de la matrice</span>
<span class="sd">        * sinon : retourne une sous matrice éventuellement tronquée</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache</span>
        <span class="n">cachedsubmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span>
            <span class="s2">&quot;submatrice&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">strictmode</span><span class="o">=</span><span class="n">strictmode</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedsubmat</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedsubmat</span>
        <span class="c1"># calcul</span>
        <span class="c1"># set de coordonnées générées:</span>
        <span class="n">genset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rectangle_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="c1"># test de validité :</span>
        <span class="n">valide</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">strictmode</span><span class="p">:</span>
            <span class="c1"># set de coordonnées maximal :</span>
            <span class="n">maxset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_theoric_coords_set</span><span class="p">()</span>
            <span class="c1"># set de coordonnées possibles :</span>
            <span class="n">redset</span> <span class="o">=</span> <span class="n">genset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">maxset</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">redset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">genset</span><span class="p">):</span>
                <span class="n">valide</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">genset</span> <span class="o">=</span> <span class="n">redset</span>
        <span class="c1"># création de la sous matrice :</span>
        <span class="n">subm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">valide</span><span class="p">:</span>
            <span class="c1"># sous matrice :</span>
            <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">autocache</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">subm</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">(</span><span class="n">cachelevel</span><span class="o">=</span><span class="n">cachelevel</span><span class="p">)</span>
            <span class="c1"># réduction aux coordonnées existantes :</span>
            <span class="n">realset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
            <span class="n">finalset</span> <span class="o">=</span> <span class="n">genset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
            <span class="c1"># alimentation rapide :</span>
            <span class="n">subdict</span> <span class="o">=</span> <span class="n">subm</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">:</span>
                <span class="n">subdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span>
            <span class="c1"># parent ref :</span>
            <span class="n">subm</span><span class="o">.</span><span class="n">parent_matrice</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span>
            <span class="n">subm</span><span class="p">,</span> <span class="s2">&quot;submatrice&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">strictmode</span><span class="o">=</span><span class="n">strictmode</span>
        <span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">subm</span></div>

<div class="viewcode-block" id="Matrice.get_sublosange"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_sublosange">[docs]</a>    <span class="k">def</span> <span class="nf">get_sublosange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une sous matrice tronquée en forme de losange, centrée en xc, yc</span>
<span class="sd">        et de dimension impaire dim.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># parité :</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># cache</span>
        <span class="n">cachedsubmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;sublosange&quot;</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedsubmat</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedsubmat</span>
        <span class="c1"># coords théoriques du losange :</span>
        <span class="n">thset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_losange_coords</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
        <span class="c1"># élimination des coords absurdes</span>
        <span class="n">realset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
        <span class="n">finalset</span> <span class="o">=</span> <span class="n">thset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
        <span class="c1"># création de la sous matrice :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># sous matrice :</span>
            <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">subm</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">(</span><span class="n">cachelevel</span><span class="o">=</span><span class="n">cachelevel</span><span class="p">)</span>
            <span class="c1"># copie rapide des cases :</span>
            <span class="n">subdict</span> <span class="o">=</span> <span class="n">subm</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">:</span>
                <span class="n">subdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span>
            <span class="c1"># parent ref :</span>
            <span class="n">subm</span><span class="o">.</span><span class="n">parent_matrice</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">subm</span><span class="p">,</span> <span class="s2">&quot;sublosange&quot;</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">subm</span></div>

<div class="viewcode-block" id="Matrice.get_subshape"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_subshape">[docs]</a>    <span class="k">def</span> <span class="nf">get_subshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">shapefactor</span><span class="o">=</span><span class="mi">17</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une sous matrice tronquée de forme non rectangulaire.</span>
<span class="sd">        </span>
<span class="sd">        * x, y : centre de la forme</span>
<span class="sd">        * shapefactor : nombre de cases de la forme (17 : carré crénelé)</span>
<span class="sd">        </span>
<span class="sd">        Application : zones d&#39;impacts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">shapefactor</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># cache</span>
        <span class="n">cachedsubshape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span>
            <span class="s2">&quot;subshape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">shapefactor</span><span class="o">=</span><span class="n">shapefactor</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedsubshape</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedsubshape</span>
        <span class="c1"># calcul</span>
        <span class="n">thset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subshape_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="c1"># élimination des coords absurdes</span>
        <span class="n">realset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_set</span><span class="p">()</span>
        <span class="n">finalset</span> <span class="o">=</span> <span class="n">thset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">realset</span><span class="p">)</span>
        <span class="c1"># création de la sous matrice :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">finalset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># sous matrice :</span>
            <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachelevel</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">cachelevel</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">subm</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">(</span><span class="n">cachelevel</span><span class="o">=</span><span class="n">cachelevel</span><span class="p">)</span>
            <span class="c1"># copie rapide des cases :</span>
            <span class="n">subdict</span> <span class="o">=</span> <span class="n">subm</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">finalset</span><span class="p">:</span>
                <span class="n">subdict</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span>
            <span class="c1"># parent ref :</span>
            <span class="n">subm</span><span class="o">.</span><span class="n">parent_matrice</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">subm</span><span class="p">,</span> <span class="s2">&quot;subshape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">shapefactor</span><span class="o">=</span><span class="n">shapefactor</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">subm</span></div>

    <span class="c1">#-----&gt; Getters de sets de coordonnées</span>
<div class="viewcode-block" id="Matrice.get_rectangle_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_rectangle_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_rectangle_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coordonnées des cases de la matrice de point haut gauche</span>
<span class="sd">        (x, y) et de dimensions w * h. </span>
<span class="sd">        Rq : set complet, non réduit aux coords théoriques ou existantes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># cache</span>
        <span class="n">cachedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedset</span>
        <span class="c1"># calcul</span>
        <span class="n">genset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_rectangle_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)])</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">genset</span><span class="p">,</span> <span class="s2">&quot;rectangle_coords&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">genset</span></div>

<div class="viewcode-block" id="Matrice.get_losange_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_losange_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_losange_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coordonnées des cases d&#39;une matrice de forme losange,</span>
<span class="sd">        centrée en (xc, yc) et de dimension (impaire) dim. </span>
<span class="sd">        Rq : set complet, non réduit aux coords théoriques ou existantes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># parité :</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># cache</span>
        <span class="n">cachedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedset</span>
        <span class="c1"># calcul :</span>
        <span class="n">genset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_losange_coords</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="p">)])</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">genset</span><span class="p">,</span> <span class="s2">&quot;losange_coords&quot;</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">genset</span></div>

<div class="viewcode-block" id="Matrice.get_subshape_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.get_subshape_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_subshape_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">shapefactor</span><span class="o">=</span><span class="mi">17</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coords d&#39;une sous matrice 5*5 centrée en xc, yc, tronquée</span>
<span class="sd">        symétriquement à 17 cases. </span>
<span class="sd">        Rq : set complet, non réduit aux coords théoriques ou existantes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">shapefactor</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># cache</span>
        <span class="n">cachedset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cached_object</span><span class="p">(</span><span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cachedset</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cachedset</span>
        <span class="c1"># calcul</span>
        <span class="n">genset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_subshape_coords</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">)])</span>
        <span class="c1"># mise en cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cached_object</span><span class="p">(</span><span class="n">genset</span><span class="p">,</span> <span class="s2">&quot;subshape_coords&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">)</span>
        <span class="c1"># retour</span>
        <span class="k">return</span> <span class="n">genset</span></div>

    <span class="c1">#-----&gt; Générateurs de sets de coordonnées</span>
<div class="viewcode-block" id="Matrice.gen_rectangle_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.gen_rectangle_coords">[docs]</a>    <span class="k">def</span> <span class="nf">gen_rectangle_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère les coordonnées des cases de la matrice de point haut gauche</span>
<span class="sd">        (x, y) et de dimensions w * h</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">):</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="Matrice.gen_losange_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.gen_losange_coords">[docs]</a>    <span class="k">def</span> <span class="nf">gen_losange_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère les coordonnées des cases d&#39;une matrice de forme losange,</span>
<span class="sd">        centrée en (xc, yc) et de dimension (impaire) dim. </span>
<span class="sd">        Rq : la parité n&#39;est pas vérifiée au niveau du générateur.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">adim</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">maxrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="n">adim</span><span class="p">,</span> <span class="n">xc</span> <span class="o">+</span> <span class="n">adim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">yc</span> <span class="o">-</span> <span class="n">adim</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">adim</span><span class="p">))</span>
            <span class="n">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxrange</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">maxrange</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="Matrice.gen_subshape_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.gen_subshape_coords">[docs]</a>    <span class="k">def</span> <span class="nf">gen_subshape_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coords d&#39;une sous matrice 5*5 centrée en xc, yc, tronquée</span>
<span class="sd">        symétriquement à 17 cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">adim</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">maxrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">xc</span> <span class="o">-</span> <span class="n">adim</span><span class="p">,</span> <span class="n">xc</span> <span class="o">+</span> <span class="n">adim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">yc</span> <span class="o">-</span> <span class="n">adim</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">adim</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxrange</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">maxrange</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">delta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">xrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxrange</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxrange</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xrange</span> <span class="o">=</span> <span class="n">maxrange</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Particularisation</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lefttop_point</span><span class="p">()</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dimensions</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;Matrice left=</span><span class="si">{}</span><span class="s2"> top=</span><span class="si">{}</span><span class="s2"> w=</span><span class="si">{}</span><span class="s2"> h=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="AnimatedLayer"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer">[docs]</a><span class="k">class</span> <span class="nc">AnimatedLayer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une couche d&#39;animation. </span>
<span class="sd">    </span>
<span class="sd">    La clef d&#39;identification d&#39;une case ne peut plus être ses coordonnées (elles peuvent </span>
<span class="sd">    varier, se recouvrir entre cases), mais un identifiant unique de case.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<div class="viewcode-block" id="AnimatedLayer.copy"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une copie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newAL</span> <span class="o">=</span> <span class="n">AnimatedLayer</span><span class="p">()</span>
        <span class="c1"># copie rapide (sans faire appel à set_case)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">newAL</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">newAL</span></div>

<div class="viewcode-block" id="AnimatedLayer.set_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.set_case">[docs]</a>    <span class="k">def</span> <span class="nf">set_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter de case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">case</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case</span><span class="p">,</span> <span class="n">CaseAnimation</span><span class="p">):</span>
                <span class="n">uid</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">anim_uid</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">case</span>
            <span class="k">elif</span> <span class="n">case</span><span class="o">.</span><span class="n">type_case</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DEBUG</span><span class="p">:</span>
                <span class="n">uid</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">cuid</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">case</span></div>

<div class="viewcode-block" id="AnimatedLayer.move_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.move_case">[docs]</a>    <span class="k">def</span> <span class="nf">move_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Déplace la case aux coordonnées nextx, nexty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">nextx</span><span class="p">,</span> <span class="n">nexty</span></div>

<div class="viewcode-block" id="AnimatedLayer.delete_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.delete_case">[docs]</a>    <span class="k">def</span> <span class="nf">delete_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime une case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">case</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case</span><span class="p">,</span> <span class="n">CaseAnimation</span><span class="p">):</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">anim_uid</span>
            <span class="k">if</span> <span class="n">uid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span></div>

<div class="viewcode-block" id="AnimatedLayer.clear"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Efface  toutes les cases de la matrice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnimatedLayer.get_list_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.get_list_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_list_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de toutes les cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

<div class="viewcode-block" id="AnimatedLayer.get_set_cases"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.get_set_cases">[docs]</a>    <span class="k">def</span> <span class="nf">get_set_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de toutes les cases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_matrice</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

<div class="viewcode-block" id="AnimatedLayer.project_layer_on_matrice"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.project_layer_on_matrice">[docs]</a>    <span class="k">def</span> <span class="nf">project_layer_on_matrice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sortkey</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Projette la couche sur une matrice. Si deux cases ont les mêmes</span>
<span class="sd">        propriétés case.sortkey, celle de valeur la plus élévée sera retenue. </span>
<span class="sd">        Application : projection de cases d&#39;animation, avec sortkey=&quot;anim_uid&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Matrice</span><span class="p">()</span>
        <span class="n">mdict</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_inner_dict</span><span class="p">()</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_list_cases</span><span class="p">()</span>
        <span class="c1"># trie par sortkey croissant :</span>
        <span class="n">lc</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="n">sortkey</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lc</span><span class="p">:</span>
            <span class="c1"># copie rapide :</span>
            <span class="n">mdict</span><span class="p">[(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">m</span></div></div>


<div class="viewcode-block" id="Case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case">[docs]</a><span class="k">class</span> <span class="nc">Case</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une case du Labyrinthe</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Compteur interne pour la création d&#39;uid de case</span>
    <span class="n">_CUID_COUNT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="Case.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">casedict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">casedict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>

<div class="viewcode-block" id="Case.generate_cuid"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.generate_cuid">[docs]</a>    <span class="k">def</span> <span class="nf">generate_cuid</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère un identifiant unique de case. </span>
<span class="sd">        Usage : debug</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">char_tc</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">get_txt_for_role</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">type_case</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_CUID_COUNT</span><span class="p">)</span>
        <span class="n">cuid</span> <span class="o">=</span> <span class="n">char_tc</span> <span class="o">+</span> <span class="n">num</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_CUID_COUNT</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cuid</span></div>

    <span class="n">generate_cuid</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">generate_cuid</span><span class="p">)</span>
    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">type_case</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_case</span> <span class="o">=</span> <span class="n">type_case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="n">face</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="n">visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cuid</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">generate_cuid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Case.get_properties_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.get_properties_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne ses paramètres sous forme de dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">casedict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_case</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span>
        <span class="n">casedict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span>
        <span class="k">return</span> <span class="n">casedict</span></div>

    <span class="c1"># getters / setters de coordonnées</span>
    <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="k">def</span> <span class="nf">_set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseInt</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_x</span><span class="p">,</span> <span class="n">_set_x</span><span class="p">)</span>  <span class="c1">#: coord x</span>

    <span class="k">def</span> <span class="nf">_get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="k">def</span> <span class="nf">_set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseInt</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_y</span><span class="p">,</span> <span class="n">_set_y</span><span class="p">)</span>  <span class="c1">#: coord y</span>

<div class="viewcode-block" id="Case.parseBool"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.parseBool">[docs]</a>    <span class="k">def</span> <span class="nf">parseBool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un booléan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Case.parseInt"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.parseInt">[docs]</a>    <span class="k">def</span> <span class="nf">parseInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un int ou bien None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Case.parseFloat"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.parseFloat">[docs]</a>    <span class="k">def</span> <span class="nf">parseFloat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un Float ou bien None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">REGEXP_FLOAT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Case.on_case_added"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.on_case_added">[docs]</a>    <span class="k">def</span> <span class="nf">on_case_added</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque la case est ajoutée à une matrice via le LabLevel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rend l&#39;objet &quot;subscriptable&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Case cuid=</span><span class="si">{}</span><span class="s2"> x=</span><span class="si">{}</span><span class="s2"> y=</span><span class="si">{}</span><span class="s2"> type_case=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_case</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Case cuid=</span><span class="si">{}</span><span class="s2"> x=</span><span class="si">{}</span><span class="s2"> y=</span><span class="si">{}</span><span class="s2"> type_case=</span><span class="si">{}</span><span class="s2"> face=</span><span class="si">{}</span><span class="s2"> vis=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_case</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="CaseRobot"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot">[docs]</a><span class="k">class</span> <span class="nc">CaseRobot</span><span class="p">(</span><span class="n">Case</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Particularise une case de type robot</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Données de modélisation statiques :</span>
    <span class="c1"># marqueur de joueur humain</span>
    <span class="n">BEHAVIOR_HUMAN</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_HUMAN&quot;</span>  <span class="c1">#: marque un joueur de type humain</span>
    <span class="c1"># comportement des robots automatiques</span>
    <span class="n">BEHAVIOR_WINNER</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_WINNER&quot;</span>  <span class="c1">#: marque un joueur de type winner</span>
    <span class="n">BEHAVIOR_RANDOM</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_RANDOM&quot;</span>  <span class="c1">#: marque un joueur de type random</span>
    <span class="n">BEHAVIOR_HUNTER</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_HUNTER&quot;</span>  <span class="c1">#: marque un joueur de type chasseur</span>
    <span class="n">BEHAVIOR_TOURIST</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_TOURIST&quot;</span>  <span class="c1">#: marque un joueur de type touriste</span>
    <span class="n">BEHAVIOR_BUILDER</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_BUILDER&quot;</span>  <span class="c1">#: marque un joueur de type maçon</span>
    <span class="n">BEHAVIOR_SAPPER</span> <span class="o">=</span> <span class="s2">&quot;BEHAVIOR_SAPPER&quot;</span>  <span class="c1">#: marque un joueur de type mineur</span>
    <span class="n">FAMILLE_BEHAVIOR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">BEHAVIOR_WINNER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_RANDOM</span><span class="p">,</span>
        <span class="n">BEHAVIOR_HUNTER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_TOURIST</span><span class="p">,</span>
        <span class="n">BEHAVIOR_BUILDER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_SAPPER</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: types des joueurs automatiques</span>
    <span class="n">ALL_BEHAVIORS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">BEHAVIOR_WINNER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_RANDOM</span><span class="p">,</span>
        <span class="n">BEHAVIOR_HUNTER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_TOURIST</span><span class="p">,</span>
        <span class="n">BEHAVIOR_BUILDER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_SAPPER</span><span class="p">,</span>
        <span class="n">BEHAVIOR_HUMAN</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: types exhaustifs</span>
    <span class="c1"># représentation par défaut :</span>
    <span class="n">char_repr_BEHAVIOR_HUMAN</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un humain</span>
    <span class="n">char_repr_BEHAVIOR_WINNER</span> <span class="o">=</span> <span class="s2">&quot;W&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un winner</span>
    <span class="n">char_repr_BEHAVIOR_RANDOM</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un random</span>
    <span class="n">char_repr_BEHAVIOR_HUNTER</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un chasseur</span>
    <span class="n">char_repr_BEHAVIOR_TOURIST</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un touriste</span>
    <span class="n">char_repr_BEHAVIOR_BUILDER</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un maçon</span>
    <span class="n">char_repr_BEHAVIOR_SAPPER</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>  <span class="c1">#: caractère d&#39;affichage d&#39;un mineur</span>
    <span class="c1"># vitesse initiale :</span>
    <span class="n">VITESSE_INITIALE</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1">#: vitesse initiale du joueur&quot;</span>
    <span class="c1"># Nombre de cases passées mémorisées au max</span>
    <span class="n">MAX_PASSED_CASES</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1">#: nombre de cases passées mémorisées</span>
    <span class="c1"># Nombre de séquences (coups consécutifs) mémorisées :</span>
    <span class="n">MAX_SEQ_COUNT</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1">#: nombre de séquences de coups mémorisées</span>
    <span class="c1"># seuils par capacités</span>
    <span class="n">FEATURE_THRESHOLDS</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: seuils par capacités</span>
    <span class="c1"># seuils génériques</span>
    <span class="n">THRES_MID</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1">#: seuil générique moyen</span>
    <span class="n">THRES_HIGH</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1">#: seuil générique haut</span>
    <span class="c1"># liste des caractéristiques comportementales</span>
    <span class="n">FEATURES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;intelligence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ambition&quot;</span><span class="p">,</span>
        <span class="s2">&quot;instinct_survie&quot;</span><span class="p">,</span>
        <span class="s2">&quot;curiosite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;aggressivite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;efficacite&quot;</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: liste des caractéristiques comportementales</span>
    <span class="c1"># stratégies de recherche de bonus :</span>
    <span class="n">STRAT_BONUS_ALL</span> <span class="o">=</span> <span class="s2">&quot;bonus_all&quot;</span>  <span class="c1">#: stratégie n&#39;importe quel bonus</span>
    <span class="n">STRAT_BONUS_TARGET</span> <span class="o">=</span> <span class="s2">&quot;bonus_target&quot;</span>  <span class="c1">#: stratégie bonus cohérents avec la cible</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="CaseRobot.init_feature_thresholds"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.init_feature_thresholds">[docs]</a>    <span class="k">def</span> <span class="nf">init_feature_thresholds</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les seuils associés aux caractéristiques des robots.</span>
<span class="sd">        Rq : le dict permet de personnaliser les seuils pour chaque</span>
<span class="sd">        carcatéristique. En V1 on standardise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dft</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;efficacite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;ambition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">}</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;instinct_survie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;curiosite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">}</span>
        <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;intelligence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span><span class="p">,</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">,</span>
        <span class="p">}</span></div>

    <span class="n">init_feature_thresholds</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">init_feature_thresholds</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.get_feature_threshold"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_feature_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_threshold</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne une valeur entre 0 et 1 pour une feature (efficacite, ...) et</span>
<span class="sd">        un level parmi &quot;middle&quot; ou &quot;high&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">level</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">]:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="n">level</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">val</span></div>

    <span class="n">get_feature_threshold</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_feature_threshold</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.get_feature_threshold_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_feature_threshold_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_threshold_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le dict de seuils par caractéristiques.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">CaseRobot</span><span class="o">.</span><span class="n">init_feature_thresholds</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span></div>

    <span class="n">get_feature_threshold_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_feature_threshold_dict</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">robotdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_default_dict</span><span class="p">()</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ROBOT</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;alive&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;uid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">VITESSE_INITIALE</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;ambition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;instinct_survie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;curiosite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;efficacite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;intelligence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;order&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">robotdict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.configure_behavior"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.configure_behavior">[docs]</a>    <span class="k">def</span> <span class="nf">configure_behavior</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">robot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique particularisant le comportement d&#39;un robot</span>
<span class="sd">        V1 : gère le caractère de représentation texte</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># plage de valeurs en fonction des seuils :</span>
        <span class="n">vlow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">vlowmid</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">vmid</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">vmidhigh</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_MID</span> <span class="o">+</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">vhigh</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">vhightop</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">THRES_HIGH</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">vtop</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># en fonction du comportement :</span>
        <span class="n">behavior</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">behavior</span>
        <span class="k">if</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_WINNER</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vhigh</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vhigh</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vmid</span><span class="p">,</span> <span class="n">vhightop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vhigh</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_RANDOM</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlowmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vhigh</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_TOURIST</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vhightop</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_BUILDER</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlowmid</span><span class="p">,</span> <span class="n">vhightop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmidhigh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlowmid</span><span class="p">,</span> <span class="n">vhigh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmidhigh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_SAPPER</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlowmid</span><span class="p">,</span> <span class="n">vtop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vmidhigh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlowmid</span><span class="p">,</span> <span class="n">vmidhigh</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vhightop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">vlow</span><span class="p">,</span> <span class="n">vlowmid</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span><span class="p">:</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">vmid</span> <span class="o">/</span> <span class="mi">100</span></div>

    <span class="n">configure_behavior</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">configure_behavior</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.get_features_radar_datas"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_features_radar_datas">[docs]</a>    <span class="k">def</span> <span class="nf">get_features_radar_datas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un dict permettant de tracer le graphe radar des</span>
<span class="sd">        caractéristiques du robot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">clsdict</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">clsdict</span><span class="p">:</span>
            <span class="n">rdict</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rdict</span></div>

<div class="viewcode-block" id="CaseRobot.get_char_repr"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_char_repr">[docs]</a>    <span class="k">def</span> <span class="nf">get_char_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">behavior</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le char de représentation en fonction du comportement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_HUMAN</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_WINNER</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_WINNER</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_RANDOM</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_RANDOM</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_HUNTER</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_TOURIST</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_TOURIST</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_BUILDER</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_BUILDER</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_SAPPER</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">char_repr_BEHAVIOR_SAPPER</span></div>

    <span class="n">get_char_repr</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_char_repr</span><span class="p">)</span>
    <span class="c1"># méthodes d&#39;instance</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robotdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case robot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># A la première instance crée</span>
        <span class="k">if</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">FEATURE_THRESHOLDS</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">CaseRobot</span><span class="o">.</span><span class="n">init_feature_thresholds</span><span class="p">()</span>
        <span class="c1"># Création de l&#39;instance</span>
        <span class="n">Case</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">],</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">],</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;alive&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;uid&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">human</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">human</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">human_number</span> <span class="o">=</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human_number&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">human</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">=</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;behavior&quot;</span><span class="p">]</span>
        <span class="c1"># capacités pouvant être améliorées via les bonus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vitesse</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_mine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_mine&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_grenade</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_grenade&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puissance_mine</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_mine&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_grenade&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portee_grenade</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">])</span>
        <span class="c1"># mémorisation des propriétés modifiées lors d&#39;un coup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># nombre total de coups dans le tour courant:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># numéro du coup en cours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># vitesse réelle à un instant donné</span>
        <span class="c1"># (nb de coups restant à jouer dans le tour)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_vitesse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vitesse</span>
        <span class="c1"># caractéristiques comportementales</span>
        <span class="n">amb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;ambition&quot;</span><span class="p">])</span>
        <span class="n">inst_surv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;instinct_survie&quot;</span><span class="p">])</span>
        <span class="n">agg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">])</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;curiosite&quot;</span><span class="p">])</span>
        <span class="n">eff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;efficacite&quot;</span><span class="p">])</span>
        <span class="n">intel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseFloat</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;intelligence&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">{</span><span class="n">amb</span><span class="p">,</span> <span class="n">inst_surv</span><span class="p">,</span> <span class="n">agg</span><span class="p">,</span> <span class="n">cur</span><span class="p">,</span> <span class="n">eff</span><span class="p">,</span> <span class="n">intel</span><span class="p">}:</span>
            <span class="n">CaseRobot</span><span class="o">.</span><span class="n">configure_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ambition</span> <span class="o">=</span> <span class="n">amb</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">=</span> <span class="n">inst_surv</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">=</span> <span class="n">agg</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curiosite</span> <span class="o">=</span> <span class="n">cur</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">=</span> <span class="n">eff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intelligence</span> <span class="o">=</span> <span class="n">intel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseInt</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;order&quot;</span><span class="p">])</span>
        <span class="c1"># cibles :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maintargetobject</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maintargetparams</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currenttemptarget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># nombre total de coups unitaires joués</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalgamblecount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Gamble data set :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_gdSet</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># phase de jeu :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_game_phasis</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># besoin de bonus ?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_bonus</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># stratégie de recherche de bonus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonus_strategy</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># nombre de bonus gagnés :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">earned_bonus</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># cases par lesquelles le robot est passé</span>
        <span class="c1"># liste de tupples (coords, gambleid)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># le robot doit il repérer les séquences de cases similaires</span>
        <span class="c1"># (outil de détection de bouclages)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_sequence_loop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># mémorisation des actions :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passedaction</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># mémorisation des coords associées aux actions MOVE (loop)</span>
        <span class="c1"># liste de dicts {&quot;start&quot;:, &quot;coords&quot;:}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># à supp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coordsequences</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># nombre de pseudos actions &quot;stay in place&quot; consécutives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_move_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># robots éliminés</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bots_killed</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_killed_innocent</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_killed_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># zones de déplacement, d&#39;attaque (sets de coords):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_zone</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_zone</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># dict de facteurs de dangers :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">danger_factor_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_danger_factor_dict</span><span class="p">()</span>

<div class="viewcode-block" id="CaseRobot.compute_danger_factor_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.compute_danger_factor_dict">[docs]</a>    <span class="k">def</span> <span class="nf">compute_danger_factor_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcule le facteur de danger associé à chaque espèce en fonction des</span>
<span class="sd">        caractéristiques comportementales du robot.</span>
<span class="sd">        </span>
<span class="sd">        - 0 : robot inoffensif</span>
<span class="sd">        - 1 : robot capable de se défendre</span>
<span class="sd">        - 2 : joueur humain au comportement inconnu encore (supposé capable de</span>
<span class="sd">          se défendre)</span>
<span class="sd">        - 3 : robot pouvant attaquer par opportunité</span>
<span class="sd">        - 4 : robot attaquant à coup sûr</span>
<span class="sd">        </span>
<span class="sd">        Rq : la gestion par dict permet de différencier les facteurs de dangers</span>
<span class="sd">        en fonction des espèces (spécisme). En V1 on standardise.        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># seuils :</span>
        <span class="n">midSUR</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">get_feature_threshold</span><span class="p">(</span><span class="s2">&quot;instinct_survie&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">)</span>
        <span class="n">midAGG</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">get_feature_threshold</span><span class="p">(</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">)</span>
        <span class="n">highAGG</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">get_feature_threshold</span><span class="p">(</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">)</span>
        <span class="n">highAMB</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">get_feature_threshold</span><span class="p">(</span><span class="s2">&quot;ambition&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">)</span>
        <span class="c1"># Par défaut</span>
        <span class="n">defaultfactor</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">:</span>
            <span class="c1"># un chasseur est un danger pour toutes les autres espèces</span>
            <span class="n">defaultfactor</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">instinct_survie</span> <span class="o">&gt;=</span> <span class="n">midSUR</span><span class="p">:</span>
            <span class="n">defaultfactor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">dgrdict</span> <span class="o">=</span> <span class="p">{</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span><span class="p">:</span> <span class="n">defaultfactor</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">behav</span> <span class="ow">in</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">FAMILLE_BEHAVIOR</span><span class="p">:</span>
            <span class="n">dgrdict</span><span class="p">[</span><span class="n">behav</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultfactor</span>
        <span class="c1"># Bots :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">human</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggressivite</span> <span class="o">&gt;=</span> <span class="n">highAGG</span><span class="p">:</span>
                <span class="c1"># un psychopathe s&#39;attaque à tout le monde</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dgrdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">elif</span> <span class="n">midAGG</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggressivite</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ambition</span> <span class="o">&gt;=</span> <span class="n">highAMB</span><span class="p">:</span>
                    <span class="c1"># un bot suffisament aggressif et très ambitieux</span>
                    <span class="c1"># peut sacrifier d&#39;autres bots en terraformant</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dgrdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
        <span class="c1"># humain</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># joueur humain :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># le joueur n&#39;a encore tué aucun innocent, facteur de danger</span>
                <span class="c1"># inconnu :</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dgrdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="c1"># les deux :</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># le joueur a tué un innocent, ça peut être une erreur,</span>
            <span class="c1"># facteur de danger possible</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dgrdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># le joueur est considéré comme un psychopathe</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">dgrdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">dgrdict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="c1"># spécisme des bots :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">:</span>
            <span class="c1"># chasseur inoffensif avec son espèce</span>
            <span class="n">dgrdict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># enregistrement :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">danger_factor_dict</span> <span class="o">=</span> <span class="n">dgrdict</span></div>

<div class="viewcode-block" id="CaseRobot.get_danger_factor_for_bot"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_danger_factor_for_bot">[docs]</a>    <span class="k">def</span> <span class="nf">get_danger_factor_for_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le facteur de danger associé au bot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># par défaut pour un humain</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span>
        <span class="k">if</span> <span class="n">bot</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">behavior</span>
        <span class="k">elif</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">ALL_BEHAVIORS</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">behavior</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_factor_dict</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="CaseRobot.get_apparent_danger_factor_for_bot"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_apparent_danger_factor_for_bot">[docs]</a>    <span class="k">def</span> <span class="nf">get_apparent_danger_factor_for_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le facteur de danger apparent associé au bot.</span>
<span class="sd">        Utilité : permettre d&#39;afficher la zone de danger des HUNTERS</span>
<span class="sd">        en toute circonstance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_danger_factor_for_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="n">behavior</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="CaseRobot.update_dyn_props"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.update_dyn_props">[docs]</a>    <span class="k">def</span> <span class="nf">update_dyn_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robotdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour des propriétés dynamiques à partir d&#39;un dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;alive&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;alive&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;vitesse&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vitesse</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;current_vitesse&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_vitesse</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_vitesse&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;current_gamble_count&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_gamble_count&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;current_gamble_number&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_gamble_number&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;has_mine&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_mine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_mine&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;has_grenade&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_grenade</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseBool</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_grenade&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;puissance_mine&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">puissance_mine</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_mine&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;puissance_grenade&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_grenade&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;portee_grenade&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">portee_grenade</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;order&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseInt</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;order&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;total_killed_count&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_killed_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;total_killed_count&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;innocent_killed_count&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;innocent_killed_count&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;earned_bonus&quot;</span> <span class="ow">in</span> <span class="n">robotdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">earned_bonus</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;earned_bonus&quot;</span><span class="p">])</span>
        <span class="c1"># maj facteurs de dangers :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_danger_factor_dict</span><span class="p">()</span></div>

<div class="viewcode-block" id="CaseRobot.get_properties_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_properties_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne ses paramètres sous forme de dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">full</span><span class="p">:</span>
            <span class="n">robotdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;alive&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;uid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">human</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;human_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">human_number</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;behavior&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vitesse</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_vitesse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_vitesse</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_gamble_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_count</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;current_gamble_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_gamble_number</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_mine</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;has_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_grenade</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">puissance_mine</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;puissance_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portee_grenade</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;ambition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ambition</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;instinct_survie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instinct_survie</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;aggressivite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggressivite</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;curiosite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curiosite</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;efficacite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;intelligence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intelligence</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;order&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;total_killed_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_killed_count</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;innocent_killed_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span>
            <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;earned_bonus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">earned_bonus</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># on se limite aux seules propriétés modifiées durant le coup</span>
            <span class="n">robotdict</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">robotdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">robotdict</span><span class="p">[</span><span class="s2">&quot;uid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="p">:</span>
                    <span class="n">robotdict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">robotdict</span></div>

<div class="viewcode-block" id="CaseRobot.get_puissance_list"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_puissance_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_puissance_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weapon</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de puissances activées pour l&#39;arme weapon (mine, grenade)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_puissance</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">weapon</span> <span class="o">==</span> <span class="s2">&quot;mine&quot;</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="s2">&quot;puissance_mine&quot;</span>
        <span class="k">elif</span> <span class="n">weapon</span> <span class="o">==</span> <span class="s2">&quot;grenade&quot;</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="s2">&quot;puissance_grenade&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">):</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">25</span><span class="p">:</span>
            <span class="n">list_puissance</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_puissance</span></div>

    <span class="k">def</span> <span class="nf">_get_current_vitesse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_vitesse</span>
    
    <span class="k">def</span> <span class="nf">_set_current_vitesse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_vitesse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_vitesse</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;current_vitesse&quot;</span><span class="p">)</span>
            
    <span class="n">current_vitesse</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_current_vitesse</span><span class="p">,</span> <span class="n">_set_current_vitesse</span><span class="p">)</span>  <span class="c1">#: vitesse apparente du robot</span>
        
<div class="viewcode-block" id="CaseRobot.register_bots_killed"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_bots_killed">[docs]</a>    <span class="k">def</span> <span class="nf">register_bots_killed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">botlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre les bots éliminés</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">botlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="bp">self</span> <span class="ow">and</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bots_killed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bots_killed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                <span class="c1"># r était il innocent?</span>
                <span class="n">dgrfacor</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">get_danger_factor_for_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_killed_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;total_killed_count&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dgrfacor</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_has_killed_innocent</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compute_danger_factor_dict</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;innocent_killed_count&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseRobot.get_bots_killed"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_bots_killed">[docs]</a>    <span class="k">def</span> <span class="nf">get_bots_killed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste des bots éliminés</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bots_killed</span></div>

<div class="viewcode-block" id="CaseRobot.is_a_murderer"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.is_a_murderer">[docs]</a>    <span class="k">def</span> <span class="nf">is_a_murderer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Le robot a t&#39;il tué des innocents?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_killed_innocent</span></div>

<div class="viewcode-block" id="CaseRobot.get_killed_counts"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_killed_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_killed_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le tupple total tués, innocents tués</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_killed_count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">innocent_killed_count</span></div>

    <span class="k">def</span> <span class="nf">_get_game_phasis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_game_phasis</span>

    <span class="k">def</span> <span class="nf">_set_game_phasis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_game_phasis</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">game_phasis</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_game_phasis</span><span class="p">,</span> <span class="n">_set_game_phasis</span><span class="p">)</span>  <span class="c1">#: phase de jeu actuelle</span>

    <span class="k">def</span> <span class="nf">_get_need_bonus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_need_bonus</span>

    <span class="k">def</span> <span class="nf">_set_need_bonus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_need_bonus</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">need_bonus</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_need_bonus</span><span class="p">,</span> <span class="n">_set_need_bonus</span>
    <span class="p">)</span>  <span class="c1">#: devrait prendre un bonus?</span>

    <span class="k">def</span> <span class="nf">_get_totalgamblecount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_totalgamblecount</span>

    <span class="k">def</span> <span class="nf">_set_totalgamblecount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_totalgamblecount</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">totalgamblecount</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_totalgamblecount</span><span class="p">,</span> <span class="n">_set_totalgamblecount</span>
    <span class="p">)</span>  <span class="c1">#: nombre de coups consécutifs à jouer</span>

    <span class="k">def</span> <span class="nf">_get_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>

    <span class="k">def</span> <span class="nf">_set_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">order</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_order</span><span class="p">,</span> <span class="n">_set_order</span><span class="p">)</span>  <span class="c1">#: ordre du joueur associé</span>

<div class="viewcode-block" id="CaseRobot.get_danger_radius"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_danger_radius">[docs]</a>    <span class="k">def</span> <span class="nf">get_danger_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le rayon d&#39;action offensif du robot</span>
<span class="sd">        Estimation large pour 5, 13 et 17, exacte pour 1, 9 et 25 (grenade)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># action kill sur un adjacent</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># prise en compte des grenades</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_grenade</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portee_grenade</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">+=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">radius</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="c1"># prise en compte de la vitesse</span>
        <span class="n">radius</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vitesse</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">radius</span></div>

<div class="viewcode-block" id="CaseRobot.get_main_target"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_main_target">[docs]</a>    <span class="k">def</span> <span class="nf">get_main_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la cible principale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maintargetobject</span></div>

<div class="viewcode-block" id="CaseRobot.set_main_target"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.set_main_target">[docs]</a>    <span class="k">def</span> <span class="nf">set_main_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetobj</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Définit la cible principale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maintargetobject</span> <span class="o">=</span> <span class="n">targetobj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maintargetparams</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="CaseRobot.get_main_target_params"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_main_target_params">[docs]</a>    <span class="k">def</span> <span class="nf">get_main_target_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les paramètres optionnels de la cible principale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maintargetparams</span></div>

<div class="viewcode-block" id="CaseRobot.get_temp_target"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_temp_target">[docs]</a>    <span class="k">def</span> <span class="nf">get_temp_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la cible actuelle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttemptarget</span></div>

<div class="viewcode-block" id="CaseRobot.set_temp_target"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.set_temp_target">[docs]</a>    <span class="k">def</span> <span class="nf">set_temp_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Définit la nouvelle cible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currenttemptarget</span> <span class="o">=</span> <span class="n">targetobj</span>
        <span class="k">if</span> <span class="n">targetobj</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># clef identifiant l&#39;objet</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">targetobj</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">targetobj</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">targetobj</span><span class="o">.</span><span class="n">direct</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="c1"># enregistrement : mise à jour ou création</span>
            <span class="n">gambleid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_gdSet</span><span class="o">.</span><span class="n">gambleid</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># nombre de sélection de cette cible pour ces coordonnées du robot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># dernier score obtenu :</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targetobj</span><span class="o">.</span><span class="n">score</span>
                <span class="c1"># lors du coup :</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;gambleid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gambleid</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">targetobj</span><span class="o">.</span><span class="n">score</span><span class="p">,</span>
                    <span class="s2">&quot;gambleid&quot;</span><span class="p">:</span> <span class="n">gambleid</span><span class="p">,</span>
                <span class="p">}</span></div>

<div class="viewcode-block" id="CaseRobot.get_prev_temptarget_datas"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_prev_temptarget_datas">[docs]</a>    <span class="k">def</span> <span class="nf">get_prev_temptarget_datas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">direct</span><span class="p">,</span> <span class="n">xrobot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yrobot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le nombre d&#39;occurences et le dernier score enregistré pour</span>
<span class="sd">        une cible de caractéristiques x, y, direct choisie aux coordonnées actuelles</span>
<span class="sd">        du robot (si xrobot et yrobot sont indéterminés).</span>
<span class="sd">        Par défaut retourne {&quot;count&quot;:0, &quot;score&quot;:None, &quot;gambleid&quot;:None}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;gambleid&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">xrobot</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">yrobot</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xrobot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">yrobot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="c1"># recherche de l&#39;enregistrement :</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">direct</span><span class="p">,</span> <span class="n">xrobot</span><span class="p">,</span> <span class="n">yrobot</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">rdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temptargetobjectdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rdata</span></div>

<div class="viewcode-block" id="CaseRobot.register_current_gdSet"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_current_gdSet">[docs]</a>    <span class="k">def</span> <span class="nf">register_current_gdSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdSet</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre le gdSet courant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_gdSet</span> <span class="o">=</span> <span class="n">gdSet</span></div>

<div class="viewcode-block" id="CaseRobot.get_current_gdSet"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_current_gdSet">[docs]</a>    <span class="k">def</span> <span class="nf">get_current_gdSet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le gdSet courant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_gdSet</span></div>

<div class="viewcode-block" id="CaseRobot.register_action"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_action">[docs]</a>    <span class="k">def</span> <span class="nf">register_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">gambleid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre la dernière action effectuée</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passedaction</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">gambleid</span><span class="p">))</span></div>

<div class="viewcode-block" id="CaseRobot.get_action_list"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_action_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_action_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste des actions passées</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">passedaction</span><span class="p">:</span>
            <span class="n">rlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">rlist</span></div>

<div class="viewcode-block" id="CaseRobot.get_last_action"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_last_action">[docs]</a>    <span class="k">def</span> <span class="nf">get_last_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la dernière action ou None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lastaction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passedaction</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lastaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">passedaction</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">lastaction</span></div>

<div class="viewcode-block" id="CaseRobot.get_work_ratio"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_work_ratio">[docs]</a>    <span class="k">def</span> <span class="nf">get_work_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le ratio travail/mouvement sous forme de fraction</span>
<span class="sd">        Application sapper et builder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_SAPPER</span><span class="p">:</span>
            <span class="c1"># Sapper : on module en fonction de l&#39;efficacité</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">&lt;</span> <span class="mf">0.4</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="k">elif</span> <span class="mf">0.4</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">efficacite</span> <span class="o">&gt;=</span> <span class="mf">0.6</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_BUILDER</span><span class="p">:</span>
            <span class="c1"># ratio maximal systématique (r&gt;1)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="CaseRobot.register_bonus"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_bonus">[docs]</a>    <span class="k">def</span> <span class="nf">register_bonus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre un bonus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseRobot.register_death"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_death">[docs]</a>    <span class="k">def</span> <span class="nf">register_death</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre son décès</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;alive&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseRobot.register_case"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.register_case">[docs]</a>    <span class="k">def</span> <span class="nf">register_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">gambleid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre la dernière case atteinte</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># enregistrement</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gambleid</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_gamble_coords_to_current_entry</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coords</span><span class="p">,</span> <span class="n">gambleid</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_properties_changes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="c1"># effacement progressif du parcours :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">MAX_PASSED_CASES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span><span class="p">[</span><span class="o">-</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">MAX_PASSED_CASES</span> <span class="p">:]</span></div>

<div class="viewcode-block" id="CaseRobot.create_gamble_coords_entry"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.create_gamble_coords_entry">[docs]</a>    <span class="k">def</span> <span class="nf">create_gamble_coords_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée une entrée dans pour la série de coups à venir</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">entrydict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entrydict</span><span class="p">)</span>
        <span class="c1"># effacement progressif des séquences :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">MAX_SEQ_COUNT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">[</span>
                <span class="o">-</span><span class="n">CaseRobot</span><span class="o">.</span><span class="n">MAX_SEQ_COUNT</span> <span class="p">:</span>
            <span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">_add_gamble_coords_to_current_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute des coorddonnées à la liste crée dans create_gamble_coords_entry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lastentry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lastentry</span><span class="p">[</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<div class="viewcode-block" id="CaseRobot.compute_loop_factor"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.compute_loop_factor">[docs]</a>    <span class="k">def</span> <span class="nf">compute_loop_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listcoords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne un entier caractérisant le risque de bouclage associé </span>
<span class="sd">        à la liste de coordonnées.</span>
<span class="sd">        listcoords : liste de tuples (x, y)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">loopfactor</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nbentry</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">)</span>
        <span class="n">nbc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listcoords</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nbc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nbentry</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># position d&#39;arrivée :</span>
            <span class="n">endpos</span> <span class="o">=</span> <span class="n">listcoords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># nombre de séquences précédentes considérées :</span>
            <span class="n">prevseq</span> <span class="o">=</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">MAX_SEQ_COUNT</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prevseq</span><span class="p">,</span> <span class="n">nbentry</span><span class="p">)</span>
            <span class="c1"># données de ref :</span>
            <span class="n">refstarts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbentry</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">nb</span><span class="p">,</span> <span class="n">nbentry</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">refstarts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
            <span class="n">prevseqcoords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nbentry</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">prevseqcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gamble_coords_list</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;coords&quot;</span><span class="p">]</span>
            <span class="c1"># dénombrement :</span>
            <span class="n">startcount</span> <span class="o">=</span> <span class="n">refstarts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">endpos</span><span class="p">)</span>
            <span class="n">prevcount</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prevseqcoords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">listcoords</span><span class="p">:</span>
                    <span class="n">prevcount</span> <span class="o">+=</span> <span class="n">prevseqcoords</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">loopfactor</span> <span class="o">=</span> <span class="n">startcount</span> <span class="o">+</span> <span class="n">prevcount</span>
        <span class="k">return</span> <span class="n">loopfactor</span></div>

<div class="viewcode-block" id="CaseRobot.get_prev_coords"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.get_prev_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_prev_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># bug !!</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les coordonnées de l&#39;avant dernière case par laquelle le robot est passé</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prevcoords</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">prevcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">passedcase</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">prevcoords</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; CaseRobot uid=</span><span class="si">{}</span><span class="s2"> behavior=</span><span class="si">{}</span><span class="s2"> x=</span><span class="si">{}</span><span class="s2"> y=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; CaseRobot uid=</span><span class="si">{}</span><span class="s2"> x=</span><span class="si">{}</span><span class="s2"> y=</span><span class="si">{}</span><span class="s2"> human=</span><span class="si">{}</span><span class="s2"> behavior=</span><span class="si">{}</span><span class="s2"> face=</span><span class="si">{}</span><span class="s2"> vis=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">human</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="CaseDanger"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger">[docs]</a><span class="k">class</span> <span class="nc">CaseDanger</span><span class="p">(</span><span class="n">Case</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une case danger</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># types de dangers :</span>
    <span class="n">DANGER_MINE</span> <span class="o">=</span> <span class="s2">&quot;DANGER_MINE&quot;</span>  <span class="c1">#: identifie une case danger (mine)</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="CaseDanger.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dangerdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_default_dict</span><span class="p">()</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_DANGER</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CHAR_REPR_DANGER</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_impact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">dangerdict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>
    <span class="c1"># méthodes d&#39;instance</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dangerdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case bonus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Case</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">],</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">],</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">danger_type</span> <span class="o">=</span> <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_type&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseInt</span><span class="p">(</span><span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_impact&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CHAR_REPR_DANGER</span>

<div class="viewcode-block" id="CaseDanger.get_properties_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.get_properties_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne ses paramètres sous forme de dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dangerdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CHAR_REPR_DANGER</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_type</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_impact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span>
        <span class="k">return</span> <span class="n">dangerdict</span></div>

<div class="viewcode-block" id="CaseDanger.get_danger_radius"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.get_danger_radius">[docs]</a>    <span class="k">def</span> <span class="nf">get_danger_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le rayon d&#39;action offensif du danger</span>
<span class="sd">        Estimation large pour 5, 13 et 17, exacte pour 1, 9 et 25</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="n">radius</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="s2">&quot; danger_type=</span><span class="si">{}</span><span class="s2"> danger_impact=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">danger_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">danger_impact</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="CaseGrenade"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade">[docs]</a><span class="k">class</span> <span class="nc">CaseGrenade</span><span class="p">(</span><span class="n">CaseDanger</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une case grenade</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DANGER_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;DANGER_GRENADE&quot;</span>  <span class="c1">#: identifie une case grenade</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="CaseGrenade.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dangerdict</span> <span class="o">=</span> <span class="n">CaseDanger</span><span class="o">.</span><span class="n">get_default_dict</span><span class="p">()</span>
        <span class="c1"># subclassement :</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_GRENADE</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CHAR_REPR_GRENADE</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;danger_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CaseGrenade</span><span class="o">.</span><span class="n">DANGER_GRENADE</span>
        <span class="c1"># spécifique</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;x_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;y_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">dangerdict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>
    <span class="c1"># méthodes d&#39;instance</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dangerdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case bonus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CaseDanger</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dangerdict</span><span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_start</span> <span class="o">=</span> <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;x_start&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_start</span> <span class="o">=</span> <span class="n">dangerdict</span><span class="p">[</span><span class="s2">&quot;y_start&quot;</span><span class="p">]</span></div>


<div class="viewcode-block" id="CaseAnimation"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation">[docs]</a><span class="k">class</span> <span class="nc">CaseAnimation</span><span class="p">(</span><span class="n">Case</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Case temporaire dédiée aux animations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># types d&#39;animations :</span>
    <span class="c1"># déplacement</span>
    <span class="n">ANIM_MOVE</span> <span class="o">=</span> <span class="s2">&quot;ANIM_MOVE&quot;</span>  <span class="c1">#: animation de mouvement</span>
    <span class="c1"># changement d&#39;apparence</span>
    <span class="n">ANIM_FACE</span> <span class="o">=</span> <span class="s2">&quot;ANIM_FACE&quot;</span>  <span class="c1">#: changement d&#39;apparence</span>
    <span class="c1"># Incrémente la génération d&#39;id :</span>
    <span class="n">_NEXT_UID</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="CaseAnimation.create_uid"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.create_uid">[docs]</a>    <span class="k">def</span> <span class="nf">create_uid</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Génère un id unique pour une case animation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_NEXT_UID</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_NEXT_UID</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">uid</span></div>

    <span class="n">create_uid</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">create_uid</span><span class="p">)</span>

<div class="viewcode-block" id="CaseAnimation.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">animdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_default_dict</span><span class="p">()</span>
        <span class="c1"># spécifique</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;anim_uid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_uid</span><span class="p">()</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_ANIMATION</span>
        <span class="c1"># type d&#39;animation</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;type_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;scenario_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># impact associé à une explosion</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;impact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># nombre de pas d&#39;animation</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;step_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># pas de départ dans l&#39;animation globale</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;start_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># pas d&#39;animation local :</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;local_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># liste des apparences successives (ANIM_FACE)</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;face_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># coordonnées initiales (ANIM_MOVE)</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># axe de déplacement</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;axe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># coordonnées finales (ANIM_MOVE)</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">animdict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>
    <span class="c1"># méthodes d&#39;instance</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">animdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case Animation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Case</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">],</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">],</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anim_uid</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;anim_uid&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;type_anim&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scenario_anim</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;scenario_anim&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;step_count&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_step</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;start_step&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;local_step&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_MOVE</span><span class="p">:</span>
            <span class="c1"># déplacement :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_start</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_start&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_start</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_start&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_end</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_end&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_end</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_end&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axe</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;axe&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">impact</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_FACE</span><span class="p">:</span>
            <span class="c1"># changement d&#39;apparence :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">face_list</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;face_list&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">impact</span> <span class="o">=</span> <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;impact&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="CaseAnimation.get_properties_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.get_properties_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne ses paramètres sous forme de dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">animdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;anim_uid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anim_uid</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;type_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;scenario_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_anim</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;step_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;start_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_step</span>
        <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;local_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_MOVE</span><span class="p">:</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_start</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_start</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;x_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_end</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;y_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_end</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;axe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axe</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_FACE</span><span class="p">:</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;face_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_list</span>
            <span class="n">animdict</span><span class="p">[</span><span class="s2">&quot;impact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impact</span>
        <span class="k">return</span> <span class="n">animdict</span></div>

<div class="viewcode-block" id="CaseAnimation.apply_animation_step"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.apply_animation_step">[docs]</a>    <span class="k">def</span> <span class="nf">apply_animation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique la transformation associée au pas d&#39;animation global step (0 à n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_step</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_step</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_MOVE</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axe</span> <span class="o">==</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">AXIS_X</span><span class="p">:</span>
                        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_start</span>
                        <span class="n">xe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_end</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">+</span> <span class="p">(</span><span class="n">xe</span> <span class="o">-</span> <span class="n">xs</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_start</span>
                        <span class="n">ye</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_end</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ys</span> <span class="o">+</span> <span class="p">(</span><span class="n">ye</span> <span class="o">-</span> <span class="n">ys</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_anim</span> <span class="o">==</span> <span class="n">CaseAnimation</span><span class="o">.</span><span class="n">ANIM_FACE</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_step</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_count</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">local_step</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;CaseAnimation anim_uid=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anim_uid</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="s2">&quot; anim_uid=</span><span class="si">{}</span><span class="s2"> start_step=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anim_uid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_step</span><span class="p">)</span></div>


<div class="viewcode-block" id="CaseBonus"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus">[docs]</a><span class="k">class</span> <span class="nc">CaseBonus</span><span class="p">(</span><span class="n">Case</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modélise une case bonus</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># types de bonus :</span>
    <span class="n">BONUS_AUGMENTE_VITESSE</span> <span class="o">=</span> <span class="s2">&quot;BONUS_AUGMENTE_VITESSE&quot;</span>  <span class="c1">#: bonus augmenter la vitesse</span>
    <span class="n">BONUS_MINE</span> <span class="o">=</span> <span class="s2">&quot;BONUS_MINE&quot;</span>  <span class="c1">#: bonus poser des mines</span>
    <span class="n">BONUS_PUISSANCE_MINE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;BONUS_PUISSANCE_MINE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: bonus augmenter la puissance des mines</span>
    <span class="n">BONUS_GRENADE</span> <span class="o">=</span> <span class="s2">&quot;BONUS_GRENADE&quot;</span>  <span class="c1">#: bonus lancer des grenades</span>
    <span class="n">BONUS_PUISSANCE_GRENADE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;BONUS_PUISSANCE_GRENADE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: bonus augmenter la puissance des grenades</span>
    <span class="n">BONUS_PORTEE_GRENADE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;BONUS_PORTEE_GRENADE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: bonus augmenter la portée des grenades</span>
    <span class="c1"># méthodes statiques</span>
<div class="viewcode-block" id="CaseBonus.get_default_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.get_default_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode statique retournant le dict par défaut attendu par le constructeur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bonusdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_default_dict</span><span class="p">()</span>
        <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CASE_BONUS</span>
        <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabHelper</span><span class="o">.</span><span class="n">CHAR_REPR_BONUS</span>
        <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;bonus_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">bonusdict</span></div>

    <span class="n">get_default_dict</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">get_default_dict</span><span class="p">)</span>
    <span class="c1"># méthodes d&#39;instance</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bonusdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur de la case bonus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Case</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
            <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;type_case&quot;</span><span class="p">],</span>
            <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;face&quot;</span><span class="p">],</span>
            <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">=</span> <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;bonus_type&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="CaseBonus.get_properties_dict"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.get_properties_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne ses paramètres sous forme de dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bonusdict</span> <span class="o">=</span> <span class="n">Case</span><span class="o">.</span><span class="n">get_properties_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">bonusdict</span><span class="p">[</span><span class="s2">&quot;bonus_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span>
        <span class="k">return</span> <span class="n">bonusdict</span></div>

<div class="viewcode-block" id="CaseBonus.adapt_bonus_to_robot"><a class="viewcode-back" href="../../../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html#labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.adapt_bonus_to_robot">[docs]</a>    <span class="k">def</span> <span class="nf">adapt_bonus_to_robot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">gameconf</span><span class="p">,</span> <span class="n">handlebehavior</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Se configure en fonction des capacités du robot</span>
<span class="sd">        gameconf : ref à GameConfiguration s&#39;il est configuré, None sinon</span>
<span class="sd">        Rq : un problème d&#39;import circulaire empèche d&#39;importer explicitement</span>
<span class="sd">        GameConfiguration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bonus_finded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># limites de configuration :</span>
        <span class="n">bonus_policy</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">gameconf</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gameconf</span><span class="o">.</span><span class="n">get_bonus_policy</span><span class="p">(</span><span class="s2">&quot;vitesse&quot;</span><span class="p">)</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gameconf</span><span class="o">.</span><span class="n">get_bonus_policy</span><span class="p">(</span><span class="s2">&quot;mine&quot;</span><span class="p">)</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gameconf</span><span class="o">.</span><span class="n">get_bonus_policy</span><span class="p">(</span><span class="s2">&quot;grenade&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># limites max</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;increment&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span>
                <span class="s2">&quot;increment&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span>
                <span class="s2">&quot;increment&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;max_puissance&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="c1"># capacites du robot :</span>
        <span class="n">capacites</span> <span class="o">=</span> <span class="p">[(</span><span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_AUGMENTE_VITESSE</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]:</span>
            <span class="n">capacites</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">robot</span><span class="o">.</span><span class="n">has_mine</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_MINE</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]:</span>
            <span class="n">capacites</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">robot</span><span class="o">.</span><span class="n">has_grenade</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_GRENADE</span><span class="p">))</span>
        <span class="c1"># augmentation des capacités</span>
        <span class="n">plus_mine</span> <span class="o">=</span> <span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">puissance_mine</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PUISSANCE_MINE</span><span class="p">)</span>
        <span class="n">plus_puissance_grenade</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span><span class="p">,</span>
            <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PUISSANCE_GRENADE</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plus_portee_grenade</span> <span class="o">=</span> <span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PORTEE_GRENADE</span><span class="p">)</span>
        <span class="n">plus_vitesse</span> <span class="o">=</span> <span class="p">(</span><span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span><span class="p">,</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_AUGMENTE_VITESSE</span><span class="p">)</span>
        <span class="c1"># ...par défaut :</span>
        <span class="n">puissances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">plus_mine</span><span class="p">,</span>
            <span class="n">plus_puissance_grenade</span><span class="p">,</span>
            <span class="n">plus_portee_grenade</span><span class="p">,</span>
            <span class="n">plus_vitesse</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="c1"># prise en compte du comportement du robot</span>
        <span class="k">if</span> <span class="n">handlebehavior</span><span class="p">:</span>
            <span class="c1"># on oriente le bonus en fonction du comportement</span>
            <span class="n">behavior</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">behavior</span>
            <span class="k">if</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUMAN</span><span class="p">,</span>
                <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_HUNTER</span><span class="p">,</span>
                <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_WINNER</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="c1"># on privilégie vitesse et grenade</span>
                <span class="n">vg</span> <span class="o">=</span> <span class="p">[</span><span class="n">plus_puissance_grenade</span><span class="p">,</span> <span class="n">plus_portee_grenade</span><span class="p">,</span> <span class="n">plus_vitesse</span><span class="p">]</span>
                <span class="n">puissances</span> <span class="o">=</span> <span class="n">vg</span> <span class="o">*</span> <span class="mi">4</span>
                <span class="n">puissances</span> <span class="o">+=</span> <span class="p">[</span><span class="n">plus_mine</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_SAPPER</span><span class="p">:</span>
                <span class="c1"># on renforce les mines</span>
                <span class="n">puissances</span> <span class="o">=</span> <span class="p">[</span><span class="n">plus_mine</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
                <span class="n">puissances</span> <span class="o">+=</span> <span class="p">[</span>
                    <span class="n">plus_puissance_grenade</span><span class="p">,</span>
                    <span class="n">plus_portee_grenade</span><span class="p">,</span>
                    <span class="n">plus_vitesse</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="k">elif</span> <span class="n">behavior</span> <span class="o">==</span> <span class="n">CaseRobot</span><span class="o">.</span><span class="n">BEHAVIOR_TOURIST</span><span class="p">:</span>
                <span class="c1"># on renforce la vitesse</span>
                <span class="n">puissances</span> <span class="o">=</span> <span class="p">[</span><span class="n">plus_vitesse</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
                <span class="n">puissances</span> <span class="o">+=</span> <span class="p">[</span><span class="n">plus_puissance_grenade</span><span class="p">,</span> <span class="n">plus_portee_grenade</span><span class="p">,</span> <span class="n">plus_mine</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># random et builder: on laisse en standard</span>
                <span class="k">pass</span>
        <span class="c1"># on donne de nouveaux pouvoirs</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">capacites</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cap</span> <span class="ow">in</span> <span class="n">capacites</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">cap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">=</span> <span class="n">cap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">bonus_finded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="c1"># ou on en augmente la puissance</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bonus_finded</span><span class="p">:</span>
            <span class="n">cr</span><span class="o">.</span><span class="n">CustomRandom</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">puissances</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">=</span> <span class="n">puissances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">bonus_finded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># application</span>
        <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">prop_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">prop_values</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">bonus_finded</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_AUGMENTE_VITESSE</span><span class="p">:</span>
                <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span>
                <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]]</span>
                <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_MINE</span>
            <span class="p">):</span>
                <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;has_mine&quot;</span><span class="p">,</span> <span class="s2">&quot;puissance_mine&quot;</span><span class="p">]</span>
                <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_GRENADE</span>
            <span class="p">):</span>
                <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;has_grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;puissance_grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;portee_grenade&quot;</span><span class="p">]</span>
                <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PUISSANCE_MINE</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">robot</span><span class="o">.</span><span class="n">puissance_mine</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]</span>
                    <span class="o">&lt;=</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;puissance_mine&quot;</span><span class="p">]</span>
                    <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">robot</span><span class="o">.</span><span class="n">puissance_mine</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;mine&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]</span>
                    <span class="p">]</span>
                    <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PUISSANCE_GRENADE</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]</span>
                    <span class="o">&lt;=</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;max_puissance&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]</span>
                    <span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span><span class="p">:</span>
                        <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;puissance_grenade&quot;</span><span class="p">]</span>
                        <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">robot</span><span class="o">.</span><span class="n">puissance_grenade</span>
                            <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]</span>
                        <span class="p">]</span>
                        <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">]</span>
                        <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;grenade&quot;</span><span class="p">][</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span> <span class="o">==</span> <span class="n">CaseBonus</span><span class="o">.</span><span class="n">BONUS_PORTEE_GRENADE</span>
            <span class="p">):</span>
                <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;portee_grenade&quot;</span><span class="p">]</span>
                <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">robot</span><span class="o">.</span><span class="n">portee_grenade</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Dernière chance :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bonus_applied</span><span class="p">:</span>
            <span class="n">prop_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">]</span>
            <span class="n">prop_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">robot</span><span class="o">.</span><span class="n">vitesse</span> <span class="o">+</span> <span class="n">bonus_policy</span><span class="p">[</span><span class="s2">&quot;vitesse&quot;</span><span class="p">][</span><span class="s2">&quot;increment&quot;</span><span class="p">]]</span>
            <span class="n">bonus_applied</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Application:</span>
        <span class="k">if</span> <span class="n">bonus_applied</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prop_names</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">prop_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">prop_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">robot</span><span class="o">.</span><span class="n">register_bonus</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">robot</span><span class="o">.</span><span class="n">register_bonus</span><span class="p">(</span><span class="s2">&quot;earned_bonus&quot;</span><span class="p">,</span> <span class="n">robot</span><span class="o">.</span><span class="n">earned_bonus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="s2">&quot; bonus_type=</span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonus_type</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Gabriel Leroy - novembre 2020 - Licence Art Libre (https://artlibre.org/)

    </p>
  </div>
    
    
    
    Compilé avec <a href="http://sphinx-doc.org/">Sphinx</a> en utilisant un
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">thème</a>
    
    fourni par <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>