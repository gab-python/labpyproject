

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>labpyproject.core.pygame.core &mdash; Documentation labpyproject </title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> labpyproject
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../labpyproject.html">labpyproject</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../labpyproject.apps.html">labpyproject.apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.html">labpyproject.apps.labpyrinthe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.html">labpyproject.apps.labpyrinthe.app</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.app_types.html">app_types</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.app_types.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.app.app_types.AppTypes.html">AppTypes</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.app_types.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.application.html">application</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.application.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.app.application.AppManager.html">AppManager</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.app.application.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.html">labpyproject.apps.labpyrinthe.bus</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.html">labpyproject.apps.labpyrinthe.bus.commands</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html">cmd_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.CommandHelper.html">CommandHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html">cmd_manager</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.CommandManager.html">CommandManager</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.cmd_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html">gamble_datas</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleDataSet.html">GambleDataSet</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleDataObject.html">GambleDataObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.PseudoActions.html">PseudoActions</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.GambleSearch.html">GambleSearch</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.gamble_datas.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html">targets</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetObject.html">TargetObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetPath.html">TargetPath</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.commands.targets.TargetPathStep.html">TargetPathStep</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.commands.targets.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.html">labpyproject.apps.labpyrinthe.bus.helpers</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html">exchange_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.ExchangeHelper.html">ExchangeHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.exchange_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html">game_configuration</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.GameConfiguration.html">GameConfiguration</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.game_configuration.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html">lab_generator</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.LabGenerator.html">LabGenerator</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_generator.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html">lab_manager</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.LabManager.html">LabManager</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html">lab_parser</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.LabParser.html">LabParser</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.helpers.lab_parser.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.html">labpyproject.apps.labpyrinthe.bus.model</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html">core_matrix</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabHelper.html">LabHelper</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.LabLevel.html">LabLevel</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Matrice.html">Matrice</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.AnimatedLayer.html">AnimatedLayer</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.Case.html">Case</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseRobot.html">CaseRobot</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseDanger.html">CaseDanger</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseGrenade.html">CaseGrenade</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseAnimation.html">CaseAnimation</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.core_matrix.CaseBonus.html">CaseBonus</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.core_matrix.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.player.html">player</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.player.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.model.player.LabPlayer.html">LabPlayer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.model.player.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html">game_manager</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.bus.game_manager.GameManager.html">GameManager</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.bus.game_manager.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.html">labpyproject.apps.labpyrinthe.gui</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.html">labpyproject.apps.labpyrinthe.gui.skinBase</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html">GUIBase</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBase.html">GUIBase</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBaseNoThread.html">GUIBaseNoThread</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.GUIBaseThreaded.html">GUIBaseThreaded</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.GUIBase.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html">colors</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.colors.ColorHelper.html">ColorHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.colors.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html">interfaces</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneCarte.html">AbstractZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneCommand.html">AbstractZoneCommand</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZonePartie.html">AbstractZonePartie</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneBots.html">AbstractZoneBots</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractZoneMenu.html">AbstractZoneMenu</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractScreenContent.html">AbstractScreenContent</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractScreenWait.html">AbstractScreenWait</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractSwitch.html">AbstractSwitch</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.AbstractInput.html">AbstractInput</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.interfaces.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html">screen_wait_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.ScreenWaitBase.html">ScreenWaitBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.screen_wait_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html">skin_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.SkinBase.html">SkinBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.skin_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html">zone_bots_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.ZoneBotsBase.html">ZoneBotsBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_bots_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html">zone_carte_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.ZoneCarteBase.html">ZoneCarteBase</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.ItemObjectBase.html">ItemObjectBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_carte_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html">zone_command_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.ZoneCommandBase.html">ZoneCommandBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_command_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html">zone_menu_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.ZoneMenuBase.html">ZoneMenuBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_menu_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html">zone_partie_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.ZonePartieBase.html">ZonePartieBase</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinBase.zone_partie_base.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.html">labpyproject.apps.labpyrinthe.gui.skinConsole</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html">pub_helper</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.PublicationHelper.html">PublicationHelper</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinConsole.pub_helper.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.html">labpyproject.apps.labpyrinthe.gui.skinPygame</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html">botview</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.botview.BotView.html">BotView</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.botview.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html">footer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.footer.Footer.html">Footer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.footer.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html">header</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.header.Header.html">Header</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.header.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html">screen_wait</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.ScreenWait.html">ScreenWait</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.ScaledText.html">ScaledText</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.SimplePreloader.html">SimplePreloader</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.screen_wait.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html">skinPygame</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.SkinPygame.html">SkinPygame</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.skinPygame.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html">uitools</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WImage.html">WImage</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WText.html">WText</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WEntry.html">WEntry</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.WButton.html">WButton</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.Spacer.html">Spacer</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.uitools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html">zone_bots</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.ZoneBots.html">ZoneBots</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.BotList.html">BotList</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.BotItem.html">BotItem</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_bots.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html">zone_carte</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ZoneCarte.html">ZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ItemObject.html">ItemObject</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.CaseView.html">CaseView</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.BotViewCarte.html">BotViewCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.ZoneDangerRobot.html">ZoneDangerRobot</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_carte.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html">zone_command</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.ZoneCommand.html">ZoneCommand</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_command.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html">zone_menu</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.ZoneMenu.html">ZoneMenu</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.MenuButton.html">MenuButton</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_menu.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html">zone_partie</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.ZonePartie.html">ZonePartie</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinPygame.zone_partie.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.html">labpyproject.apps.labpyrinthe.gui.skinTkinter</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html">header</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.header.Header.html">Header</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.header.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html">screen_wait</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.ScreenWait.html">ScreenWait</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.screen_wait.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html">skinTkinter</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.SkinTkinter.html">SkinTkinter</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.skinTkinter.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html">uitools</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CustomEntry.html">CustomEntry</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSwitch.html">CanvasSwitch</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasImage.html">CanvasImage</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSpacer.html">CanvasSpacer</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.CanvasSeparateur.html">CanvasSeparateur</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.uitools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html">zone_bots</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.ZoneBots.html">ZoneBots</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_bots.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html">zone_carte</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.ZoneCarte.html">ZoneCarte</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.ItemObject.html">ItemObject</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_carte.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html">zone_command</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.ZoneCommand.html">ZoneCommand</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_command.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html">zone_menu</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.ZoneMenu.html">ZoneMenu</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_menu.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html">zone_partie</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html#classes">Classes</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.ZonePartie.html">ZonePartie</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.skinTkinter.zone_partie.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html">GUIConsole</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.GUIConsole.GUIConsole.html">GUIConsole</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.GUIConsole.ThreadInput.html">ThreadInput</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIConsole.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html">GUIPygame</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.GUIPygame.GUIPygame.html">GUIPygame</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUIPygame.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html">GUITk</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html#classes">Classes</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../api/labpyproject.apps.labpyrinthe.gui.GUITk.GUITk.html">GUITk</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.gui.GUITk.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.clientConsole.html">clientConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.clientPygame.html">clientPygame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.serverConsole.html">serverConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.standaloneConsole.html">standaloneConsole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.standalonePygame.html">standalonePygame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.apps.labpyrinthe.standaloneTkinter.html">standaloneTkinter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../labpyproject.core.html">labpyproject.core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.app.html">labpyproject.core.app</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.app.app_components.html">app_components</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.app.app_components.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.ThreadableComp.html">ThreadableComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.APPComp.html">APPComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.SatelliteExchangeObject.html">SatelliteExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.AbstractSatelliteComp.html">AbstractSatelliteComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.DelayedAction.html">DelayedAction</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.SatelliteComp.html">SatelliteComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.SatelliteCompNoThread.html">SatelliteCompNoThread</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.GUIExchangeObject.html">GUIExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.AbstractGUIComp.html">AbstractGUIComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.GUIComp.html">GUIComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.GUICompNoThread.html">GUICompNoThread</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.NETExchangeObject.html">NETExchangeObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.NETComp.html">NETComp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.app.app_components.BUSINESSComp.html">BUSINESSComp</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.app.app_components.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.io.html">labpyproject.core.io</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.io.custom_IO.html">custom_IO</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.io.custom_IO.html#functions">Functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.io.custom_IO.get_file_list.html">get_file_list</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.io.custom_IO.load_obj_from_file.html">load_obj_from_file</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.io.custom_IO.load_text_file.html">load_text_file</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.io.custom_IO.save_obj_in_file.html">save_obj_in_file</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.net.html">labpyproject.core.net</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.net.custom_TCP.html">custom_TCP</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.net.custom_TCP.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.CustomTCPServerContainer.html">CustomTCPServerContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.ThreadedTCPServer.html">ThreadedTCPServer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.CustomTCPRequestHandler.html">CustomTCPRequestHandler</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.ParseDataError.html">ParseDataError</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.CustomRequestHelper.html">CustomRequestHelper</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.net.custom_TCP.CustomTCPThreadedClient.html">CustomTCPThreadedClient</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.net.custom_TCP.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.patterns.html">labpyproject.core.patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.patterns.design_patterns.html">design_patterns</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.patterns.design_patterns.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.patterns.design_patterns.Singleton.html">Singleton</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.patterns.design_patterns.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.pygame.html">labpyproject.core.pygame</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.pygame.core.html">core</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.core.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html">BoxModelObject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html">MetricValue</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html">BoundedMetricValue</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html">VirtualItem</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html">VirtualContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html">CustomSprite</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html">RealContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html">RootContainer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html">LayerManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html">LayerStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html">LocalLayer</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.core.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.pygame.events.html">events</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.events.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.events.CustomEventManager.html">CustomEventManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.events.GUIEventManager.html">GUIEventManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.events.CustomBaseControl.html">CustomBaseControl</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.events.CustomBaseInput.html">CustomBaseInput</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.events.CustomBaseButton.html">CustomBaseButton</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.events.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.pygame.widgets.html">widgets</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.widgets.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Background.html">Background</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Image.html">Image</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Text.html">Text</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Entry.html">Entry</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.TextButton.html">TextButton</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Button.html">Button</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Stack.html">Stack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.HStack.html">HStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.VStack.html">VStack</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Canvas.html">Canvas</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.HBox.html">HBox</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.VBox.html">VBox</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.pygame.widgets.Root.html">Root</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.pygame.widgets.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.queue.html">labpyproject.core.queue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.queue.queue_tools.html">queue_tools</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.queue.queue_tools.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.queue.queue_tools.QueueManager.html">QueueManager</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.queue.queue_tools.QueueSimpleClient.html">QueueSimpleClient</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.queue.queue_tools.QueueSwitcher.html">QueueSwitcher</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.queue.queue_tools.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../labpyproject.core.random.html">labpyproject.core.random</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../labpyproject.core.random.custom_random.html">custom_random</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.random.custom_random.html#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../api/labpyproject.core.random.custom_random.CustomRandom.html">CustomRandom</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../labpyproject.core.random.custom_random.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">labpyproject</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Code du module</a> &raquo;</li>
        
      <li>labpyproject.core.pygame.core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Code source de labpyproject.core.pygame.core</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">**Composants génériques pour pygame** supportant :</span>

<span class="sd">- boxmodel, </span>
<span class="sd">- gestion récursive de la profondeur, </span>
<span class="sd">- logique de publication.</span>

<span class="sd">Prototype fonctionnel.</span>


<span class="sd">**Classes de base non instanciées directement :**</span>

<span class="sd">- **BoxModelObject** : </span>

<span class="sd">  - Superclasse de tous les objets positionnables dans le plan.</span>
<span class="sd">  - Porte tous les paramètres de position et de dimensions communs aux items terminaux et </span>
<span class="sd">    aux conteneurs.</span>
<span class="sd">  - Dispose des méthodes de base de gestion du resize et du display.</span>

<span class="sd">- **MetricValue** :</span>

<span class="sd">  - Objet utilisé pour manipuler les attributs pouvant être exprimés en pixel ou en %.</span>

<span class="sd">- **BoundedMetricValue** :</span>

<span class="sd">  - Subclasse de MetricValue supportant des bornes min et max. Utilisé pour les dimensions.</span>

<span class="sd">- **VirtualItem** (BoxModelObject) :</span>

<span class="sd">  - Superclasse de tous les objets positionnables en &quot;2.5 D&quot; (plan + profondeur)</span>
<span class="sd">  - Apporte les attributs et méthodes de base pour la gestion des z-indexs (profondeur) </span>
<span class="sd">  - Ainsi que la mécanique de publication (ajout/retrait d&#39;un conteneur parent).</span>

<span class="sd">**Classes instanciables dans une application pygame :**</span>

<span class="sd">- **VirtualContainer** (VirtualItem)</span>

<span class="sd">  - Conteneur de VirtualItems étendant les méthodes de sa superclasse aux problématiques des </span>
<span class="sd">    conteneurs, notamment support de trois layouts basiques : absolu, layout horizontal, </span>
<span class="sd">    layout vertical.</span>
<span class="sd">  - Peut être utilisé dans une application réelle en tant que conteneur léger (ie ne prenant </span>
<span class="sd">    pas en charge le display final de ses éléments sur une surface de publication).</span>
<span class="sd">  - Limite : peu adapté à des logiques d&#39;animation puisque n&#39;ayant pas de &quot;surface propre&quot;. </span>
<span class="sd">    L&#39;animation devrait être propagée à chacun de ses enfants. Faisable directement pour </span>
<span class="sd">    des déplacements (voir méthodes move et place), plus complexe (et risqué) pour des </span>
<span class="sd">    animations de type alpha, color ou scale.</span>

<span class="sd">- **CustomSprite** (VirtualItem, pygame.sprite.DirtySprite)</span>

<span class="sd">  - Classe de base de tous les composants terminaux d&#39;une application pygame (image, texte).</span>
<span class="sd">  - Hérite des propriétés et méthodes de VirtualItem (boxmodel, z-index, publication) </span>
<span class="sd">  - et de DirtySprite pour l&#39;optimisation du display.</span>

<span class="sd">- **RealContainer** (VirtualContainer, pygame.sprite.LayeredDirty)</span>

<span class="sd">  - Conteneur &quot;réel&quot; au sens ou celui-ci dispose d&#39;une surface de publication propre sur </span>
<span class="sd">    laquelle est &quot;applatie&quot; l&#39;ensemble de sa hiérarchie.</span>
<span class="sd">  - Utilise par composition un LayerManager pour la gestion dynamique et récursive des z-indexs.</span>
<span class="sd">  - Hérite de LayeredDirty pour le display optimisé de sa hiérarchie de sprites.</span>

<span class="sd">- **RootContainer** (RealContainer, evt.GUIEventManager)</span>

<span class="sd">  - Conteneur racine d&#39;une application pygame.</span>
<span class="sd">  - Diffère de RealContainer par la nature de sa surface de publication (pygame.display = </span>
<span class="sd">    la surface &quot;définitive&quot; de</span>
<span class="sd">    publication pygame).</span>
<span class="sd">  - Dispose des méthodes de démarrage/arrêt du thread d&#39;interface.</span>
<span class="sd">  - Initie le processus de resize en cas de fenêtre redimensionnable.</span>
<span class="sd">  - Dispatch les événements (top-&gt;bottom en V1) via les méthodes héritées de </span>
<span class="sd">    events.GUIEventManager.</span>

<span class="sd">**Utilitaires de gestion de la profondeur (z-indexs ou layers) :**</span>

<span class="sd">Tous les conteneurs possèdent une ou plusieurs couche(s) locale(s), le système garantit </span>
<span class="sd">la cohérence de la projection de ces couches imbriquées sur la liste de couches globales du </span>
<span class="sd">LayeredDirty parent (RealContainer ou RootContainer) assurant la publication de la hiérarchie </span>
<span class="sd">d&#39;objets.</span>

<span class="sd">- **LayerManager** : gestionnaire des zindexs, assure la cohérence dynamique des couches </span>
<span class="sd">  des VirtualContainers.</span>
<span class="sd">- **LayerStack** : modélisation des couches d&#39;un VirtualContainer</span>
<span class="sd">- **LocalLayer** : modélisation d&#39;une couche locale d&#39;un LayerStack</span>

<span class="sd">.. note::</span>
<span class="sd">    **Implémentation opérationnelle :** voir module :doc:`labpyproject.core.pygame.widgets`</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="kn">import</span> <span class="nn">pygame.locals</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span><span class="p">,</span> <span class="n">attrgetter</span>
<span class="kn">import</span> <span class="nn">labpyproject.core.pygame.events</span> <span class="k">as</span> <span class="nn">evt</span>

<span class="c1"># Evite l&#39;ajout non désiré de certains imports à la doc sphinx</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;BoxModelObject&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MetricValue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BoundedMetricValue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;VirtualItem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;VirtualContainer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CustomSprite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RealContainer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RootContainer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LayerManager&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LayerStack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LocalLayer&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="c1"># classes</span>
<span class="c1">#-----&gt; Boxmodel : classes de base</span>
<div class="viewcode-block" id="BoxModelObject"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject">[docs]</a><span class="k">class</span> <span class="nc">BoxModelObject</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Super classe portant les propriétés et méthodes fondamentales du box model.**</span>
<span class="sd">    </span>
<span class="sd">    - &quot;position&quot; au sens css du terme soit &quot;fixed&quot;, &quot;absolute&quot;, &quot;static&quot;, &quot;relative&quot;</span>
<span class="sd">    - attributs locaux pouvant être exprimés en pixel ou pourcentage :</span>
<span class="sd">      &quot;x&quot;, &quot;y&quot;, &quot;top&quot;, &quot;left&quot;, &quot;bottom&quot;, &quot;right&quot;, &quot;width&quot;, &quot;height&quot;, &quot;padding&quot;, &quot;margin&quot;</span>
<span class="sd">    - bornage des dimensions : &quot;minwidth&quot;, &quot;maxwidth&quot;, &quot;minheight&quot;, &quot;maxheight&quot;</span>
<span class="sd">    - attributs d&#39;alignement : &quot;align&quot;, &quot;valign&quot;</span>
<span class="sd">    - attributs d&#39;adaptation au contenu : &quot;snapW&quot;, &quot;snapH&quot;</span>
<span class="sd">    - &quot;flex&quot; (int, default None) : valeur de flexibilité si le conteneur parent impose un</span>
<span class="sd">      layout (horizontal ou vertical à l&#39;heure actuelle)</span>

<span class="sd">.. admonition:: Remarques:</span>
<span class="sd">    </span>
<span class="sd">    - l&#39;origine du repère se situe dans le coin haut/gauche, l&#39;axe des absisses est</span>
<span class="sd">      orientée vers la droite, celui des ordonnées vers le bas</span>
<span class="sd">    - les metrics en % sont calculés par rapport à la surface alouée par le parent</span>
<span class="sd">    - à la différence de css, width et height représentent les dimensions totales de la</span>
<span class="sd">      box, padding et margin inclus. Les dimensions du contenu et du fond (ou de la bordure),</span>
<span class="sd">      pouvant être moindres.</span>
<span class="sd">    - padding et margin sont uniformes sur chacun des bords (V1 : allège les calculs)</span>
<span class="sd">    - position &quot;fixed&quot; est gérée partiellement par les RealContainers du fait du clipping</span>
<span class="sd">      de leur surface de publication.</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># propriétés statiques</span>
    <span class="c1"># 1- position</span>
    <span class="c1"># équivalent de la ppté css position fixed l&#39;élément est positionné relativement à la fenêtre.</span>
    <span class="n">POSITION_FIXED</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span>  <span class="c1">#: équivalent de la ppté css position fixed, l&#39;élément est positionné relativement à la fenêtre.</span>
    <span class="c1"># équivalent de la ppté css position absolute l&#39;élément est positionné relativement à son parent sans &quot;subir&quot; de layout (normal flow css) de sa part.</span>
    <span class="n">POSITION_ABSOLUTE</span> <span class="o">=</span> <span class="s2">&quot;absolute&quot;</span>  <span class="c1">#: équivalent de la ppté css position absolute, l&#39;élément est positionné relativement à son parent sans &quot;subir&quot; de layout (normal flow css) de sa part.</span>
    <span class="c1"># équivalent de la ppté css position static l&#39;élément est positionné selon le layout de son conteneur parent.</span>
    <span class="n">POSITION_STATIC</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>  <span class="c1">#: équivalent de la ppté css position static, l&#39;élément est positionné selon le layout de son conteneur parent.</span>
    <span class="c1"># équivalent de la ppté css position relative l&#39;élément est positionné selon le layout de son conteneur parent mais les offsets (left, right, top, bottom) sont ensuite appliqués. Valeur par défaut.</span>
    <span class="n">POSITION_RELATIVE</span> <span class="o">=</span> <span class="s2">&quot;relative&quot;</span>  <span class="c1">#: équivalent de la ppté css position relative, l&#39;élément est positionné selon le layout de son conteneur parent mais les offsets (left, right, top, bottom) sont ensuite appliqués (valeur par défaut).</span>
    <span class="n">POSITION_VALUES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">POSITION_FIXED</span><span class="p">,</span>
        <span class="n">POSITION_ABSOLUTE</span><span class="p">,</span>
        <span class="n">POSITION_STATIC</span><span class="p">,</span>
        <span class="n">POSITION_RELATIVE</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: liste des valeurs possibles pour l&#39;attribut position</span>
    <span class="c1"># 2- propriétés liées aux dimensions et coordonnées</span>
    <span class="n">METRIC_ATTR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;xabs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;yabs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">,</span>
        <span class="s2">&quot;height&quot;</span><span class="p">,</span>
        <span class="s2">&quot;padding&quot;</span><span class="p">,</span>
        <span class="s2">&quot;margin&quot;</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: références internes aux attributs de position et de dimension</span>
    <span class="n">ALIGN_ATTR</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;align&quot;</span><span class="p">,</span> <span class="s2">&quot;valign&quot;</span><span class="p">]</span>  <span class="c1">#: attributs d&#39;alignements</span>
    <span class="n">SNAP_ATTR</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;snapW&quot;</span><span class="p">,</span> <span class="s2">&quot;snapH&quot;</span><span class="p">]</span>  <span class="c1">#: attributs d&#39;adaptation au contenu</span>
    <span class="n">FLEX_ATTR</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;flex&quot;</span><span class="p">]</span>  <span class="c1">#: attribut de flex</span>
    <span class="c1"># types d&#39;alignements :</span>
    <span class="n">ALIGN_LEFT</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="n">ALIGN_CENTER</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="n">ALIGN_RIGHT</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="n">VALIGN_TOP</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="n">VALIGN_MIDDLE</span> <span class="o">=</span> <span class="s2">&quot;middle&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="n">VALIGN_BOTTOM</span> <span class="o">=</span> <span class="s2">&quot;bottom&quot;</span>  <span class="c1">#: valeur d&#39;alignement</span>
    <span class="c1"># 3- Stratégies de mise à jour des metrics locales :</span>
    <span class="n">SGY_COORD_RELATIVE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;SGY_COORD_RELATIVE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: stratégie de positionnement relative (in flow)</span>
    <span class="n">SGY_COORD_OFFSET</span> <span class="o">=</span> <span class="s2">&quot;SGY_COORD_OFFSET&quot;</span>  <span class="c1">#: stratégie de positionnement par offsets</span>
    <span class="n">SGY_COORD_ALIGN</span> <span class="o">=</span> <span class="s2">&quot;SGY_COORD_ALIGN&quot;</span>  <span class="c1">#: stratégie de positionnement par alignement</span>
    <span class="n">SGY_COORD_VALUE</span> <span class="o">=</span> <span class="s2">&quot;SGY_COORD_VALUE&quot;</span>  <span class="c1">#: stratégie de positionnement par coordonnée</span>
    <span class="n">SGY_DIM_FLEX</span> <span class="o">=</span> <span class="s2">&quot;SGY_DIM_FLEX&quot;</span>  <span class="c1">#: stratégie de dimensionnement par flex</span>
    <span class="n">SGY_DIM_OFFSETS</span> <span class="o">=</span> <span class="s2">&quot;SGY_DIM_OFFSETS&quot;</span>  <span class="c1">#: stratégie de dimensionnement par offsets</span>
    <span class="n">SGY_DIM_VALUE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;SGY_DIM_VALUE&quot;</span>  
    <span class="p">)</span> <span class="c1">#: stratégie de dimensionnement par dimension explicite</span>
    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs : peut contenir toutes les propriétés de boxing supportées par BoxModelObject.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- Initialisations :</span>
        <span class="c1"># nom (debug)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="c1"># propriété de positionnement : relative par défaut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># métriques :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># coordonnées locales absolues:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Coordonnées locales imposées par le layout parent (px)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Coordonnées locales calculées en fonction de la position :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_coords_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># offsets :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># dimensions :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># padding et margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;margin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># metric en cas de stratégie SGY_DIM_FLEX :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;SGY_DIM_FLEX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># alignements:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_align</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_valign</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># adaptation au contenu :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snapW</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snapH</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># True si snapW ou snapH</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Appartenance au flux de layout parent :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_in_flow</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># valeur de flex :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Liste des propriétés parsées qui n&#39;ont plus leur valeur par défaut :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_default_properties</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Stratégies de mises à jour :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Rects de publication portant les valeurs calculées :</span>
        <span class="c1"># Rq : la propriété pygame obj.rect est redirigée vers obj.publicationRect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="p">)</span>  <span class="c1"># données pseudo globales dans le plan du RealContainer assurant la publication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="p">)</span>  <span class="c1"># données pseudo globales du plan de référence (parent ou root)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unsnapped_publicationRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="p">)</span>  <span class="c1"># publication rect avant application du snap :</span>
        <span class="c1"># Rect global (par rapport au root), nécessaire pour les tests de collision (cf events)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Rects internes : surfaces alouées au contenu et aux bordure/fond</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inner_rects_valide</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># les rect de contenu et bordure sont ils en coords locales ou globales</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Resize :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_resized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># BoxModelObject parent :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Référence au RootContainer :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rootreference</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># 2- Parsing des propriétés :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_boxmodel</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1">#-----&gt; Initialisations</span>
    <span class="k">def</span> <span class="nf">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de boxmodel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- Position :</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;position&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_default_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="c1"># 2- Parsing des propriétés :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_properties</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># 3- Définition des stratégies de mise à jour :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy</span><span class="p">(</span><span class="s2">&quot;xabs&quot;</span><span class="p">,</span> <span class="s2">&quot;yabs&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
        <span class="c1"># 4- Post initialisations :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_control_boxmodel</span><span class="p">()</span>

<div class="viewcode-block" id="BoxModelObject.post_control_boxmodel"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.post_control_boxmodel">[docs]</a>    <span class="k">def</span> <span class="nf">post_control_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spécifie au besoin des valeurs par défaut (snaps).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_default_value</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapW</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s2">&quot;100%&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_default_value</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">&quot;100%&quot;</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_position"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_position">[docs]</a>    <span class="k">def</span> <span class="nf">parse_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse un attribut de position.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_VALUES</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_properties"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_properties">[docs]</a>    <span class="k">def</span> <span class="nf">parse_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse les propriétés présentes dans kwargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ik</span> <span class="o">=</span> <span class="n">k</span>  <span class="c1"># clef interne</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]:</span>
                <span class="c1"># on ajoute le suffix &quot;abs&quot; indiquant qu&#39;il s&#39;agit d&#39;une coordonnée</span>
                <span class="c1"># locale absolue :</span>
                <span class="n">ik</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;abs&quot;</span>
            <span class="k">if</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">METRIC_ATTR</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ik</span> <span class="o">==</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span>
                    <span class="n">minwidth</span> <span class="o">=</span> <span class="n">maxwidth</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;minwidth&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">minwidth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;minwidth&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;maxwidth&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">maxwidth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;maxwidth&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_boundedmetric</span><span class="p">(</span>
                        <span class="n">v</span><span class="p">,</span> <span class="n">minwidth</span><span class="p">,</span> <span class="n">maxwidth</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">ik</span> <span class="o">==</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span>
                    <span class="n">minheight</span> <span class="o">=</span> <span class="n">maxheight</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;minheight&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">minheight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;minheight&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;maxheight&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">maxheight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;maxheight&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_boundedmetric</span><span class="p">(</span>
                        <span class="n">v</span><span class="p">,</span> <span class="n">minheight</span><span class="p">,</span> <span class="n">maxheight</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_ATTR</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_alignement</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SNAP_ATTR</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_snap</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">FLEX_ATTR</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_flex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ik</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_default_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.has_default_value"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.has_default_value">[docs]</a>    <span class="k">def</span> <span class="nf">has_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">propname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si la propriété de nom propname a une valeur par défaut.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">propname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_default_properties</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_metric"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_metric">[docs]</a>    <span class="k">def</span> <span class="nf">parse_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une propriété de type BoxModelObject.METRIC_ATTR.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            un objet MetricValue ou None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">parseMetric</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_boundedmetric"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_boundedmetric">[docs]</a>    <span class="k">def</span> <span class="nf">parse_boundedmetric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">minvalue</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une propriété de type BoxModelObject.METRIC_ATTR bornée.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            un objet BoundedMetricValue ou None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">parseMetric</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">minvalue</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_alignement"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_alignement">[docs]</a>    <span class="k">def</span> <span class="nf">parse_alignement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une prorpiété de type BoxModelObject.ALIGN_ATTR.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            une valeur (voir ppté statiques) ou None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">,</span>
        <span class="p">]</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_TOP</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_MIDDLE</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_BOTTOM</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_snap"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_snap">[docs]</a>    <span class="k">def</span> <span class="nf">parse_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une propriété de type BoxModelObject.SNAP_ATTR.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BoxModelObject.parse_flex"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.parse_flex">[docs]</a>    <span class="k">def</span> <span class="nf">parse_flex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse l&#39;attribut flex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BoxModelObject.define_strategy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.define_strategy">[docs]</a>    <span class="k">def</span> <span class="nf">define_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">props</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Définit la stratégie de calcul de la propriété prop parmi (xabs, yabs, width, height).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">,</span> <span class="s2">&quot;yabs&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy_coord</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy_dim</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.define_strategy_coord"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.define_strategy_coord">[docs]</a>    <span class="k">def</span> <span class="nf">define_strategy_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stratégie de calcul de coordonnées.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;xabs&quot;</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
            <span class="n">palign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
            <span class="n">palign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valign</span>
        <span class="c1"># la prop est-elle orthogonale à l&#39;axe de layout?</span>
        <span class="n">orth_axis</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span>
                <span class="ow">and</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;yabs&quot;</span>
            <span class="p">):</span>
                <span class="n">orth_axis</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span>
                <span class="ow">and</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;xabs&quot;</span>
            <span class="p">):</span>
                <span class="n">orth_axis</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Par priorité desc :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orth_axis</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">offset_1</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset_2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_OFFSET</span>
                <span class="k">elif</span> <span class="n">palign</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_ALIGN</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_RELATIVE</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_RELATIVE</span>
        <span class="k">elif</span> <span class="n">offset_1</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">offset_2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_OFFSET</span>
        <span class="k">elif</span> <span class="n">palign</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_ALIGN</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_VALUE</span></div>

<div class="viewcode-block" id="BoxModelObject.define_strategy_dim"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.define_strategy_dim">[docs]</a>    <span class="k">def</span> <span class="nf">define_strategy_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stratégie de calcul de dimension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
            <span class="n">direct_flow</span> <span class="o">=</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
            <span class="n">direct_flow</span> <span class="o">=</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span>
        <span class="c1"># Par priorité desc :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">flex</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">direct_flow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_FLEX</span>
        <span class="k">elif</span> <span class="n">offset_1</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">offset_2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_OFFSETS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_VALUE</span></div>

<div class="viewcode-block" id="BoxModelObject.discard_strategy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_strategy">[docs]</a>    <span class="k">def</span> <span class="nf">discard_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide la stratégie associée à la propriété prop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">,</span> <span class="s2">&quot;yabs&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="c1">#-----&gt; Calculs, mise à jour</span>
<div class="viewcode-block" id="BoxModelObject.update_core_metrics"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_core_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">update_core_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalcul des metricparams x, y, width, height en fonction du rect de référence refrect</span>
<span class="sd">        représentant la surface alouée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">refrect</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">refrect</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">refrect</span><span class="o">.</span><span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># 1- Dimensions :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_dims</span><span class="p">(</span><span class="n">refrect</span><span class="p">)</span>
        <span class="c1"># 2- actualisation de padding et margin :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_spaces</span><span class="p">(</span><span class="n">refrect</span><span class="p">)</span>
        <span class="c1"># 3- Coordonnées :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_coords</span><span class="p">(</span><span class="n">refrect</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.compute_dims"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.compute_dims">[docs]</a>    <span class="k">def</span> <span class="nf">compute_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul de width et height en fonction du rect de référence refrect représentant</span>
<span class="sd">        la surface alouée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_dim</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">refrect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_dim</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">refrect</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.update_dim"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_dim">[docs]</a>    <span class="k">def</span> <span class="nf">update_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul de la dimension prop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># stratégie de mise à jour :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy_dim</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="c1"># paramètres de calcul :</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>
            <span class="n">ref_dim</span> <span class="o">=</span> <span class="n">refrect</span><span class="o">.</span><span class="n">width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
            <span class="n">ref_dim</span> <span class="o">=</span> <span class="n">refrect</span><span class="o">.</span><span class="n">height</span>
        <span class="c1"># En fonction de la stratégie :</span>
        <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_FLEX</span><span class="p">:</span>
            <span class="n">flexmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;SGY_DIM_FLEX&quot;</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">flexmetric</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_OFFSETS</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">ref_dim</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">offset_1</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">offset_2</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_DIM_VALUE</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">dim</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c1"># enregistrement :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_metric_value</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.compute_spaces"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.compute_spaces">[docs]</a>    <span class="k">def</span> <span class="nf">compute_spaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul de padding ou margin.</span>
<span class="sd">        </span>
<span class="sd">        Rq : ces propriétés étant uniformes sur les 4 bords, on considère</span>
<span class="sd">        comme valeur de référence la moyenne des dimensions de refrect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">refval</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">refrect</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">refrect</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># margin (externe) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_space</span><span class="p">(</span><span class="s2">&quot;margin&quot;</span><span class="p">,</span> <span class="n">refval</span><span class="p">)</span>
        <span class="c1"># padding (interne) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_space</span><span class="p">(</span><span class="s2">&quot;padding&quot;</span><span class="p">,</span> <span class="n">refval</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.update_space"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_space">[docs]</a>    <span class="k">def</span> <span class="nf">update_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">refval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul d&#39;une propriété de type padding ou margin.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># valeur de référence :</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">refval</span><span class="p">)</span>
        <span class="c1"># enregistrement :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_metric_value</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.compute_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.compute_coords">[docs]</a>    <span class="k">def</span> <span class="nf">compute_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul de xabs et yabs en fonction du rect de référence refrect représentant</span>
<span class="sd">        la surface alouée.</span>
<span class="sd">        </span>
<span class="sd">        RQ : les dimensions doivent être mises à jour auparavant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_coord</span><span class="p">(</span><span class="s2">&quot;xabs&quot;</span><span class="p">,</span> <span class="n">refrect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_coord</span><span class="p">(</span><span class="s2">&quot;yabs&quot;</span><span class="p">,</span> <span class="n">refrect</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.update_coord"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_coord">[docs]</a>    <span class="k">def</span> <span class="nf">update_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">refrect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcul de la coordonnée prop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># stratégie de mise à jour :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy_coord</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="c1"># paramètres de calcul :</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;xabs&quot;</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
            <span class="n">palign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span>
            <span class="n">ref_dim</span> <span class="o">=</span> <span class="n">refrect</span><span class="o">.</span><span class="n">width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
            <span class="n">offset_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
            <span class="n">palign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valign</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_strategies</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span>
            <span class="n">ref_dim</span> <span class="o">=</span> <span class="n">refrect</span><span class="o">.</span><span class="n">height</span>
        <span class="c1"># En fonction de la stratégie :</span>
        <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_RELATIVE</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_OFFSET</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">offset_1</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">offset_1</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">offset_2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">ref_dim</span> <span class="o">-</span> <span class="p">(</span><span class="n">dim</span> <span class="o">+</span> <span class="n">offset_2</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_ALIGN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">palign</span> <span class="ow">in</span> <span class="p">[</span><span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">,</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_TOP</span><span class="p">]:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">palign</span> <span class="ow">in</span> <span class="p">[</span><span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">,</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_MIDDLE</span><span class="p">]:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">ref_dim</span> <span class="o">-</span> <span class="n">dim</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">palign</span> <span class="ow">in</span> <span class="p">[</span><span class="n">BoxModelObject</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">,</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">VALIGN_BOTTOM</span><span class="p">]:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">ref_dim</span> <span class="o">-</span> <span class="n">dim</span>
        <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">SGY_COORD_VALUE</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">refvalue</span><span class="o">=</span><span class="n">ref_dim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c1"># enregistrement :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_metric_value</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="c1"># discard des propriétés cachées derrière x et y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_pos_coords</span><span class="p">()</span></div>

<div class="viewcode-block" id="BoxModelObject.get_metric_value"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_metric_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_metric_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la valeur calculée de self.metricparams[prop]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span><span class="o">.</span><span class="n">get_computedvalue</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BoxModelObject.set_metric_value"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.set_metric_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_metric_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affecte val à la valeur calculée de self.metricparams[prop]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span><span class="o">.</span><span class="n">set_computedvalue</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Parent :</span>
    <span class="k">def</span> <span class="nf">_get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;VirtualContainer parent&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="k">def</span> <span class="nf">_set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_parent_changed</span><span class="p">()</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_parent</span><span class="p">,</span> <span class="n">_set_parent</span><span class="p">)</span>  <span class="c1">#: VirtualContainer parent</span>

<div class="viewcode-block" id="BoxModelObject.on_parent_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_parent_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_parent_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque la référence au parent est modifiée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">,</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="c1">#-----&gt; Appartenance au &quot;flow de layout&quot; parent:</span>
    <span class="k">def</span> <span class="nf">_get_in_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appartenance au &quot;flow de layout&quot; parent&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_in_flow</span>

    <span class="k">def</span> <span class="nf">_set_in_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_in_flow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_in_flow</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_in_flow_changed</span><span class="p">()</span>

    <span class="n">in_flow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_in_flow</span><span class="p">,</span> <span class="n">_set_in_flow</span>
    <span class="p">)</span>  <span class="c1">#: Appartenance au &quot;flow de layout&quot; parent (bool)</span>

<div class="viewcode-block" id="BoxModelObject.on_in_flow_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_in_flow_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_in_flow_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;objet entre ou sort du flux de layout parent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># on redéfinit les stratégies :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">define_strategy</span><span class="p">(</span><span class="s2">&quot;xabs&quot;</span><span class="p">,</span> <span class="s2">&quot;yabs&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Root</span>
    <span class="k">def</span> <span class="nf">_get_rootreference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recherche du RootContainer&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rootreference</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">while</span> <span class="n">p</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">RootContainer</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_set_rootreference</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rootreference</span>

    <span class="k">def</span> <span class="nf">_set_rootreference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rootcont</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rootreference</span> <span class="o">=</span> <span class="n">rootcont</span>

    <span class="n">root_reference</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_rootreference</span><span class="p">,</span> <span class="n">_set_rootreference</span>
    <span class="p">)</span>  <span class="c1">#: référence au RootContainer</span>

    <span class="c1">#-----&gt; Rects de publication</span>
<div class="viewcode-block" id="BoxModelObject.re_initialise_rects"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.re_initialise_rects">[docs]</a>    <span class="k">def</span> <span class="nf">re_initialise_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ré initialisation des rects, conserve le paramétrage (métrics, alignements, snap).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unsnapped_publicationRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_get_publicationRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rect de publication de l&#39;objet.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRect</span>

    <span class="k">def</span> <span class="nf">_set_publicationRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRect</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">publicationRect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_publicationRect</span><span class="p">,</span> <span class="n">_set_publicationRect</span>
    <span class="p">)</span>  <span class="c1">#: Rect de publication de l&#39;objet</span>

    <span class="k">def</span> <span class="nf">_get_publicationRefRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rect de publication de référence (celui du parent en général).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span>

    <span class="k">def</span> <span class="nf">_set_publicationRefRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">):</span>
            <span class="n">newcoords</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">oldcoords</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">x</span><span class="p">),</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">newdims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>
            <span class="n">olddims</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">width</span><span class="p">),</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">height</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">newdims</span> <span class="o">!=</span> <span class="n">olddims</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">newdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">newdims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRefRect_dims_changed</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">newcoords</span> <span class="o">!=</span> <span class="n">oldcoords</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRefRect_coords_changed</span><span class="p">()</span>

    <span class="n">publicationRefRect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_publicationRefRect</span><span class="p">,</span> <span class="n">_set_publicationRefRect</span>
    <span class="p">)</span>  <span class="c1">#: Rect de publication de référence (celui du parent en général).</span>

    <span class="k">def</span> <span class="nf">_get_unsnapped_publicationRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rect de publication avant adaptation au contenu.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unsnapped_publicationRect</span>

    <span class="k">def</span> <span class="nf">_set_unsnapped_publicationRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unsnapped_publicationRect</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">unsnapped_publicationRect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_unsnapped_publicationRect</span><span class="p">,</span> <span class="n">_set_unsnapped_publicationRect</span>
    <span class="p">)</span>  <span class="c1">#: Rect de publication avant adaptation au contenu.</span>

<div class="viewcode-block" id="BoxModelObject.update_publicationRefRect_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_publicationRefRect_coords">[docs]</a>    <span class="k">def</span> <span class="nf">update_publicationRefRect_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modification des coordonnées seules du rect de publication de référence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newcoords</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">oldcoords</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">newcoords</span> <span class="o">!=</span> <span class="n">oldcoords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">newcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRefRect_coords_changed</span><span class="p">()</span></div>

<div class="viewcode-block" id="BoxModelObject.on_fixed_child_parent_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_fixed_child_parent_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_fixed_child_parent_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode dédiée aux éléments en position fixed, appelée par le container</span>
<span class="sd">        parent alternativement à update_publicationRefRect_coords.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">y</span>
            <span class="c1"># offsets compensant les coords globales du parent</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pgx</span><span class="p">,</span> <span class="n">pgy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_global_coords</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="n">pgx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="n">pgy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRect_coords_changed</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.on_publicationRefRect_dims_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_publicationRefRect_dims_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRefRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque les dimensions du rect de publication de référence</span>
<span class="sd">        (self._publicationRefRect) ont été modifiées (et éventuellement</span>
<span class="sd">        les coordonnées aussi).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; on_publicationRefRect_dims_changed ! publicationRefRect=&quot;,self.publicationRefRect)</span>
        <span class="c1"># invalidation du resize :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

<div class="viewcode-block" id="BoxModelObject.on_publicationRefRect_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_publicationRefRect_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRefRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque les coordonnées du rect de publication de référence</span>
<span class="sd">        (self._publicationRefRect) ont été modifiées (mais pas les dimensions).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; on_publicationRefRect_coords_changed !&quot;)</span>
        <span class="c1"># maj des coords de self.publicationRect et de x et y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_pos_coords</span><span class="p">()</span>
        <span class="c1"># invalidation des rects internes :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="c1"># et du display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_get_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;Redirige la propriété rect vers self.publicationRect&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span>

    <span class="k">def</span> <span class="nf">_set_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="c1"># read-only, la vraie valeur est self.publicationRect</span>
        <span class="k">pass</span>

    <span class="n">rect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_rect</span><span class="p">,</span> <span class="n">_set_rect</span>
    <span class="p">)</span>  <span class="c1">#: Redirige la propriété rect vers self.publicationRect</span>

    <span class="c1">#-----&gt; Surfaces alouées internes</span>
<div class="viewcode-block" id="BoxModelObject.discard_inner_rects"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_inner_rects">[docs]</a>    <span class="k">def</span> <span class="nf">discard_inner_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide les rects de publication interne (contenu et bordure).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inner_rects_valide</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BoxModelObject.update_inner_rects"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_inner_rects">[docs]</a>    <span class="k">def</span> <span class="nf">update_inner_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour les rects de publication interne (contenu et bordure).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># contenu :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_content_rect</span><span class="p">()</span>
        <span class="c1"># border / bg :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_border_rect</span><span class="p">()</span>
        <span class="c1"># indicateur d&#39;update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inner_rects_valide</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="BoxModelObject.update_content_rect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_content_rect">[docs]</a>    <span class="k">def</span> <span class="nf">update_content_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour le rect de contenu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">m</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span>
        <span class="n">wc</span><span class="p">,</span> <span class="n">hc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">wc</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">hc</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.update_border_rect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_border_rect">[docs]</a>    <span class="k">def</span> <span class="nf">update_border_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour le rect de bordure/fond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">m</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span></div>

<div class="viewcode-block" id="BoxModelObject.get_content_rect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_content_rect">[docs]</a>    <span class="k">def</span> <span class="nf">get_content_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le Rect dédié à l&#39;affichage du contenu, une</span>
<span class="sd">        fois margin et padding retirés.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_rects_valide</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_inner_rects</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contentRect</span></div>

<div class="viewcode-block" id="BoxModelObject.get_border_rect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_border_rect">[docs]</a>    <span class="k">def</span> <span class="nf">get_border_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le Rect dédié à l&#39;affichage d&#39;une bordure ou d&#39;un fond</span>
<span class="sd">        une fois margin retirée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_rects_valide</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_inner_rects</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_borderRect</span></div>

    <span class="c1">#-----&gt; Rect de référence absolue</span>
    <span class="k">def</span> <span class="nf">_get_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rect de référence absolu.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_globalRect</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span>

    <span class="k">def</span> <span class="nf">_set_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">globalRect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_globalRect</span><span class="p">,</span> <span class="n">_set_globalRect</span>
    <span class="p">)</span>  <span class="c1">#: Rect de référence absolu.</span>

<div class="viewcode-block" id="BoxModelObject.discard_globalRect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_globalRect">[docs]</a>    <span class="k">def</span> <span class="nf">discard_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide le rect global.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BoxModelObject.update_globalRect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_globalRect">[docs]</a>    <span class="k">def</span> <span class="nf">update_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour du rect global.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_global_coords</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">rx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globalRect_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="BoxModelObject.get_global_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_global_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_global_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la position absolue exacte par rapport au Root.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gx</span><span class="p">,</span> <span class="n">gy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">while</span> <span class="n">p</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_scope_delta_coords</span><span class="p">()</span>
                <span class="n">gx</span> <span class="o">+=</span> <span class="n">px</span>
                <span class="n">gy</span> <span class="o">+=</span> <span class="n">py</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">gx</span><span class="p">,</span> <span class="n">gy</span></div>

<div class="viewcode-block" id="BoxModelObject.get_scope_delta_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_scope_delta_coords">[docs]</a>    <span class="k">def</span> <span class="nf">get_scope_delta_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le décallage dx, dy induit par le scope de contenu de cet objet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span>
            <span class="n">dy</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span>
        <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span></div>

    <span class="c1">#-----&gt; Position</span>
    <span class="k">def</span> <span class="nf">_get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Position au cens css.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>

    <span class="k">def</span> <span class="nf">_set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_position</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_position_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>

    <span class="n">position</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_position</span><span class="p">,</span> <span class="n">_set_position</span><span class="p">)</span>  <span class="c1">#: Position au cens css.</span>

<div class="viewcode-block" id="BoxModelObject.on_position_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_position_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_position_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newposition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;attribut position a été modifié.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">newposition</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span>
            <span class="k">if</span> <span class="n">root</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="c1"># layout parent :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_position_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Coordonnées locales absolues (hors flow de layout)</span>
    <span class="k">def</span> <span class="nf">_get_xabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Abcisse locale absolue (hors flow de layout).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_xabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;xabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_abs_coord_changed</span><span class="p">(</span><span class="s2">&quot;xabs&quot;</span><span class="p">)</span>

    <span class="n">xabs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_xabs</span><span class="p">,</span> <span class="n">_set_xabs</span>
    <span class="p">)</span>  <span class="c1">#: Abcisse locale absolue, hors flow de layout (usage interne).</span>

    <span class="k">def</span> <span class="nf">_get_yabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ordonnée locale absolue (hors flow de layout).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_yabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;yabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_abs_coord_changed</span><span class="p">(</span><span class="s2">&quot;yabs&quot;</span><span class="p">)</span>

    <span class="n">yabs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_yabs</span><span class="p">,</span> <span class="n">_set_yabs</span>
    <span class="p">)</span>  <span class="c1">#: Ordonnée locale absolue, hors flow de layout (usage interne).</span>

<div class="viewcode-block" id="BoxModelObject.on_abs_coord_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_abs_coord_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_abs_coord_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite de coordonnée absolue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_strategy</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_pos_coords</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Coordonnées locales imposées par le layout parent :</span>
    <span class="k">def</span> <span class="nf">_get_xflow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Abcisse locale imposée par le layout parent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xflow</span>

    <span class="k">def</span> <span class="nf">_set_xflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xflow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xflow</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_flow_coord_changed</span><span class="p">()</span>

    <span class="n">xflow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_xflow</span><span class="p">,</span> <span class="n">_set_xflow</span>
    <span class="p">)</span>  <span class="c1">#: Abcisse locale calculée imposée par le layout parent (usage interne).</span>

    <span class="k">def</span> <span class="nf">_get_yflow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ordonnée locale imposée par le layout parent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yflow</span>

    <span class="k">def</span> <span class="nf">_set_yflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yflow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_yflow</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_flow_coord_changed</span><span class="p">()</span>

    <span class="n">yflow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_yflow</span><span class="p">,</span> <span class="n">_set_yflow</span>
    <span class="p">)</span>  <span class="c1">#: Ordonnée locale calculée imposée par le layout parent (usage interne).</span>

<div class="viewcode-block" id="BoxModelObject.on_flow_coord_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_flow_coord_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_flow_coord_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite de coordonnée via le layout parent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1">#-----&gt; Interface d&#39;accès aux coordonnées locales calculées en fonction de la position</span>
    <span class="k">def</span> <span class="nf">_get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Abcisse locale calculée en fonction de l&#39;attribut position.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_coords_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pos_coords</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span>

    <span class="k">def</span> <span class="nf">_set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xflow</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xabs</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_x</span><span class="p">,</span> <span class="n">_set_x</span><span class="p">)</span>  <span class="c1">#: Abcisse locale publique.</span>

    <span class="k">def</span> <span class="nf">_get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ordonnée locale calculée en fonction de l&#39;attribut position.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_coords_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pos_coords</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span>

    <span class="k">def</span> <span class="nf">_set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yflow</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yabs</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">y</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_y</span><span class="p">,</span> <span class="n">_set_y</span><span class="p">)</span>  <span class="c1">#: Ordonnée locale publique.</span>

<div class="viewcode-block" id="BoxModelObject.discard_pos_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_pos_coords">[docs]</a>    <span class="k">def</span> <span class="nf">discard_pos_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide les propriétés _xpos et _ypos,  attributs &quot;cachés&quot; derrière les getters de x et y.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_coords_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BoxModelObject.update_pos_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_pos_coords">[docs]</a>    <span class="k">def</span> <span class="nf">update_pos_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalcule _xpos et _ypos, attributs &quot;cachés&quot; derrière les getters de x et y.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oldcoords</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span><span class="p">)</span>
        <span class="c1"># axe de layout</span>
        <span class="n">flow_direction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">flow_direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">direction</span>
        <span class="c1"># axe X :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="ow">and</span> <span class="n">flow_direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xflow</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xabs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xabs</span>
        <span class="c1"># axe y :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_flow</span> <span class="ow">and</span> <span class="n">flow_direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yflow</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yabs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yabs</span>
        <span class="c1"># indicateur de mise à jour :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_coords_updated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># update de publicationRect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">y</span>
        <span class="c1"># cas particulier fixed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
            <span class="c1"># offsets compensant les coords globales du parent</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pgx</span><span class="p">,</span> <span class="n">pgy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_global_coords</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="n">pgx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="n">pgy</span>
        <span class="c1"># changement?</span>
        <span class="k">if</span> <span class="n">oldcoords</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ypos</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="c1">#-----&gt; Offsets locaux :</span>
    <span class="k">def</span> <span class="nf">_get_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Offset de positionnement gauche.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_offset_changed</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="n">left</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_left</span><span class="p">,</span> <span class="n">_set_left</span><span class="p">)</span>  <span class="c1">#: Offset de positionnement gauche.</span>

    <span class="k">def</span> <span class="nf">_get_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Offset de positionnement droit.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_offset_changed</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="n">right</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_right</span><span class="p">,</span> <span class="n">_set_right</span><span class="p">)</span>  <span class="c1">#: Offset de positionnement droit.</span>

    <span class="k">def</span> <span class="nf">_get_top</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Offset de positionnement haut.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_offset_changed</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_top</span><span class="p">,</span> <span class="n">_set_top</span><span class="p">)</span>  <span class="c1">#: Offset de positionnement haut.</span>

    <span class="k">def</span> <span class="nf">_get_bottom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Offset de positionnement bas.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_bottom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_offset_changed</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>

    <span class="n">bottom</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bottom</span><span class="p">,</span> <span class="n">_set_bottom</span><span class="p">)</span>  <span class="c1">#: Offset de positionnement bas.</span>

<div class="viewcode-block" id="BoxModelObject.on_offset_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_offset_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_offset_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite d&#39;offset (top, bottom, left, right).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="s2">&quot;xabs&quot;</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="s2">&quot;width&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="s2">&quot;yabs&quot;</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="s2">&quot;height&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_strategy</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_strategy</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_pos_coords</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Dimensions totales (padding et margin compris)</span>
    <span class="k">def</span> <span class="nf">_get_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Largeur totale (padding et margin compris).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span>

    <span class="k">def</span> <span class="nf">_set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_boundedmetric</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minwidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxwidth</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_changed</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span>

    <span class="n">width</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_width</span><span class="p">,</span> <span class="n">_set_width</span>
    <span class="p">)</span>  <span class="c1">#: Largeur totale (padding et margin compris) publique.</span>

    <span class="k">def</span> <span class="nf">_get_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hauteur totale (padding et margin compris).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span>

    <span class="k">def</span> <span class="nf">_set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_boundedmetric</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minheight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxheight</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_changed</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span>

    <span class="n">height</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_height</span><span class="p">,</span> <span class="n">_set_height</span>
    <span class="p">)</span>  <span class="c1">#: Hauteur totale (padding et margin compris) publique.</span>

<div class="viewcode-block" id="BoxModelObject.on_dimension_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_dimension_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_dimension_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite de dimensions (hors process de resize).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_strategy</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Bornage des dimensions :</span>
    <span class="k">def</span> <span class="nf">_get_minwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Largeur min en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_bound</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_minwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_minwidth</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_bound_changed</span><span class="p">()</span>

    <span class="n">minwidth</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_minwidth</span><span class="p">,</span> <span class="n">_set_minwidth</span><span class="p">)</span>  <span class="c1">#: Largeur min en px.</span>

    <span class="k">def</span> <span class="nf">_get_maxwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Largeur max en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_bound</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_maxwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_maxwidth</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_bound_changed</span><span class="p">()</span>

    <span class="n">maxwidth</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_maxwidth</span><span class="p">,</span> <span class="n">_set_maxwidth</span><span class="p">)</span>  <span class="c1">#: Largeur max en px.</span>

    <span class="k">def</span> <span class="nf">_get_minheight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hauteur min en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_bound</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_minheight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_minheight</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_bound_changed</span><span class="p">()</span>

    <span class="n">minheight</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_minheight</span><span class="p">,</span> <span class="n">_set_minheight</span><span class="p">)</span>  <span class="c1">#: Hauteur min en px.</span>

    <span class="k">def</span> <span class="nf">_get_maxheight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hauteur max en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_bound</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_maxheight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_maxheight</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_dimension_bound_changed</span><span class="p">()</span>

    <span class="n">maxheight</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_maxheight</span><span class="p">,</span> <span class="n">_set_maxheight</span><span class="p">)</span>  <span class="c1">#: Hauteur max en px.</span>

<div class="viewcode-block" id="BoxModelObject.on_dimension_bound_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_dimension_bound_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_dimension_bound_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsqu&#39;une borne de dimension a été modifiée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Padding :</span>
    <span class="k">def</span> <span class="nf">_get_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Padding en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_padding_changed</span><span class="p">()</span>

    <span class="n">padding</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_padding</span><span class="p">,</span> <span class="n">_set_padding</span><span class="p">)</span>  <span class="c1">#: Padding en px.</span>

<div class="viewcode-block" id="BoxModelObject.on_padding_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_padding_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_padding_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque le padding a été modifié.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; margin :</span>
    <span class="k">def</span> <span class="nf">_get_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Margin en px.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;margin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_metric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldmetric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;margin&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">newmetric</span> <span class="o">!=</span> <span class="n">oldmetric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metricparams</span><span class="p">[</span><span class="s2">&quot;margin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmetric</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_margin_changed</span><span class="p">()</span>

    <span class="n">margin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_margin</span><span class="p">,</span> <span class="n">_set_margin</span><span class="p">)</span>  <span class="c1">#: Margin en px.</span>

<div class="viewcode-block" id="BoxModelObject.on_margin_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_margin_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_margin_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque la marge a été modifiée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Alignements :</span>
    <span class="k">def</span> <span class="nf">_get_align</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alignement horizontal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align</span>

    <span class="k">def</span> <span class="nf">_set_align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_alignement</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align</span>
        <span class="k">if</span> <span class="n">newval</span> <span class="o">!=</span> <span class="n">oldval</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_align</span> <span class="o">=</span> <span class="n">newval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_alignement_changed</span><span class="p">(</span><span class="s2">&quot;align&quot;</span><span class="p">)</span>

    <span class="n">align</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_align</span><span class="p">,</span> <span class="n">_set_align</span><span class="p">)</span>  <span class="c1">#: Alignement horizontal.</span>

    <span class="k">def</span> <span class="nf">_get_valign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alignement vertical.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valign</span>

    <span class="k">def</span> <span class="nf">_set_valign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_alignement</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valign</span>
        <span class="k">if</span> <span class="n">newval</span> <span class="o">!=</span> <span class="n">oldval</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valign</span> <span class="o">=</span> <span class="n">newval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_alignement_changed</span><span class="p">(</span><span class="s2">&quot;valign&quot;</span><span class="p">)</span>

    <span class="n">valign</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_valign</span><span class="p">,</span> <span class="n">_set_valign</span><span class="p">)</span>  <span class="c1">#: Alignement vertical.</span>

<div class="viewcode-block" id="BoxModelObject.on_alignement_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_alignement_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_alignement_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite d&#39;alignement.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;align&quot;</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="s2">&quot;xabs&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="s2">&quot;yabs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_strategy</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_pos_coords</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Snaps :</span>
    <span class="k">def</span> <span class="nf">_get_snapW</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adaptation à la largeur du contenu (bool).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapW</span>

    <span class="k">def</span> <span class="nf">_set_snapW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_snap</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapW</span>
        <span class="k">if</span> <span class="n">newval</span> <span class="o">!=</span> <span class="n">oldval</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snapW</span> <span class="o">=</span> <span class="n">newval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_snap_changed</span><span class="p">()</span>

    <span class="n">snapW</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_snapW</span><span class="p">,</span> <span class="n">_set_snapW</span>
    <span class="p">)</span>  <span class="c1">#: Adaptation à la largeur du contenu (bool).</span>

    <span class="k">def</span> <span class="nf">_get_snapH</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adaptation à la hauteur du contenu (bool).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapH</span>

    <span class="k">def</span> <span class="nf">_set_snapH</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_snap</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">oldval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snapH</span>
        <span class="k">if</span> <span class="n">newval</span> <span class="o">!=</span> <span class="n">oldval</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snapH</span> <span class="o">=</span> <span class="n">newval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_snap_changed</span><span class="p">()</span>

    <span class="n">snapH</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_snapH</span><span class="p">,</span> <span class="n">_set_snapH</span>
    <span class="p">)</span>  <span class="c1">#: Adaptation à la hauteur du contenu (bool).</span>

<div class="viewcode-block" id="BoxModelObject.on_snap_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_snap_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_snap_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors d&#39;un changement explicite de snap.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapW</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># surcharge au besoin de width ou height :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_control_boxmodel</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span>
        <span class="c1"># layout parent :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_snap_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Flex :</span>
    <span class="k">def</span> <span class="nf">_get_flex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Valeur de flex.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flex</span>

    <span class="k">def</span> <span class="nf">_set_flex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">newval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_flex</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">newval</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flex</span> <span class="o">=</span> <span class="n">newval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_flex_changed</span><span class="p">()</span>

    <span class="n">flex</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_flex</span><span class="p">,</span> <span class="n">_set_flex</span><span class="p">)</span>  <span class="c1">#: Valeur de flex.</span>

<div class="viewcode-block" id="BoxModelObject.on_flex_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_flex_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_flex_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;attribut flex a été modifié.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">,</span>
            <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span>
            <span class="c1"># layout parent :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_flex_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Resize</span>
<div class="viewcode-block" id="BoxModelObject.resize"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.resize">[docs]</a>    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalcul de la taille et de la position.</span>
<span class="sd">        Met à jour self.publicationRect, alias de self.rect.</span>
<span class="sd">        Rqs : l&#39;attribut position est pris en compte dans les getters/setters de x et y,</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            True si le resize a été modifié</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; resize self.is_resized=&quot;,self.is_resized,&quot; rect=&quot;,self.rect)</span>
        <span class="c1"># tests préalables :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_compute_resize</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Maj des metrics : dimensions puis coordonnées</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_core_metrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="p">)</span>
        <span class="c1"># Maj de publicationRect :</span>
        <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_publicationRect</span><span class="p">()</span>
        <span class="c1"># snap :</span>
        <span class="n">change_snap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
            <span class="n">content_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_dimensions</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">content_dims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">change_snap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_item_snap</span><span class="p">(</span><span class="n">content_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">content_dims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># statut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_resized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; resize change=&quot;,change,&quot; change_snap=&quot;,change_snap,&quot; rect=&quot;,self.rect)</span>
        <span class="k">return</span> <span class="n">change</span> <span class="ow">or</span> <span class="n">change_snap</span></div>

<div class="viewcode-block" id="BoxModelObject.do_compute_resize"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.do_compute_resize">[docs]</a>    <span class="k">def</span> <span class="nf">do_compute_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests préalables aux calculs de resize.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">docompute</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_resized</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Position et référence globale :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_publicationRefRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">docompute</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">docompute</span></div>

<div class="viewcode-block" id="BoxModelObject.get_item_dimensions"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.get_item_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">get_item_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Doit retourner les dimensions réelles du contenu (texte, image).</span>
<span class="sd">        A implémenter dans les subclasses utilisant le snap.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int, int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BoxModelObject.discard_resize"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_resize">[docs]</a>    <span class="k">def</span> <span class="nf">discard_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Marque l&#39;objet comme non resizé.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; discard_resize !*!&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_resized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_unresized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Maj du rect de publication :</span>
<div class="viewcode-block" id="BoxModelObject.update_publicationRect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.update_publicationRect">[docs]</a>    <span class="k">def</span> <span class="nf">update_publicationRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour de publicationRect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oldcoords</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="n">olddims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>
        <span class="c1"># affectation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span>
        <span class="c1"># cas particulier fixed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
            <span class="c1"># offsets compensant les coords globales du parent</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pgx</span><span class="p">,</span> <span class="n">pgy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_global_coords</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="n">pgx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="n">pgy</span>
        <span class="c1"># mémorisation avant snap :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">aftersnap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsnapped_publicationRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Tests :</span>
        <span class="n">test_dims</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">!=</span> <span class="n">olddims</span>
        <span class="n">test_coords</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="n">oldcoords</span>
        <span class="k">if</span> <span class="n">test_dims</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRect_dims_changed</span><span class="p">(</span><span class="n">aftersnap</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">test_coords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_publicationRect_coords_changed</span><span class="p">(</span><span class="n">aftersnap</span><span class="p">)</span>
        <span class="c1"># retour :</span>
        <span class="k">return</span> <span class="n">test_dims</span> <span class="ow">or</span> <span class="n">test_coords</span></div>

<div class="viewcode-block" id="BoxModelObject.on_publicationRect_dims_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_publicationRect_dims_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les dimensions (et éventuellement</span>
<span class="sd">        les coords) de publicationRect ont été modifiées</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; on_publicationRect_dims_changed rect=&quot;,self.publicationRect)</span>
        <span class="c1"># Force la mise à jour des rects internes (contenu et fond) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="c1"># invalide la référence absolue exacte</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">()</span>
        <span class="c1"># display :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

<div class="viewcode-block" id="BoxModelObject.on_publicationRect_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.on_publicationRect_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les coordonnées seules</span>
<span class="sd">        de publicationRect ont été modifiées (pas les dimensions).</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; on_publicationRect_coords_changed rect=&quot;,self.publicationRect)</span>
        <span class="c1"># Force la mise à jour des rects internes (contenu et fond) :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="c1"># invalide la référence absolue exacte</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">()</span>
        <span class="c1"># display :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Gestion générique du snap pour un objet terminal</span>
<div class="viewcode-block" id="BoxModelObject.handle_item_snap"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.handle_item_snap">[docs]</a>    <span class="k">def</span> <span class="nf">handle_item_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_width</span><span class="p">,</span> <span class="n">content_height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implémentation du snap pour un item terminal.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            content_width (int): largeur du contenu auquel s&#39;adapter</span>
<span class="sd">            content_height (int): hauteur du contenu auquel s&#39;adapter</span>
<span class="sd">            </span>
<span class="sd">        Met à jour self.publicationRect.</span>
<span class="sd">        A appeler au besoin dans une subclasse (texte, image).</span>
<span class="sd">        </span>
<span class="sd">        Returns: </span>
<span class="sd">            boolean indiquant si un changement a été apporté.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">content_width</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content_height</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span>
        <span class="p">):</span>
            <span class="c1"># recalcul des dimensions :</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">margin</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapW</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">content_width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_metric_value</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snapH</span><span class="p">:</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">content_height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_metric_value</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="c1"># test de modification :</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">),</span>
            <span class="p">):</span>
                <span class="n">change</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># mise à jour des coordonnées :</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">!=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compute_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="p">)</span>
                <span class="c1"># puis de publicationRect :</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_publicationRect</span><span class="p">(</span><span class="n">aftersnap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; &gt; handlesnap change=&quot;,change,&quot; =&gt; self.rect=&quot;,self.rect)</span>
        <span class="k">return</span> <span class="n">change</span></div>

    <span class="c1">#-----&gt; Layout imposé par le flow parent:</span>
<div class="viewcode-block" id="BoxModelObject.apply_parent_layout"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.apply_parent_layout">[docs]</a>    <span class="k">def</span> <span class="nf">apply_parent_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique le layout imposé par le conteneur parent</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            prop (str): &quot;x&quot; ou &quot;y&quot;</span>
<span class="sd">            val (int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oldval</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">oldval</span> <span class="o">!=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
            <span class="c1"># mise à jour des coords :</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pos_coords</span><span class="p">()</span>
            <span class="c1"># Force la mise à jour des rects internes (contenu et fond) :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
            <span class="c1"># invalide la référence absolue exacte</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">()</span>
        <span class="c1"># [Keep for debug] print(&quot;BMO|&quot;,self.name,&quot; apply_parent_layout change=&quot;,change)</span>
        <span class="k">return</span> <span class="n">change</span></div>

    <span class="c1">#-----&gt; Déplacement local sans modification des metrics xabs et yabs</span>
<div class="viewcode-block" id="BoxModelObject.place"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.place">[docs]</a>    <span class="k">def</span> <span class="nf">place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Positionne l&#39;objet aux coordonnées locales x, y sans modifier les métrics,</span>
<span class="sd">        modifie directement self.publicationRect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">y</span>
        <span class="c1"># invalide le display :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

<div class="viewcode-block" id="BoxModelObject.move"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique le décallage dx, dy aux coordonnées locales x, y sans modifier les métrics,</span>
<span class="sd">        modifie directement self.publicationRect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">dy</span>
        <span class="c1"># invalide le display :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Indicateur de changement de rendu :</span>
<div class="viewcode-block" id="BoxModelObject.discard_placement"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_placement">[docs]</a>    <span class="k">def</span> <span class="nf">discard_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        La position a été modifiée, le rendu graphique dans la surface de publication</span>
<span class="sd">        du RealContainer assurant la publication n&#39;est plus valable. Par contre le rendu</span>
<span class="sd">        &quot;local&quot; de cet objet reste valide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_pos_coords</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">change</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_placement_discarded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.discard_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.discard_display">[docs]</a>    <span class="k">def</span> <span class="nf">discard_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        La position, les dimensions ou les rects internes (le contenu pour des subclasses)</span>
<span class="sd">        ont été modifiés, le rendu graphique n&#39;est plus valable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_display_discarded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoxModelObject.draw_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoxModelObject.html#labpyproject.core.pygame.core.BoxModelObject.draw_display">[docs]</a>    <span class="k">def</span> <span class="nf">draw_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dessinne ou redessinne l&#39;objet.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
        <span class="c1"># à subclasser</span>

    <span class="c1">#-----&gt; Debug</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span></div>


<div class="viewcode-block" id="MetricValue"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html#labpyproject.core.pygame.core.MetricValue">[docs]</a><span class="k">class</span> <span class="nc">MetricValue</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Donnée de box model numérique pouvant être exprimée en pixel ou en pourcentage.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># propriété statique :</span>
    <span class="n">REGEXP_INT</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="s2">&quot;0</span><span class="si">{1}</span><span class="s2">|^[1-9]</span><span class="si">{1}</span><span class="s2">[0-9]*&quot;</span>
    <span class="p">)</span>  <span class="c1">#: expression régulière de reconnaissance d&#39;un int</span>
    <span class="c1"># méthode statique :</span>
<div class="viewcode-block" id="MetricValue.parseMetric"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html#labpyproject.core.pygame.core.MetricValue.parseMetric">[docs]</a>    <span class="k">def</span> <span class="nf">parseMetric</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une donnée et retourne un objet MetricValue (par défaut value=0, percent=False)</span>
<span class="sd">        ou None.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            val: int ou str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">percent</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;%&quot;</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">val</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">):</span>
                <span class="n">percent</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MetricValue</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="n">percent</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="n">parseMetric</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">parseMetric</span><span class="p">)</span>
    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur :</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            value : valeur numérique</span>
<span class="sd">            percent : bool</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">percent</span>
        <span class="c1"># dernière valeur calculée :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

<div class="viewcode-block" id="MetricValue.get_value"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html#labpyproject.core.pygame.core.MetricValue.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la valeur de la donnée, en prenant pour référence refvalue si</span>
<span class="sd">        la donnée est en pourcentage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">refvalue</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># passe d&#39;actualisation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">refvalue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_computedvalue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span></div>

<div class="viewcode-block" id="MetricValue.get_computedvalue"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html#labpyproject.core.pygame.core.MetricValue.get_computedvalue">[docs]</a>    <span class="k">def</span> <span class="nf">get_computedvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la valeur calculée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span></div>

<div class="viewcode-block" id="MetricValue.set_computedvalue"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.MetricValue.html#labpyproject.core.pygame.core.MetricValue.set_computedvalue">[docs]</a>    <span class="k">def</span> <span class="nf">set_computedvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre la valeur calculée en dehors de ce metric.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span> <span class="o">=</span> <span class="n">val</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opérateur de comparaison.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MetricValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">percent</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># debug</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;[Metric :value=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; percent=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">percent</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; lastcomputedvalue=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;] &quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BoundedMetricValue"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue">[docs]</a><span class="k">class</span> <span class="nc">BoundedMetricValue</span><span class="p">(</span><span class="n">MetricValue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **MetricValue avec bornes min et max.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># propriétés statiques</span>
    <span class="n">DEFAULT_MIN</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">#: borne min par défaut</span>
    <span class="n">DEFAULT_MAX</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1">#: borne max par défaut</span>
    <span class="c1"># méthode statique :</span>
<div class="viewcode-block" id="BoundedMetricValue.parseMetric"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue.parseMetric">[docs]</a>    <span class="k">def</span> <span class="nf">parseMetric</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">minvalue</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une donnée et retourne un objet BoundedMetricValue (par défaut value=0, percent=False)</span>
<span class="sd">        ou None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bmv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mv</span> <span class="o">=</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">parseMetric</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mv</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bmv</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="p">(</span>
                <span class="n">mv</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="n">mv</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span> <span class="n">minvalue</span><span class="o">=</span><span class="n">minvalue</span><span class="p">,</span> <span class="n">maxvalue</span><span class="o">=</span><span class="n">maxvalue</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bmv</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bmv</span></div>

    <span class="n">parseMetric</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">parseMetric</span><span class="p">)</span>

<div class="viewcode-block" id="BoundedMetricValue.parse_bound"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue.parse_bound">[docs]</a>    <span class="k">def</span> <span class="nf">parse_bound</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse une valeur de borne.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">MetricValue</span><span class="o">.</span><span class="n">REGEXP_INT</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>

    <span class="n">parse_bound</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">parse_bound</span><span class="p">)</span>
    <span class="c1"># méthodes :</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur :</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            value : valeur numérique</span>
<span class="sd">            percent : bool</span>
<span class="sd">            minvalue : int (o par défaut)</span>
<span class="sd">            maxvalue : int (100000 par défaut)        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">MetricValue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># valeurs déja parsées</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">percent</span>
        <span class="c1"># bornes :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">DEFAULT_MIN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">DEFAULT_MAX</span>
        <span class="k">if</span> <span class="n">minvalue</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">minvalue</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">maxvalue</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bound</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">)</span>
        <span class="c1"># dernière valeur calculée :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_computedvalue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BoundedMetricValue.get_bound"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue.get_bound">[docs]</a>    <span class="k">def</span> <span class="nf">get_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Getter de borne (prop = min ou max)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span>
        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BoundedMetricValue.set_bound"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue.set_bound">[docs]</a>    <span class="k">def</span> <span class="nf">set_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter de borne (prop = min ou max)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">realval</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">parse_bound</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">realval</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">realval</span>
            <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">realval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">DEFAULT_MIN</span>
            <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">BoundedMetricValue</span><span class="o">.</span><span class="n">DEFAULT_MAX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_computedvalue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span><span class="p">)</span></div>

<div class="viewcode-block" id="BoundedMetricValue.set_computedvalue"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.BoundedMetricValue.html#labpyproject.core.pygame.core.BoundedMetricValue.set_computedvalue">[docs]</a>    <span class="k">def</span> <span class="nf">set_computedvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre la valeur calculée en dehors de ce metric : prise en compte des bornes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lastcomputedvalue</span> <span class="o">=</span> <span class="n">val</span></div></div>


<div class="viewcode-block" id="VirtualItem"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem">[docs]</a><span class="k">class</span> <span class="nc">VirtualItem</span><span class="p">(</span><span class="n">BoxModelObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **BoxModelObject supportant les attributs de gestion des z-indexs (couches) ainsi que</span>
<span class="sd">    les propriétés et méthodes de base de la logique de publication.**</span>

<span class="sd">    Virtual indique que cet objet n&#39;a pas de surface propre (au sens pygame) et qu&#39;il n&#39;est pas</span>
<span class="sd">    un objet de publication réel.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur :</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs : peut contenir local_layer ainsi que toutes les propriétés de boxing </span>
<span class="sd">                supportées par BoxModelObject.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Indique si l&#39;objet contient une hiérarchie de couches internes à</span>
        <span class="c1"># prendre en charge par un RealContainer parent.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_stacked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Niveau d&#39;imbrication dans la hiérarchie globale :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># ordre de publication :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publication_order</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># l&#39;item a t&#39;il déja été publié?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prevpublished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># appartenance à la displaylist finale :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_added_to_displaylist</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># visibilité (indicatif uniquement)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># layers :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_layers</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les paramètres liés au z-index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># layer locale / VirtualContainer parent :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;local_layer&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_layer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;local_layer&quot;</span><span class="p">])</span>
        <span class="c1"># layer de publication / LayeredDisplay :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># layer globale / root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer_updated</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="VirtualItem.parse_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.parse_layer">[docs]</a>    <span class="k">def</span> <span class="nf">parse_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse l&#39;attribut local_layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1">#-----&gt; Hiérarchie : niveau</span>
    <span class="k">def</span> <span class="nf">_get_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Niveau de l&#39;objet dans la hiérarchie.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span>

    <span class="k">def</span> <span class="nf">_set_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">level</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_level</span><span class="p">,</span> <span class="n">_set_level</span>
    <span class="p">)</span>  <span class="c1">#: Niveau d&#39;imbrication de l&#39;objet dans la hiérarchie.</span>

    <span class="c1">#-----&gt; Gestion de la profondeur (2.5 D) : couches locale et globale</span>
    <span class="k">def</span> <span class="nf">_get_local_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Couche locale par rapport au container parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_layer</span>

    <span class="k">def</span> <span class="nf">_set_local_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_layer</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_local_layer</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">local_layer</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_local_layer</span><span class="p">,</span> <span class="n">_set_local_layer</span>
    <span class="p">)</span>  <span class="c1">#: Couche locale par rapport au container parent</span>

    <span class="k">def</span> <span class="nf">_get_publication_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Couche de publication dans le RealContainer assurant le display de cet objet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publication_layer</span>

    <span class="k">def</span> <span class="nf">_set_publication_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_layer</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer_updated</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">publication_layer</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_publication_layer</span><span class="p">,</span> <span class="n">_set_publication_layer</span>
    <span class="p">)</span>  <span class="c1">#: Couche de publication dans le RealContainer assurant le display de cet objet.</span>

    <span class="k">def</span> <span class="nf">_get_global_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Couche globale par rapport au Root.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer_updated</span><span class="p">:</span>
            <span class="c1"># par défaut il s&#39;agit de la couche de publication</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publication_layer</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">p</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">RealContainer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span><span class="p">:</span>
                        <span class="c1"># la couche globale équivaut alors au RealContainer</span>
                        <span class="c1"># de plus haut niveau (root excepté)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">publication_layer</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer_updated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span>

    <span class="k">def</span> <span class="nf">_set_global_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">global_layer</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_global_layer</span><span class="p">,</span> <span class="n">_set_global_layer</span>
    <span class="p">)</span>  <span class="c1">#: Couche globale par rapport au Root.</span>

<div class="viewcode-block" id="VirtualItem.discard_layers"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.discard_layers">[docs]</a>    <span class="k">def</span> <span class="nf">discard_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide les couches globales et de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_layer_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_get_is_stacked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si l&#39;objet contient une hiérarchie de couches internes à</span>
<span class="sd">        prendre en charge par un RealContainer parent.</span>
<span class="sd">        Toujours faux pour un VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stacked</span>

    <span class="k">def</span> <span class="nf">_set_is_stacked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_stacked</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">is_stacked</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_is_stacked</span><span class="p">,</span> <span class="n">_set_is_stacked</span>
    <span class="p">)</span>  <span class="c1">#: Indique si l&#39;objet contient une hiérarchie de couches internes à prendre en charge par un RealContainer parent (Toujours faux pour un VirtualItem).</span>

    <span class="c1">#-----&gt; Visibilité :</span>
    <span class="k">def</span> <span class="nf">_get_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Visibilité (bool).&quot;&quot;&quot;</span>
        <span class="c1"># implémenté dans la subclasse CustomSprite</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span>

    <span class="k">def</span> <span class="nf">_set_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="c1"># implémenté dans la subclasse CustomSprite</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_visibility_changed</span><span class="p">()</span>

    <span class="n">visible</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_visible</span><span class="p">,</span> <span class="n">_set_visible</span><span class="p">)</span>  <span class="c1">#: Visibilité (bool)</span>

<div class="viewcode-block" id="VirtualItem.on_visibility_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_visibility_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_visibility_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque self.visible a été modifié.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1">#-----&gt; Logique de publication :</span>
<div class="viewcode-block" id="VirtualItem.on_item_added"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_item_added">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_added</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par le container parent lorsque l&#39;item est ajouté</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">level</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VirtualItem.on_item_removed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_item_removed">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par le container parent lorsque l&#39;item est supprimé</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.parent = None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># self.re_initialise_rects()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_layers</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualItem.on_parent_removed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_parent_removed">[docs]</a>    <span class="k">def</span> <span class="nf">on_parent_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagé si un parent a été supprimé sans que celui ci ne supprime sa hiérarchie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># invalide le display :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span>
        <span class="c1"># et les couches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_layers</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualItem.update"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée à chaque frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="VirtualItem.on_item_added_to_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_item_added_to_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_added_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;item (via sa hiérarchie parente) est publié par</span>
<span class="sd">        le root dans la displaylist finale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_added_to_displaylist</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualItem.on_item_removed_from_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.on_item_removed_from_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_removed_from_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;item (via sa hiérarchie parente) est dé-publié par</span>
<span class="sd">        le root de la displaylist finale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_added_to_displaylist</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="VirtualItem.belong_to_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.belong_to_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">belong_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si l&#39;objet appartient à la displaylist finale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_added_to_displaylist</span></div>

    <span class="k">def</span> <span class="nf">_get_publication_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ordre de publication.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publication_order</span>

    <span class="k">def</span> <span class="nf">_set_publication_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_order</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">publication_order</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_publication_order</span><span class="p">,</span> <span class="n">_set_publication_order</span>
    <span class="p">)</span>  <span class="c1">#: Ordre de publication.</span>
    <span class="c1">#-----&gt; Propagation d&#39;événement</span>
<div class="viewcode-block" id="VirtualItem.fire_event"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.fire_event">[docs]</a>    <span class="k">def</span> <span class="nf">fire_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dispatch l&#39;événement evt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span></div>

    <span class="c1">#-----&gt;  Infos</span>
<div class="viewcode-block" id="VirtualItem.get_framerate"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualItem.html#labpyproject.core.pygame.core.VirtualItem.get_framerate">[docs]</a>    <span class="k">def</span> <span class="nf">get_framerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le framerate de l&#39;application.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span><span class="o">.</span><span class="n">framerate</span>
        <span class="k">return</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="VirtualContainer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer">[docs]</a><span class="k">class</span> <span class="nc">VirtualContainer</span><span class="p">(</span><span class="n">VirtualItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **VirtualItem dôté des capacités d&#39;un conteneur :**</span>
<span class="sd">    </span>
<span class="sd">    * publication : ajout / suppression d&#39;objets enfants</span>
<span class="sd">    * propagation du resize aux objets enfants</span>
<span class="sd">    * layouts basiques : via la propriété direction :</span>
<span class="sd">    </span>
<span class="sd">        - direction = None : layout absolu (canvas), cas par défaut</span>
<span class="sd">        - direction = &quot;horizontal&quot; : layout des éléments de position fixed ou absolute selon </span>
<span class="sd">          l&#39;axe x</span>
<span class="sd">        - direction = &quot;vertical&quot; : respectivement selon l&#39;axe y</span>

<span class="sd">    Virtual indique que cet objet n&#39;a pas de surface propre (au sens pygame). Comme VirtualItem </span>
<span class="sd">    il ne s&#39;agit pas d&#39;un objet de publication réel. Par contre il s&#39;inscrit dans la gestion </span>
<span class="sd">    générique des couches et de la publication. Sa descendance sera publié réellement par </span>
<span class="sd">    un RealContainer parent (Root par défaut).</span>
<span class="sd">    </span>
<span class="sd">    Todo:</span>
<span class="sd">        Support de la visibilité, actuellement effectif uniquement pour les composants disposant </span>
<span class="sd">        d&#39;une surface de publication.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># statique :</span>
    <span class="n">DIRECTION_HORIZONTAL</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: valeurs de direction équivalentes</span>
    <span class="n">DIRECTION_VERTICAL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>  <span class="c1">#: valeurs de direction équivalentes</span>
    <span class="n">DIRECTION_ATTR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DIRECTION_HORIZONTAL</span><span class="p">,</span>
        <span class="n">DIRECTION_VERTICAL</span><span class="p">,</span>
    <span class="p">]</span>  <span class="c1">#: valeurs de direction possibles</span>
    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            bgcolor (str): couleur héxa</span>
<span class="sd">            **kwargs : peut contenir direction ainsi que toutes les propriétés de VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># liste de tous les items (VirtualItem et VirtualContainer)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># liste des enfants à ajouter :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># liste des enfants à supprimer :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># listes des enfants sujets au layout ou non, au flex, au snap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># childs fixed (hors flow)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># childs absolute (hors flow)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># tous les childs in flow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># childs in flow avec flex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unflexchildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># childs in flow sans flex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># indicateur de mise à jour des surfaces alouées</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allocated_area_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># indicateur de mise à jour de layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># indicateur de mise à jour de snap :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># layout basique : direction (layout absolu par défaut)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_direction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># générique :</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Couches internes à publier par un RealContainer parent : oui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_stacked</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># visibilité :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visible</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># fond</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># couleur de fond :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># affectation couleur et création du fond au besoin :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span> <span class="o">=</span> <span class="n">bgcolor</span>
        <span class="c1"># debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de boxmodel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="n">direct</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;direction&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;direction&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">,</span>
            <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">direct</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;direction&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direct</span>

    <span class="k">def</span> <span class="nf">_init_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les paramètres liés au z-index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="n">_init_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># couche locale par défaut :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_layer</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">#-----&gt; Direction de layout</span>
<div class="viewcode-block" id="VirtualContainer.parse_direction"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.parse_direction">[docs]</a>    <span class="k">def</span> <span class="nf">parse_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse l&#39;attribut direction</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            val (str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">val</span> <span class="ow">in</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span>
            <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span>
        <span class="p">):</span>
            <span class="n">rval</span> <span class="o">=</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">val</span> <span class="ow">in</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span>
            <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span>
        <span class="p">):</span>
            <span class="n">rval</span> <span class="o">=</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span>
        <span class="k">return</span> <span class="n">rval</span></div>

    <span class="k">def</span> <span class="nf">_get_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Direction de layout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_direction</span>

    <span class="k">def</span> <span class="nf">_set_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_direction</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_direction</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_direction</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_direction_changed</span><span class="p">()</span>

    <span class="n">direction</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_direction</span><span class="p">,</span> <span class="n">_set_direction</span>
    <span class="p">)</span>  <span class="c1">#: Direction de layout (None par défaut)</span>

<div class="viewcode-block" id="VirtualContainer.on_direction_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_direction_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_direction_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque la propriété direction a été modifiée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout_list</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Fond</span>
<div class="viewcode-block" id="VirtualContainer.create_background"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.create_background">[docs]</a>    <span class="k">def</span> <span class="nf">create_background</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée un CustomSprite de fond si bgcolor != None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">CustomSprite</span><span class="p">(</span>
                <span class="n">bgcolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span><span class="p">,</span>
                <span class="n">position</span><span class="o">=</span><span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_ABSOLUTE</span><span class="p">,</span>
                <span class="n">local_layer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_bg&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.resize_background"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.resize_background">[docs]</a>    <span class="k">def</span> <span class="nf">resize_background</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resize le fond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bgrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_border_rect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">bgrect</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.update_backround_coords"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.update_backround_coords">[docs]</a>    <span class="k">def</span> <span class="nf">update_backround_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour les coordonnées du rect de publication du fond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bgrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_border_rect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">update_publicationRefRect_coords</span><span class="p">(</span><span class="n">bgrect</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bgrect</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Couleur de fond (str héxa) convertie au format pygame.Color.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span>

    <span class="k">def</span> <span class="nf">_set_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_bgcolor_changed</span><span class="p">()</span>

    <span class="n">bgcolor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_bgcolor</span><span class="p">,</span> <span class="n">_set_bgcolor</span>
    <span class="p">)</span>  <span class="c1">#: Couleur de fond (str héxa) convertie au format pygame.Color.</span>

<div class="viewcode-block" id="VirtualContainer.on_bgcolor_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_bgcolor_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_bgcolor_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque la couleur de fond a été modifiée.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">bgcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_background</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Rect global de référence</span>
<div class="viewcode-block" id="VirtualContainer.discard_globalRect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.discard_globalRect">[docs]</a>    <span class="k">def</span> <span class="nf">discard_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide la position globale absolue exacte</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># propagation :</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">discard_globalRect</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Layout imposé par le flow parent:</span>
<div class="viewcode-block" id="VirtualContainer.apply_parent_layout"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.apply_parent_layout">[docs]</a>    <span class="k">def</span> <span class="nf">apply_parent_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique le layout imposé par le conteneur parent</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            prop (str): &quot;x&quot; ou &quot;y&quot;</span>
<span class="sd">            val (int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">apply_parent_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; apply_parent_layout prop, val=&quot;,prop, val,&quot; change=&quot;,change)</span>
        <span class="c1"># spécifique :</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
            <span class="c1"># invaide le layout des childs :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Update</span>
<div class="viewcode-block" id="VirtualContainer.update"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée à chaque frame: gestion du resize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Resize au besoin :</span>
        <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
        <span class="c1"># propagation :</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">change</span></div>

    <span class="c1">#-----&gt; Resize</span>
<div class="viewcode-block" id="VirtualContainer.resize"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.resize">[docs]</a>    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalcul de la taille et de la position</span>
<span class="sd">        </span>
<span class="sd">        * direction : None (canvas), horizontal (liste h), vertical (liste v)</span>
<span class="sd">        * si direction != None : prise en compte des attributs flex des childs</span>
<span class="sd">        * snapW (boolean) : si True le container définit sa largeur par rapport à son contenu</span>
<span class="sd">        * snapH (boolean) : si True le container définit sa hauteur par rapport à son contenu</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;\nVC|&quot;,self.name,&quot; resize self.resize_count=&quot;,self.resize_count,&quot; ...&quot;)</span>
        <span class="c1"># Maj des listes de childs :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_layout_list</span><span class="p">()</span>
        <span class="c1"># générique :</span>
        <span class="n">resized</span> <span class="o">=</span> <span class="n">VirtualItem</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Container :</span>
        <span class="c1"># 1- Redéfinition de la surface alouée et resize des childs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allocated_area_updated</span><span class="p">:</span>
            <span class="c1"># Update complet</span>
            <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; update_childs rect=&quot;,self.rect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_childs</span><span class="p">()</span>
        <span class="c1"># optimisation : si le rect de contenu est &quot;nul&quot;, inutile de poursuivre le process.</span>
        <span class="c1"># Rq : les rects internes ont put être mis à jour dans update_childs,</span>
        <span class="c1"># c&#39;est pourquoi on fait ce test ensuite.</span>
        <span class="n">contentRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># 2- Layout :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span><span class="p">:</span>
            <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; layout_childs rect=&quot;,self.rect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout_childs</span><span class="p">()</span>
        <span class="c1"># 3- Snap éventuel :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span><span class="p">:</span>
            <span class="c1"># Adaptation au contenu :</span>
            <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; handle_snap rect=&quot;,self.rect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_snap</span><span class="p">()</span>
        <span class="c1"># Indicateur de fin de resize pour post traitement :</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; fin resize : self.is_resized =&quot;,self.is_resized)</span>
        <span class="k">if</span> <span class="n">resized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_resize_achieved</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">resized</span></div>

<div class="viewcode-block" id="VirtualContainer.mark_container_as_resized"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.mark_container_as_resized">[docs]</a>    <span class="k">def</span> <span class="nf">mark_container_as_resized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        En cas de resize personnalisé, re valide tous les marqueurs de resize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_resized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allocated_area_updated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualContainer.on_publicationRefRect_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_publicationRefRect_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRefRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque les coordonnées du rect de publication de référence</span>
<span class="sd">        (self._publicationRefRect) ont été modifiées (mais pas les dimensions).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">on_publicationRefRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># propagation aux childs :</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="n">fulllist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span>
        <span class="c1"># fond :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_backround_coords</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fulllist</span> <span class="o">=</span> <span class="n">fulllist</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># childs standards :</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fulllist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">!=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">update_publicationRefRect_coords</span><span class="p">(</span><span class="n">cr</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cr</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">on_fixed_child_parent_coords_changed</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_publicationRect_dims_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_publicationRect_dims_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les dimensions (et éventuellement</span>
<span class="sd">        les coords) de publicationRect ont été modifiées</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; on_publicationRect_dims_changed&quot;)</span>
        <span class="c1"># invalidation des rects internes et du display :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">on_publicationRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">)</span>
        <span class="c1"># box model conteneur :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">aftersnap</span><span class="p">:</span>
            <span class="c1"># invalidation des surfaces alouées :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_allocated_area</span><span class="p">()</span>
            <span class="c1"># de l&#39;éventuel snap :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span>
        <span class="c1"># du layout :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_publicationRect_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_publicationRect_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les coordonnées seules</span>
<span class="sd">        de publicationRect ont été modifiées (pas les dimensions).</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; on_publicationRect_coords_changed&quot;)</span>
        <span class="c1"># invalidation des rects internes et du display :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">on_publicationRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">)</span>
        <span class="c1"># invalidation du layout :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_resize_achieved"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_resize_achieved">[docs]</a>    <span class="k">def</span> <span class="nf">on_resize_achieved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée à la fin du process de resize de VirtualContainer pour post traitement éventuel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># à subclasser au besoin</span>
        <span class="k">pass</span></div>

    <span class="c1">#-----&gt; Pseudos événements émis par les childs affectant le process de resize</span>
<div class="viewcode-block" id="VirtualContainer.on_child_unresized"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_unresized">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_unresized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsqu&#39;un child n&#39;est plus resizé.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (BoxModelObject)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">child</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">:</span>
            <span class="c1"># [Keep for debug] print(&quot;VC[&quot;,self.name,&quot; on_child_unresized child=&quot;,child.name, &quot; has_flex=&quot;,self.has_flexible_childs())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">child</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_flexible_childs</span><span class="p">()</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">flex</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># update complet nécessaire</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_allocated_area</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_child_placement_discarded"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_placement_discarded">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_placement_discarded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des discard d&#39;update jusqu&#39;au prochain RealContainer.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (BoxModelObject)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC[&quot;,self.name,&quot; on_child_placement_discarded child=&quot;,child.name)</span>
        <span class="k">if</span> <span class="n">child</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_child_position_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_position_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_position_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par un child dont l&#39;attribut position a été modifié.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (BoxModelObject)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout_list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_child_flex_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_flex_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_flex_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par un child dont l&#39;attribut flex a été modifié.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (BoxModelObject)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout_list</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">in_flow</span><span class="p">:</span>
                <span class="c1"># update complet nécessaire</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_allocated_area</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_child_snap_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_snap_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_snap_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par un child dont l&#39;attribut snap a été modifié.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (BoxModelObject)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Update_childs :</span>
<div class="viewcode-block" id="VirtualContainer.update_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.update_childs">[docs]</a>    <span class="k">def</span> <span class="nf">update_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Redéfinition systématique de la surface alouée à chaque child et appel</span>
<span class="sd">        à sa méthode resize (recalcul au besoin).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; update_childs contentRect=&quot;,self.get_content_rect())</span>
        <span class="c1"># listes de childs :</span>
        <span class="n">abs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span>
        <span class="n">fixed_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span>
        <span class="n">unflex_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unflexchildlist</span>
        <span class="n">flex_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span>
        <span class="c1"># surface alouée de référence</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
            <span class="c1"># on repart de la version initiale du rect de publication :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsnapped_publicationRect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
        <span class="n">contentRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">w</span> <span class="o">*</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">rootRect</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rootRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="c1"># 1- Resize des childs hors flow (absolute ou fixed) :</span>
        <span class="c1"># - fixed :</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fixed_list</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">rootRect</span>
            <span class="n">child</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
        <span class="c1"># - absolute :</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">abs_list</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">contentRect</span>
            <span class="n">child</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
        <span class="c1"># 2- Resize des childs in flow non flexibles</span>
        <span class="n">unflexspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">unflex_list</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">contentRect</span>
            <span class="n">child</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">:</span>
                <span class="n">unflexspace</span> <span class="o">+=</span> <span class="n">child</span><span class="o">.</span><span class="n">width</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span><span class="p">:</span>
                <span class="n">unflexspace</span> <span class="o">+=</span> <span class="n">child</span><span class="o">.</span><span class="n">height</span>
        <span class="c1"># 3- Resize des childs in flow flexibles :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">:</span>
                <span class="n">flexspace</span> <span class="o">=</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">unflexspace</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_VERTICAL</span><span class="p">:</span>
                <span class="n">flexspace</span> <span class="o">=</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">unflexspace</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flex_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">totalflex</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">flex_list</span><span class="p">:</span>
                    <span class="n">totalflex</span> <span class="o">+=</span> <span class="n">child</span><span class="o">.</span><span class="n">flex</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">flex_list</span><span class="p">:</span>
                    <span class="n">childspace</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">flex</span> <span class="o">/</span> <span class="n">totalflex</span> <span class="o">*</span> <span class="n">flexspace</span><span class="p">)</span>
                    <span class="n">contentRectCopy</span> <span class="o">=</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">:</span>
                        <span class="n">contentRectCopy</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">childspace</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">contentRectCopy</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">childspace</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">contentRectCopy</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">resize</span><span class="p">()</span>
        <span class="c1"># 4- Eventuel fond :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_background</span><span class="p">()</span>
        <span class="c1"># validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allocated_area_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualContainer.discard_allocated_area"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.discard_allocated_area">[docs]</a>    <span class="k">def</span> <span class="nf">discard_allocated_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide la mise à jour des surfaces alouées aux childs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; discard_allocated_area !&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allocated_area_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="VirtualContainer.has_flexible_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.has_flexible_childs">[docs]</a>    <span class="k">def</span> <span class="nf">has_flexible_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si un ou plusieurs childs sont flexibles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Maj des listes de childs :</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_layout_list</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span></div>

    <span class="c1">#-----&gt; Layout :</span>
<div class="viewcode-block" id="VirtualContainer.layout_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.layout_childs">[docs]</a>    <span class="k">def</span> <span class="nf">layout_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique le layout basique (si direction != None) aux childs de position fixed ou relative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;VC|&quot;,self.name,&quot; layout_childs :&quot;)</span>
        <span class="c1"># 1- Mise à jour des coords de référence :</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
        <span class="n">fulllist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span>
        <span class="c1"># fond :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_backround_coords</span><span class="p">()</span>
        <span class="c1"># childs standards (hors fixed / ref 0,0 immuable)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fulllist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">!=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">update_publicationRefRect_coords</span><span class="p">(</span><span class="n">cr</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cr</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="c1"># 2- Flux de layout :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">DIRECTION_HORIZONTAL</span><span class="p">:</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="s2">&quot;width&quot;</span>
            <span class="n">dyn_coord</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="s2">&quot;height&quot;</span>
            <span class="n">dyn_coord</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dyn_val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">apply_parent_layout</span><span class="p">(</span><span class="n">dyn_coord</span><span class="p">,</span> <span class="n">dyn_val</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
            <span class="c1"># [Keep for debug] print(&quot; * layout child=&quot;,child.name,&quot; x=&quot;,child.x,&quot; y=&quot;,child.y,&quot; w=&quot;,child.width,&quot; h=&quot;,child.height)</span>
            <span class="n">dyn_val</span> <span class="o">+=</span> <span class="n">delta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualContainer.discard_layout"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.discard_layout">[docs]</a>    <span class="k">def</span> <span class="nf">discard_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide le layout des childs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout_updated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="VirtualContainer.discard_layout_list"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.discard_layout_list">[docs]</a>    <span class="k">def</span> <span class="nf">discard_layout_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide les listes de childs liées au layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="VirtualContainer.update_layout_list"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.update_layout_list">[docs]</a>    <span class="k">def</span> <span class="nf">update_layout_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconstitue les listes de childs liées au layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fulllist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fulllist</span> <span class="o">=</span> <span class="n">fulllist</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">fullset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fulllist</span><span class="p">)</span>
        <span class="c1"># childs en position fixed :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fulllist</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span>
        <span class="p">]</span>
        <span class="c1"># pas de flux de layout</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">absset</span> <span class="o">=</span> <span class="n">fullset</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">absset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unflexchildlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>
        <span class="c1"># flux de layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unflexchildlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">dosort</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fulllist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">,</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">publication_order</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dosort</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">flex</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">flexchildlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unflexchildlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_ABSOLUTE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dosort</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">childtolayout</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;publication_order&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layoutlistupdated</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="c1">#-----&gt; Snap :</span>
<div class="viewcode-block" id="VirtualContainer.handle_snap"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.handle_snap">[docs]</a>    <span class="k">def</span> <span class="nf">handle_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prise en charge des snaps à la fin du process de resize : pour éviter un bouclage </span>
<span class="sd">        sans fin du process on recalcule les rects en repositionnant au besoin les childs, </span>
<span class="sd">        sans les re resizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">childlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_snap_childs</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># surface du contenu :</span>
            <span class="n">child0</span> <span class="o">=</span> <span class="n">childlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">unionrect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">unionrect</span> <span class="o">=</span> <span class="n">child0</span><span class="o">.</span><span class="n">rect</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rectseq</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">rect</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">childlist</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="n">unionrect</span> <span class="o">=</span> <span class="n">child0</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">unionall</span><span class="p">(</span><span class="n">rectseq</span><span class="p">)</span>
            <span class="n">cw</span><span class="p">,</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">unionrect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">unionrect</span><span class="o">.</span><span class="n">height</span>
            <span class="k">if</span> <span class="n">cw</span> <span class="o">*</span> <span class="n">ch</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ox</span><span class="p">,</span> <span class="n">oy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                <span class="c1"># générique :</span>
                <span class="n">change</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">handle_item_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cw</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                    <span class="c1"># invalidation des rects internes :</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_inner_rects</span><span class="p">()</span>
                    <span class="c1"># deltas de coordonnées :</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">ox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">oy</span>
                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childlist</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">!=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
                            <span class="n">child</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span>
                            <span class="n">child</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">dy</span>
                    <span class="c1"># Indicateur de modification post resize (pour adaptation d&#39;un fond par ex)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">on_snap_occured</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualContainer.discard_snap"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.discard_snap">[docs]</a>    <span class="k">def</span> <span class="nf">discard_snap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide l&#39;éventuel calcul de snap.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_snap</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_snap_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="VirtualContainer.get_snap_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.get_snap_childs">[docs]</a>    <span class="k">def</span> <span class="nf">get_snap_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste des childs à prendre en compte pour les calculs de snap sauf le fond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">childlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">childlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">childlist</span></div>

<div class="viewcode-block" id="VirtualContainer.on_snap_occured"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_snap_occured">[docs]</a>    <span class="k">def</span> <span class="nf">on_snap_occured</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique que self.publicationRect.width et/ou self.publicationRect.height ont été modifiées</span>
<span class="sd">        lors du process de resize par application d&#39;un snap (adaptation au contenu).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Resize de l&#39;éventuel fond :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_background</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Publication :</span>
<div class="viewcode-block" id="VirtualContainer.add_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.add_item">[docs]</a>    <span class="k">def</span> <span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajout d&#39;un ou plusieurs item(s) virtuel(s).</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            childs (list): liste de VirtualItem(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># gestion de la liste des items enfants</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="c1"># configuration :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure_child_added</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="c1"># liste de publication :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="c1"># publication :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.configure_child_added"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.configure_child_added">[docs]</a>    <span class="k">def</span> <span class="nf">configure_child_added</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configuration au moment de l&#39;ajout du child.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (VirtualItem)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
            <span class="c1"># logique de publication</span>
            <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_item_added</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># layer :</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">local_layer</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">local_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_layer</span>
            <span class="c1"># boxmodel :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">,</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="c1"># in flow : discards nécessaires</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_allocated_area</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_snap</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout_list</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># hors flow : mise à jour du seul child</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
                    <span class="n">rootRect</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">rootRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_reference</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
                    <span class="c1"># surface alouée</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">rootRect</span>
                    <span class="c1"># maj de la liste de childs associée :</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># surface alouée</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
                    <span class="c1"># maj de la liste de childs associée :</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="c1"># re publication d&#39;un VirtualContainer :</span>
            <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">is_stacked</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">prevpublished</span><span class="p">:</span>
                <span class="c1"># on ajoute sa hiérarchie interne :</span>
                <span class="n">childrens</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">relativechildItems</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">childrens</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.add_from_hierarchy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.add_from_hierarchy">[docs]</a>    <span class="k">def</span> <span class="nf">add_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des items à publier en direction du RealContainer.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            childlist (list): liste de VirtualItem(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">add_from_hierarchy</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.remove_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.remove_item">[docs]</a>    <span class="k">def</span> <span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Suppression d&#39;un ou plusieurs item(s) virtuel(s)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            childs (list): liste de VirtualItem(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># gestion de la liste des items enfants</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="c1"># configuraion :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure_child_removed</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="c1"># publication :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.configure_child_removed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.configure_child_removed">[docs]</a>    <span class="k">def</span> <span class="nf">configure_child_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configuration au moment de la suppression du child.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (VirtualItem)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="c1"># suppression de la liste :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="c1"># box model :</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_STATIC</span><span class="p">,</span>
                <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_RELATIVE</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">flex</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># update complet nécessaire</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_allocated_area</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout_list</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discard_layout</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_FIXED</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fixedchildlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">absolutechildlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.remove_from_hierarchy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.remove_from_hierarchy">[docs]</a>    <span class="k">def</span> <span class="nf">remove_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des items à supprimer en direction du RealContainer.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            childlist (list): liste de VirtualItem(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">remove_from_hierarchy</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.on_item_added"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_item_added">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_added</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par le container parent lorsque l&#39;item est ajouté.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            parent (VirtualContainer)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="n">on_item_added</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
                <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># spécifique :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">add_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoadd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_item_removed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_item_removed">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée par le container parent lorsque l&#39;item est supprimé</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># spécifique (avant suppression de la ref au parent) :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">remove_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childtoremove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># propagation :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_parent_removed</span><span class="p">()</span>
        <span class="c1"># générique :</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="n">on_item_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualContainer.on_parent_removed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_parent_removed">[docs]</a>    <span class="k">def</span> <span class="nf">on_parent_removed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagé si un parent a été supprimé sans que celui ne supprime sa hiérarchie.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_parent_removed</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_item_added_to_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_item_added_to_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_added_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;item (via sa hiérarchie parente) est publié par</span>
<span class="sd">        le root dans la displaylist finale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="n">on_item_added_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_item_added_to_displaylist</span><span class="p">()</span></div>

<div class="viewcode-block" id="VirtualContainer.on_item_removed_from_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_item_removed_from_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">on_item_removed_from_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lorsque l&#39;item (via sa hiérarchie parente) est dé-publié par</span>
<span class="sd">        le root de la displaylist finale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="n">on_item_removed_from_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_item_removed_from_displaylist</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_set_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">childval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">childval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">childval</span>

<div class="viewcode-block" id="VirtualContainer.xget_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.xget_childs">[docs]</a>    <span class="k">def</span> <span class="nf">xget_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;publication&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de tous les items de la hiérarchie</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            context (str): permet de spécifier le contexte d&#39;usage (par défaut &quot;publication&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativechildItems</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="n">rlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualContainer</span><span class="p">):</span>
                <span class="n">rlist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">xget_childs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">rlist</span></div>

    <span class="c1">#-----&gt; Indicateurs de changement de rendu :</span>
<div class="viewcode-block" id="VirtualContainer.on_child_display_discarded"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.VirtualContainer.html#labpyproject.core.pygame.core.VirtualContainer.on_child_display_discarded">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_display_discarded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des discard d&#39;update jusqu&#39;au prochain RealContainer.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            child (VirtualItem)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_child_display_discarded</span><span class="p">(</span><span class="n">child</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CustomSprite"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite">[docs]</a><span class="k">class</span> <span class="nc">CustomSprite</span><span class="p">(</span><span class="n">VirtualItem</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Sprite supportant le boxmodel, la mécanique de publication et l&#39;update optimisé.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs : peut contenir clip (bool) ainsi que toutes les propriétés de VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">VirtualItem</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># clipping :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_clip</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cliprect_getter</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># méthode retournant un rect de clipping</span>
        <span class="k">if</span> <span class="s2">&quot;clip&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clip</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;clip&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;cliprect_getter&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cliprect_getter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cliprect_getter&quot;</span><span class="p">]</span>
        <span class="c1"># Couleur et surface de fond</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transp_color</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#FFFFFF00&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transp_color</span>
        <span class="k">if</span> <span class="s2">&quot;bgcolor&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcolor&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_default_surface</span><span class="p">()</span>
        <span class="c1"># visibilité</span>
        <span class="k">if</span> <span class="s2">&quot;visible&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de boxmodel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># spécifique : contenu et fond/bordure sont &quot;blittés&quot; sur la surface</span>
        <span class="c1"># par défaut en coordonnées locales</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_get_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Couleur de fond (str héxa) convertie au format pygame.Color.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span>

    <span class="k">def</span> <span class="nf">_set_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transp_color</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span> <span class="o">=</span> <span class="n">col</span>
            <span class="c1"># display :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_default_surface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span>

    <span class="n">bgcolor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_bgcolor</span><span class="p">,</span> <span class="n">_set_bgcolor</span>
    <span class="p">)</span>  <span class="c1">#: Couleur de fond (str héxa) convertie au format pygame.Color.</span>

<div class="viewcode-block" id="CustomSprite.create_default_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite.create_default_surface">[docs]</a>    <span class="k">def</span> <span class="nf">create_default_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée une surface de publication transparente par défaut.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">pygame</span><span class="o">.</span><span class="n">locals</span><span class="o">.</span><span class="n">SRCALPHA</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_border_rect</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span></div>

<div class="viewcode-block" id="CustomSprite.get_pygame_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite.get_pygame_surface">[docs]</a>    <span class="k">def</span> <span class="nf">get_pygame_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la surface pygame de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1">#-----&gt; Clipping :</span>
    <span class="k">def</span> <span class="nf">_set_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_clip</span> <span class="o">=</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">_get_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clip le sprite à son rectangle de publication (defaut False).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_clip</span>

    <span class="n">clip</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_clip</span><span class="p">,</span> <span class="n">_set_clip</span>
    <span class="p">)</span>  <span class="c1">#: Clip le sprite à son rectangle de publication (defaut False).</span>

    <span class="c1"># cliprect_getter : méthode fournissant un rect de clipping particulier</span>
    <span class="k">def</span> <span class="nf">_set_cliprect_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectprovider</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">rectprovider</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cliprect_getter</span> <span class="o">=</span> <span class="n">rectprovider</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clip</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_get_cliprect_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Méthode fournissant un rect de clipping particulier.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cliprect_getter</span>

    <span class="n">cliprect_getter</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_cliprect_getter</span><span class="p">,</span> <span class="n">_set_cliprect_getter</span>
    <span class="p">)</span>  <span class="c1">#: Méthode fournissant un rect de clipping particulier.</span>

<div class="viewcode-block" id="CustomSprite.get_display_dest"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite.get_display_dest">[docs]</a>    <span class="k">def</span> <span class="nf">get_display_dest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le paramètre dest de l&#39;opération de blit de draw_display.</span>
<span class="sd">        Prise en charge du clipping</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">area</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip</span><span class="p">:</span>
            <span class="c1"># on clip via la surface de référence</span>
            <span class="n">maskrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cliprect_getter</span><span class="p">:</span>
                <span class="c1"># le rect de clipping est fourni par cliprect_getter</span>
                <span class="n">maskrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cliprect_getter</span><span class="p">()</span>
            <span class="n">cropRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">maskrect</span><span class="p">)</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">cropRect</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">x</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">cropRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">publicationRect</span><span class="o">.</span><span class="n">y</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
            <span class="n">dw</span> <span class="o">=</span> <span class="n">cropRect</span><span class="o">.</span><span class="n">width</span>
            <span class="n">dh</span> <span class="o">=</span> <span class="n">cropRect</span><span class="o">.</span><span class="n">height</span>
            <span class="n">area</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># par défaut :</span>
            <span class="n">contentRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_rect</span><span class="p">()</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="p">(</span><span class="n">contentRect</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">contentRect</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dest</span><span class="p">,</span> <span class="n">area</span></div>

    <span class="c1">#-----&gt; Surcharge des super classes</span>
<div class="viewcode-block" id="CustomSprite.discard_placement"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite.discard_placement">[docs]</a>    <span class="k">def</span> <span class="nf">discard_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        La position a été modifiée, le rendu graphique dans la surface de publication</span>
<span class="sd">        du RealContainer assurant la publication n&#39;est plus valable. Par contre le rendu</span>
<span class="sd">        &quot;local&quot; de cet objet reste valide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">discard_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="CustomSprite.draw_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.CustomSprite.html#labpyproject.core.pygame.core.CustomSprite.draw_display">[docs]</a>    <span class="k">def</span> <span class="nf">draw_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dessine ou redessine l&#39;objet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># implémentation typique :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_default_surface</span><span class="p">()</span>
        <span class="c1"># blits spécifiques...</span>
        <span class="c1"># display pygame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span></div>

    <span class="k">def</span> <span class="nf">_get_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Visibilité du sprite.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="o">.</span><span class="n">_get_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_visible</span><span class="p">():</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="o">.</span><span class="n">_set_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span>

    <span class="n">visible</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_visible</span><span class="p">,</span> <span class="n">_set_visible</span><span class="p">)</span>  <span class="c1">#: Visibilité du sprite (bool).</span></div>


<div class="viewcode-block" id="RealContainer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer">[docs]</a><span class="k">class</span> <span class="nc">RealContainer</span><span class="p">(</span><span class="n">VirtualContainer</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Container &quot;réel&quot; disposant de sa surface de publication pygame et des capacités de gestion</span>
<span class="sd">    des z-indexs via l&#39;utilisation d&#39;un LayerManager par composition.**</span>
<span class="sd">    Pour sa descendance cet objet est vu comme un container, pour son parent il est considéré</span>
<span class="sd">    comme un objet terminal (ses couches internes sont applaties sur sa surface de publication).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create_surface</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            create_surface (boolean): création de la surface de publication dès l&#39;initialisation.</span>
<span class="sd">            **kwargs : peut contenir toutes les propriétés de VirtualContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialise les propriétés de publication</span>
        <span class="c1"># - liste des sprites d&#39;activation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voidspritelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># - listes de publication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationorder</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_removeorder</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># - indicateur et sprite de display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># - liste des descendants invalidés / display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># couleur de fond : blanc par défaut</span>
        <span class="k">if</span> <span class="s2">&quot;bgcolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transp_color</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;#FFFFFF00&quot;</span><span class="p">)</span>
        <span class="c1"># générique</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">VirtualContainer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Couches internes à publier par un RealContainer parent : non</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_stacked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Manager de couches :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LayerManager</span> <span class="o">=</span> <span class="n">LayerManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Surface de publication :</span>
        <span class="k">if</span> <span class="n">create_surface</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_publication_surface</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de boxmodel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># spécifique : contenu et fond/bordure sont &quot;blittés&quot; sur la surface</span>
        <span class="c1"># par défaut en coordonnées locales</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content_scope_global</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_init_publication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># liste des sprites d&#39;activation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voidspritelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># listes de publication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationorder</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_removeorder</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># indicateur et sprite de display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># liste des descendants invalidés / display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="c1">#-----&gt; Fond</span>
<div class="viewcode-block" id="RealContainer.create_background"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.create_background">[docs]</a>    <span class="k">def</span> <span class="nf">create_background</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Annule le comportement de VirtualContainer : le fond monochrome</span>
<span class="sd">        est directement associé à la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span></div>

    <span class="k">def</span> <span class="nf">_set_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parsing de la couleur de fond (blanc par défaut) : on force la</span>
<span class="sd">        composante alpha pour enlever la transparence et ainsi éviter</span>
<span class="sd">        les phénomènes de rémanence lors des updates partiels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span><span class="p">:</span>
            <span class="c1"># pas de transparence :</span>
            <span class="n">val</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">255</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bgcolor</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_bgcolor_changed</span><span class="p">()</span>

<div class="viewcode-block" id="RealContainer.on_bgcolor_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.on_bgcolor_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_bgcolor_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Surcharge de VirtualContainer : discard la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_publication_surface</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Surface de publication :</span>
<div class="viewcode-block" id="RealContainer.create_publication_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.create_publication_surface">[docs]</a>    <span class="k">def</span> <span class="nf">create_publication_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># display sprite</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_pubsprite&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">pygame</span><span class="o">.</span><span class="n">locals</span><span class="o">.</span><span class="n">SRCALPHA</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span>
            <span class="c1"># clear / bg :</span>
            <span class="n">clearsurf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clear_surface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">clearsurf</span><span class="p">)</span>
            <span class="c1"># clipping</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clipping_rect</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="RealContainer.get_clear_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.get_clear_surface">[docs]</a>    <span class="k">def</span> <span class="nf">get_clear_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la surface équivalente au fond d&#39;un VirtualContainer,</span>
<span class="sd">        utilisée en clear par LayeredDirty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bgrect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_border_rect</span><span class="p">()</span>
        <span class="n">bgd</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>
        <span class="n">bgd</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
        <span class="n">bgd</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="n">bgrect</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bgd</span></div>

<div class="viewcode-block" id="RealContainer.update_publication_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.update_publication_surface">[docs]</a>    <span class="k">def</span> <span class="nf">update_publication_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re crée la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_publication_surface</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="RealContainer.discard_publication_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.discard_publication_surface">[docs]</a>    <span class="k">def</span> <span class="nf">discard_publication_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalide la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="RealContainer.get_publication_sprite"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.get_publication_sprite">[docs]</a>    <span class="k">def</span> <span class="nf">get_publication_sprite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le DirtySprite de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span></div>

<div class="viewcode-block" id="RealContainer.get_pygame_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.get_pygame_surface">[docs]</a>    <span class="k">def</span> <span class="nf">get_pygame_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la surface pygame du sprite de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">image</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="RealContainer.get_clipping_rect"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.get_clipping_rect">[docs]</a>    <span class="k">def</span> <span class="nf">get_clipping_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne le rect de clipping, par défaut self.borderRect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_border_rect</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Indicateurs de changement de rendu :</span>
<div class="viewcode-block" id="RealContainer.discard_placement"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.discard_placement">[docs]</a>    <span class="k">def</span> <span class="nf">discard_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        La position a été modifiée, le rendu graphique dans la surface de publication</span>
<span class="sd">        du RealContainer assurant la publication n&#39;est plus valable. Par contre le rendu</span>
<span class="sd">        &quot;local&quot; de cet objet reste valide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># générique :</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">discard_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># spécifique :</span>
        <span class="k">if</span> <span class="n">change</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="RealContainer.on_child_display_discarded"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.on_child_display_discarded">[docs]</a>    <span class="k">def</span> <span class="nf">on_child_display_discarded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des discard d&#39;update jusqu&#39;au prochain RealContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; on_child_display_discarded child=&quot;,child)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Update, resize, display :</span>
<div class="viewcode-block" id="RealContainer.update"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée à chaque frame:</span>
<span class="sd">        </span>
<span class="sd">        1. Publications éventuelles</span>
<span class="sd">        2. Resize générique</span>
<span class="sd">        3. Mise à jour du display</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- publication éventuelle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manage_publicationlist</span><span class="p">()</span>
        <span class="c1"># 2- resize</span>
        <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="c1"># 3- display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_display</span><span class="p">()</span></div>

<div class="viewcode-block" id="RealContainer.on_publicationRect_dims_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.on_publicationRect_dims_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les dimensions (et éventuellement</span>
<span class="sd">        les coords) de publicationRect ont été modifiées.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; on_publicationRect_dims_changed&quot;)</span>
        <span class="c1"># générique</span>
        <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">on_publicationRect_dims_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">)</span>
        <span class="c1"># spécifique</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_publication_surface</span><span class="p">()</span></div>

<div class="viewcode-block" id="RealContainer.on_publicationRect_coords_changed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.on_publicationRect_coords_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_publicationRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors du process de resize quand les coordonnées seules</span>
<span class="sd">        de publicationRect ont été modifiées (pas les dimensions).</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            aftersnap (boolean): True si consécutif à un calcul de snap, False sinon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; on_publicationRect_coords_changed&quot;)</span>
        <span class="c1"># générique</span>
        <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">on_publicationRect_coords_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aftersnap</span><span class="p">)</span>
        <span class="c1"># spécifique</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_publication_surface</span><span class="p">()</span></div>

<div class="viewcode-block" id="RealContainer.handle_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.handle_display">[docs]</a>    <span class="k">def</span> <span class="nf">handle_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gère l&#39;affichage du RealContainer. Retourne le nombre de childs retracés.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># optimisation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; handle_display self._display_updated=&quot;,self._display_updated)</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span><span class="p">:</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span><span class="p">))</span>
            <span class="c1"># redraw de la descendance :</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span><span class="p">:</span>
                <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; redraw de child=&quot;,child.name)</span>
                <span class="n">child</span><span class="o">.</span><span class="n">draw_display</span><span class="p">()</span>
            <span class="c1"># Re draw : sera déclenché par le prochain RealContainer dans la hiérarchie asc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span>
            <span class="c1"># ré initialisations :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nb</span></div>

<div class="viewcode-block" id="RealContainer.draw_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.draw_display">[docs]</a>    <span class="k">def</span> <span class="nf">draw_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dessine ou redessine l&#39;objet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># optimisation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># [Keep for debug] print(&quot;RC|&quot;,self.name,&quot; draw_display _use_update=&quot;,self._use_update)</span>
        <span class="c1"># clipping</span>
        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">get_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clipping_rect</span><span class="p">():</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">set_clip</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">screen_rect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_clipping_rect</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="c1"># Update éventuel de la surface de publication</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span><span class="p">:</span>
            <span class="c1"># publicationRect a été modifié, on retrace...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_publication_surface</span><span class="p">()</span>
            <span class="c1"># ... tout :</span>
            <span class="c1"># self.xforce_update()</span>
        <span class="c1"># On trace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pygame_surface</span><span class="p">())</span>
        <span class="c1"># optimisation (debug?) : LayeredDirty ne passe pas forcément les</span>
        <span class="c1"># sprites à dirty=0 après l&#39;appel à draw.</span>
        <span class="k">for</span> <span class="n">sprite</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sprites</span><span class="p">():</span>
            <span class="n">sprite</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Marque le sprite de publication comme dirty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Indicateur de mise à jour</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="RealContainer.xforce_update"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.xforce_update">[docs]</a>    <span class="k">def</span> <span class="nf">xforce_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Force le redraw de tous les sprites de la displaylist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sprites</span><span class="p">():</span>
            <span class="n">s</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span></div>

    <span class="c1">#-----&gt; Logique de publication spécifique :</span>
<div class="viewcode-block" id="RealContainer.manage_publicationlist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.manage_publicationlist">[docs]</a>    <span class="k">def</span> <span class="nf">manage_publicationlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute/retire les items en attente.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dochange</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">rects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># 1- suppression :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dochange</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">fulldellist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualContainer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">is_stacked</span><span class="p">:</span>
                    <span class="n">fulldellist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">xget_childs</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fulldellist</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fulldellist</span><span class="p">:</span>
                    <span class="n">fulldellist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="n">rects</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_remove_item_internal</span><span class="p">(</span><span class="o">*</span><span class="n">fulldellist</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># 2- ajout :</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dochange</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span><span class="p">)</span>
            <span class="c1"># 2.1- Def levels</span>
            <span class="n">leveldefined</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="kc">None</span>
                        <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span>
                        <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">level</span> <span class="o">!=</span> <span class="kc">None</span>
                    <span class="p">):</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">level</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">leveldefined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                        <span class="n">count</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="c1"># 2.2- publication par levels croissants</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">leveldefined</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_item_internal</span><span class="p">(</span><span class="o">*</span><span class="n">leveldefined</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># 3- ménage :</span>
        <span class="k">if</span> <span class="n">dochange</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_LayerManager</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean_voidsprites</span><span class="p">()</span>
            <span class="c1"># [Keep for debug] self._LayerManager.trace(full=True)</span>
        <span class="k">return</span> <span class="n">rects</span><span class="p">,</span> <span class="n">dochange</span></div>

<div class="viewcode-block" id="RealContainer.add_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.add_item">[docs]</a>    <span class="k">def</span> <span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajout d&#39;un ou plusieurs item(s) virtuel(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="c1"># configuration :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure_child_added</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_publicationlist</span><span class="p">(</span><span class="n">childs</span><span class="p">)</span></div>

<div class="viewcode-block" id="RealContainer.add_from_hierarchy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.add_from_hierarchy">[docs]</a>    <span class="k">def</span> <span class="nf">add_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des items à publier en direction du RealContainer (aka self).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_publicationlist</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_to_publicationlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="c1"># mémorisation de l&#39;ordre de publication</span>
                <span class="n">child</span><span class="o">.</span><span class="n">publication_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publicationorder</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_publicationorder</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_publicationlist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">childs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_item_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajout d&#39;un ou plusieurs item(s) virtuel(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- Enregistrement générique (et définition de local_layer)</span>
        <span class="n">virtitemslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="n">virtitemslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="c1"># 2- Gestion des z-indexs (publication_layer)</span>
        <span class="n">virtitemslist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">virtitemslist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">))</span>
        <span class="n">levelvalues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">virtitemslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levelvalues</span><span class="p">:</span>
                <span class="n">levelvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="c1"># levels croissants :</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levelvalues</span><span class="p">:</span>
            <span class="n">batchlevel</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">virtitemslist</span> <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batchlevel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">batchlevel</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">batchlevel</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;local_layer&quot;</span><span class="p">,</span> <span class="s2">&quot;publication_order&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_LayerManager</span><span class="o">.</span><span class="n">batch_add_item</span><span class="p">(</span><span class="o">*</span><span class="n">batchlevel</span><span class="p">)</span>
        <span class="c1"># 3- Publication :</span>
        <span class="n">rects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">virtitemslist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="n">virtitemslist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="s2">&quot;local_layer&quot;</span><span class="p">,</span> <span class="s2">&quot;publication_order&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">virtitemslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="n">child</span><span class="o">.</span><span class="n">prevpublished</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_child_to_displaylist</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">CustomSprite</span><span class="p">):</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">child</span><span class="o">.</span><span class="n">publication_layer</span>
                <span class="p">)</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">RealContainer</span><span class="p">):</span>
                <span class="n">pubsprite</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">get_publication_sprite</span><span class="p">()</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">pubsprite</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">child</span><span class="o">.</span><span class="n">publication_layer</span>
                <span class="p">)</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pubsprite</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualContainer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">is_stacked</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">active_layer</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">publication_layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rects</span>

<div class="viewcode-block" id="RealContainer.add_child_to_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.add_child_to_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">add_child_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors de _add_item_internal, child est un VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">belong_to_displaylist</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_item_added_to_displaylist</span><span class="p">()</span></div>

<div class="viewcode-block" id="RealContainer.remove_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.remove_item">[docs]</a>    <span class="k">def</span> <span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Suppression d&#39;un ou plusieurs item(s) virtuel(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="c1"># configuraion :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">configure_child_removed</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_removelist</span><span class="p">(</span><span class="n">childs</span><span class="p">)</span></div>

<div class="viewcode-block" id="RealContainer.remove_from_hierarchy"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.remove_from_hierarchy">[docs]</a>    <span class="k">def</span> <span class="nf">remove_from_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chaine de remontée des items à supprimer en direction du RealContainer (aka self).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_removelist</span><span class="p">(</span><span class="n">childlist</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_to_removelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_removelist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">childs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_remove_item_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">childs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Suppression d&#39;un ou plusieurs item(s) virtuel(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1- Suppression générique</span>
        <span class="n">virtitemslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="c1"># générique :</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="n">virtitemslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="c1"># 2- Gestion des z-indexs (publication_layer)</span>
        <span class="n">virtitemslist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">virtitemslist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">levelvalues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">virtitemslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levelvalues</span><span class="p">:</span>
                <span class="n">levelvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="n">levelvalues</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># levels décroissants :</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levelvalues</span><span class="p">:</span>
            <span class="n">batchlevel</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">virtitemslist</span> <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">level</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batchlevel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">batchlevel</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">batchlevel</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;local_layer&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_LayerManager</span><span class="o">.</span><span class="n">batch_remove_item</span><span class="p">(</span><span class="o">*</span><span class="n">batchlevel</span><span class="p">)</span>
        <span class="c1"># 3- Publication :</span>
        <span class="n">rects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">RealContainer</span><span class="p">):</span>
                <span class="n">pubsprite</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">get_publication_sprite</span><span class="p">()</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pubsprite</span><span class="p">)</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pubsprite</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">CustomSprite</span><span class="p">):</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_child_from_displaylist</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">child</span><span class="o">.</span><span class="n">on_item_removed</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">rects</span>

<div class="viewcode-block" id="RealContainer.remove_child_from_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.remove_child_from_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">remove_child_from_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors de _remove_item_internal, child est un VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">belong_to_displaylist</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">on_item_removed_from_displaylist</span><span class="p">()</span></div>

<div class="viewcode-block" id="RealContainer.xget_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.xget_childs">[docs]</a>    <span class="k">def</span> <span class="nf">xget_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;publication&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de tous les items de la hiérarchie</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            context (str): permet de spécifier le contexte d&#39;usage (par défaut &quot;publication&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span> <span class="o">==</span> <span class="s2">&quot;publication&quot;</span><span class="p">:</span>
            <span class="c1"># ce container prend en charge sa propre hiérarchie</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">xget_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Gestion &quot;physique&quot; des couches :</span>
<div class="viewcode-block" id="RealContainer.doswap_layers"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.doswap_layers">[docs]</a>    <span class="k">def</span> <span class="nf">doswap_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oldlayer</span><span class="p">,</span> <span class="n">newlayer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Echange les zindexs de deux couches.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">usedlayers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">usedlayers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">oldlayer</span> <span class="ow">in</span> <span class="n">usedlayers</span><span class="p">:</span>
            <span class="c1"># retraits :</span>
            <span class="n">oldlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_sprites_of_layer</span><span class="p">(</span><span class="n">oldlayer</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">newlayer</span> <span class="ow">in</span> <span class="n">usedlayers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">active_layer</span><span class="p">(</span><span class="n">newlayer</span><span class="p">)</span>
            <span class="n">newlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_sprites_of_layer</span><span class="p">(</span><span class="n">newlayer</span><span class="p">)</span>
            <span class="c1"># ajouts :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">newlist</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">oldlayer</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">oldlist</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">newlayer</span><span class="p">)</span></div>

<div class="viewcode-block" id="RealContainer.active_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.active_layer">[docs]</a>    <span class="k">def</span> <span class="nf">active_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Active une couche par l&#39;ajout d&#39;un sprite invisible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">voidspr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_void_sprite</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">voidspr</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span></div>

<div class="viewcode-block" id="RealContainer.get_void_sprite"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.get_void_sprite">[docs]</a>    <span class="k">def</span> <span class="nf">get_void_sprite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée un sprite invisible pour l&#39;activation d&#39;une couche.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">voidspr</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">DirtySprite</span><span class="p">()</span>
        <span class="n">voidspr</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">voidspr</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
        <span class="n">voidspr</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;0xffffff00&quot;</span><span class="p">))</span>
        <span class="n">voidspr</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="n">voidspr</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
        <span class="n">voidspr</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voidspritelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">voidspr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">voidspr</span></div>

<div class="viewcode-block" id="RealContainer.clean_voidsprites"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RealContainer.html#labpyproject.core.pygame.core.RealContainer.clean_voidsprites">[docs]</a>    <span class="k">def</span> <span class="nf">clean_voidsprites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime les sprites d&#39;activation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">vspr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_voidspritelist</span><span class="p">:</span>
            <span class="c1"># suppression standard</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">LayeredDirty</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vspr</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Visibilité :</span>
    <span class="k">def</span> <span class="nf">_get_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">visible</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_visible</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pub_sprite</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_display</span><span class="p">()</span>

    <span class="n">visible</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_visible</span><span class="p">,</span> <span class="n">_set_visible</span><span class="p">)</span>  <span class="c1">#: Visibilité (bool)</span></div>


<div class="viewcode-block" id="RootContainer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer">[docs]</a><span class="k">class</span> <span class="nc">RootContainer</span><span class="p">(</span><span class="n">RealContainer</span><span class="p">,</span> <span class="n">evt</span><span class="o">.</span><span class="n">GUIEventManager</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Container racine de l&#39;application.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># statique</span>
    <span class="c1"># aspect-ratios standards en mono moniteur</span>
    <span class="n">STD_ASPECT_RATIOS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1366</span><span class="p">,</span> <span class="mi">768</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1440</span><span class="p">,</span> <span class="mi">900</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1536</span><span class="p">,</span> <span class="mi">864</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">900</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1280</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1680</span><span class="p">,</span> <span class="mi">1050</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1360</span><span class="p">,</span> <span class="mi">768</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1200</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span>
        <span class="n">Fraction</span><span class="p">(</span><span class="mi">1208</span><span class="p">,</span> <span class="mi">768</span><span class="p">),</span>
    <span class="p">]</span>  <span class="c1">#: aspect-ratios standards en mono moniteur</span>
    <span class="c1"># modes plein écran :</span>
    <span class="c1"># résolution max du moniteur</span>
    <span class="n">FULLSCREEN_MODE_MAX</span> <span class="o">=</span> <span class="s2">&quot;FULLSCREEN_MODE_MAX&quot;</span>  <span class="c1">#: résolution max du moniteur</span>
    <span class="c1"># résolution supportée la plus proche des dimensions originelles de l&#39;interface</span>
    <span class="n">FULLSCREEN_MODE_NEAREST</span> <span class="o">=</span> <span class="s2">&quot;FULLSCREEN_MODE_NEAREST&quot;</span>  <span class="c1">#: résolution supportée la plus proche des dimensions originelles de l&#39;interface</span>
    <span class="c1"># mode par défaut :</span>
    <span class="n">FULLSCREEN_MODE_DEFAULT</span> <span class="o">=</span> <span class="n">FULLSCREEN_MODE_NEAREST</span>  <span class="c1">#: mode par défaut</span>
    <span class="c1"># méthodes</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resizable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        LayeredDirty de plus haut niveau.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            resizable (boolean): indique si l&#39;application est redimensionnable, vrai par défaut</span>
<span class="sd">            framerate (int): 60 par défaut</span>
<span class="sd">            bgcolor (str hexa): couleur de fond, blanc par défaut</span>
<span class="sd">            icon (surface): surface pygame remplaçant l&#39;icône par défaut</span>
<span class="sd">            caption (str): titre de la fenêtre</span>
<span class="sd">            **kwargs: toutes propriétés supportées par RealContainer</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            Exception si width et height ne sont pas définis explicitement.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># test préalable :</span>
        <span class="k">if</span> <span class="s2">&quot;width&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;height&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;RootContainer nécessite de définir explicitement les attributs width et height&quot;</span>
            <span class="p">)</span>
        <span class="c1"># initialisation pygame :</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYGAME_FREETYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_video_info</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="c1"># surface pour icône personnalisée :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">icon</span>
        <span class="c1"># titre de la fenêtre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">caption</span> <span class="o">=</span> <span class="n">caption</span>
        <span class="c1"># surface du moniteur :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># dimensions originelles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># dimensions de plein écran :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># plein écran :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># resize :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resizable</span> <span class="o">=</span> <span class="n">resizable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_resize</span><span class="p">()</span>
        <span class="c1"># framerate :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">framerate</span> <span class="o">=</span> <span class="n">framerate</span>
        <span class="c1"># surface de publication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># générique</span>
        <span class="n">RealContainer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create_surface</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">evt</span><span class="o">.</span><span class="n">GUIEventManager</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># displaylist (appartenance)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_added_to_displaylist</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Niveau d&#39;imbrication dans la hiérarchie globale :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># init framerate :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_framerate</span><span class="p">()</span>
        <span class="c1"># init vidéo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_videomode</span><span class="p">()</span>
        <span class="c1"># surface initiale :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_publication_surface</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés de boxmodel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Surcharge des paramètres :</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxModelObject</span><span class="o">.</span><span class="n">POSITION_ABSOLUTE</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;snapW&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;snapH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;valign&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># générique :</span>
        <span class="n">RealContainer</span><span class="o">.</span><span class="n">_init_boxmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Définition de la surface de référence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise les propriétés liées au resize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_frame_delay</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_resize_event</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#-----&gt; Spécifique</span>
    <span class="k">def</span> <span class="nf">_init_framerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise le framerate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_videomode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialisation des propriétés vidéos.</span>
<span class="sd">        </span>
<span class="sd">        .. admonition::</span>
<span class="sd">            Attention: sous windows la résolution totale (si plusieurs moniteurs)</span>
<span class="sd">            n&#39;est pas détectée. Le mode plein écran peut donc être activé en </span>
<span class="sd">            multi écrans alors qu&#39;il cause des bugs d&#39;affichage.</span>
<span class="sd">            </span>
<span class="sd">            Remarque: une tentative de dénombrage des moniteurs avec Xlib n&#39;a </span>
<span class="sd">            pas été concluante (display.Display().screen_count() ne retourne</span>
<span class="sd">            pas le nombre exact d&#39;écrans). </span>
<span class="sd">            </span>
<span class="sd">        Todo:</span>
<span class="sd">            une solution pour windows via win32api: ::</span>
<span class="sd">        </span>
<span class="sd">            import platform</span>
<span class="sd">            if platform.system() == &#39;Windows&#39;:</span>
<span class="sd">                # par défaut on désactive le plein écran</span>
<span class="sd">                self._support_fullscreen = False</span>
<span class="sd">                # on essaye de dénombrer les écrans :</span>
<span class="sd">                try:</span>
<span class="sd">                    import win32api</span>
<span class="sd">                except Import Error:</span>
<span class="sd">                    print(&quot;win32api missing&quot;)</span>
<span class="sd">                else:</span>
<span class="sd">                    screencount = len(win32api.EnumDisplayMonitors())</span>
<span class="sd">                    if screencount == 1:</span>
<span class="sd">                        # on active le plein écran :</span>
<span class="sd">                        self._support_fullscreen = True</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># résolution du moniteur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_height</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_video_info</span><span class="o">.</span><span class="n">current_w</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_video_info</span><span class="o">.</span><span class="n">current_h</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># aspect ratio associé :</span>
        <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor_width</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor_height</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_height</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">):</span>
            <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_height</span><span class="p">)</span>
        <span class="c1"># ce ratio est il standard? (on doit éviter d&#39;activer le plein écran</span>
        <span class="c1"># si il y a plusieurs moniteurs, cf perturbations de l&#39;affichage</span>
        <span class="c1"># connues avec SDL 1.2)</span>
        <span class="k">if</span> <span class="n">aspect_ratio</span> <span class="ow">in</span> <span class="n">RootContainer</span><span class="o">.</span><span class="n">STD_ASPECT_RATIOS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># todo: patch windows via win32api</span>
        <span class="c1"># mémorisation des dimensions originelles :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_value</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span>
        <span class="c1"># résolution la plus proche supportée dans les modes vidéo de la plate</span>
        <span class="c1"># forme :</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span><span class="p">:</span>
            <span class="n">lm</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">list_modes</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">modelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">lm</span><span class="p">:</span>
                    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">dw</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dh</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">sortdict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;surf&quot;</span><span class="p">:</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="s2">&quot;delta&quot;</span><span class="p">:</span> <span class="n">dw</span> <span class="o">+</span> <span class="n">dh</span><span class="p">}</span>
                    <span class="n">modelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sortdict</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">RootContainer</span><span class="o">.</span><span class="n">FULLSCREEN_MODE_DEFAULT</span>
                    <span class="o">==</span> <span class="n">RootContainer</span><span class="o">.</span><span class="n">FULLSCREEN_MODE_MAX</span>
                <span class="p">):</span>
                    <span class="c1"># on prend la plus grande résolution supportée par le moniteur</span>
                    <span class="n">modelist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;surf&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="n">RootContainer</span><span class="o">.</span><span class="n">FULLSCREEN_MODE_DEFAULT</span>
                    <span class="o">==</span> <span class="n">RootContainer</span><span class="o">.</span><span class="n">FULLSCREEN_MODE_NEAREST</span>
                <span class="p">):</span>
                    <span class="c1"># on prend celle qui se rapproche le plus de la surface originelle</span>
                    <span class="n">modelist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">))</span>
                <span class="c1"># la surface de plein écran :</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_size</span> <span class="o">=</span> <span class="n">modelist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="RootContainer.toggle_fullscreen"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.toggle_fullscreen">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_fullscreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Entre / sort du mode plein écran.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_publication_surface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.is_fullscreen"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.is_fullscreen">[docs]</a>    <span class="k">def</span> <span class="nf">is_fullscreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Indique si l&#39;application est en plein écran.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span></div>

<div class="viewcode-block" id="RootContainer.support_fullscreen"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.support_fullscreen">[docs]</a>    <span class="k">def</span> <span class="nf">support_fullscreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si le plein écran est supporté</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span></div>

    <span class="c1">#-----&gt; Surcharge de RealContainer :</span>
<div class="viewcode-block" id="RootContainer.add_child_to_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.add_child_to_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">add_child_to_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors de _add_item_internal, child est un VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Root est toujours dans la displaylist</span>
        <span class="n">child</span><span class="o">.</span><span class="n">on_item_added_to_displaylist</span><span class="p">()</span>
        <span class="c1"># événements : évite que la Queue Pygame soit saturée lors de l&#39;initialisation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_events</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.remove_child_from_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.remove_child_from_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">remove_child_from_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée lors de _remove_item_internal, child est un VirtualItem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Root est toujours dans la displaylist</span>
        <span class="n">child</span><span class="o">.</span><span class="n">on_item_removed_from_displaylist</span><span class="p">()</span>
        <span class="c1"># événements : évite que la Queue Pygame soit saturée lors de l&#39;initialisation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_events</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.create_publication_surface"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.create_publication_surface">[docs]</a>    <span class="k">def</span> <span class="nf">create_publication_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée la surface de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># configuration :</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="c1"># icon (avant set_mode)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">):</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_icon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">)</span>
        <span class="c1"># titre fenêtre</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caption</span><span class="p">)</span>
        <span class="c1"># mode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_fullscreen</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fullscreen</span><span class="p">:</span>
            <span class="c1"># mode plein écran :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_size</span><span class="p">,</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">FULLSCREEN</span> <span class="o">|</span> <span class="n">pygame</span><span class="o">.</span><span class="n">HWSURFACE</span> <span class="o">|</span> <span class="n">pygame</span><span class="o">.</span><span class="n">DOUBLEBUF</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># mode fenêtré :</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">resizable</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">pygame</span><span class="o">.</span><span class="n">RESIZABLE</span>
                <span class="p">)</span>
        <span class="c1"># surface de clear :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">Surface</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bg_clear_surface</span><span class="p">)</span>
        <span class="c1"># clipping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span></div>

<div class="viewcode-block" id="RootContainer.update"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Englobe la méthode héritée de RealContainer dans un test. Permet de</span>
<span class="sd">        catcher l&#39;exception éventuellement générée par la fermeture de la fenêtre</span>
<span class="sd">        lors d&#39;un process de publication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">RealContainer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">get_init</span><span class="p">():</span>
                <span class="c1"># si le display est encore initialisé alors il s&#39;agit bien d&#39;une erreur</span>
                <span class="k">raise</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="RootContainer.handle_display"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.handle_display">[docs]</a>    <span class="k">def</span> <span class="nf">handle_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gère l&#39;affichage du RootContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;...\nROOT| handle_display self._display_updated=&quot;,self._display_updated)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Update éventuel de la surface de publication</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_publication_surface_discarded</span><span class="p">:</span>
                <span class="c1"># publicationRect a été modifié, on retrace...</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_publication_surface</span><span class="p">()</span>
                <span class="c1"># ... tout :</span>
                <span class="c1"># self.xforce_update()</span>
            <span class="c1"># redraw de la descendance :</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span><span class="p">:</span>
                <span class="c1"># [Keep for debug] print(&quot;ROOT redraw de child=&quot;,child.name,&quot; rect=&quot;,child.rect)</span>
                <span class="n">child</span><span class="o">.</span><span class="n">draw_display</span><span class="p">()</span>
            <span class="c1"># Re draw :</span>
            <span class="n">rects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publication_surface</span><span class="p">)</span>
            <span class="c1"># [Keep for debug] print(&quot;ROOT &gt;&gt; handle_display rects=&quot;,rects)</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rects</span><span class="p">)</span>
            <span class="c1"># ré initialisations :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">child_to_redraw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.xget_childs"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.xget_childs">[docs]</a>    <span class="k">def</span> <span class="nf">xget_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;publication&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste de tous les items de la hiérarchie : annule le comportement </span>
<span class="sd">        de RealContainer.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            context (str): permet de spécifier le contexte d&#39;usage (par défaut &quot;publication&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">VirtualContainer</span><span class="o">.</span><span class="n">xget_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span></div>

    <span class="c1">#-----&gt; Thread</span>
<div class="viewcode-block" id="RootContainer.start_GUI"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.start_GUI">[docs]</a>    <span class="k">def</span> <span class="nf">start_GUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Démarre le process de gestion de la GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui_process_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_GUI_process</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.stop_GUI"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.stop_GUI">[docs]</a>    <span class="k">def</span> <span class="nf">stop_GUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop le process de gestion de la GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui_process_active</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="RootContainer.run_GUI_process"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.run_GUI_process">[docs]</a>    <span class="k">def</span> <span class="nf">run_GUI_process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boucle de gestion de la GUI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">gui_process_active</span><span class="p">:</span>
            <span class="c1"># pré-traitements personnalisés :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">before_frame_processed</span><span class="p">()</span>
            <span class="c1"># événements :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_events</span><span class="p">()</span>
            <span class="c1"># publication, propagation des updates, resize et display :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.before_frame_processed"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.before_frame_processed">[docs]</a>    <span class="k">def</span> <span class="nf">before_frame_processed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appelée à chaque frame d&#39;exécution avant les traitements génériques de</span>
<span class="sd">        Root (événements puis update graphique).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="RootContainer.on_quit_event"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.on_quit_event">[docs]</a>    <span class="k">def</span> <span class="nf">on_quit_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode appelée par CustomEventManager lorsque survient l&#39;événement pygame.QUIT. </span>
<span class="sd">        Rq : l&#39;événement n&#39;a aucun attribut particulier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pygame :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_Root</span><span class="p">()</span></div>
        <span class="c1"># à subclasser au besoin</span>

<div class="viewcode-block" id="RootContainer.close_Root"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.close_Root">[docs]</a>    <span class="k">def</span> <span class="nf">close_Root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fermeture du root pygame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Arrêt de la boucle run :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_GUI</span><span class="p">()</span>
        <span class="c1"># Evite l&#39;erreur &quot;video system not initialized&quot; lors de l&#39;appel à</span>
        <span class="c1"># pygame.event.get() dans la version initiale de handle_events :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_events</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="kc">None</span>
        <span class="c1"># Clôture de Pygame :</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

    <span class="c1">#-----&gt; Resize spécifique :</span>
<div class="viewcode-block" id="RootContainer.resize"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.resize">[docs]</a>    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Surcharge de VirtualContainer.resize()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># [Keep for debug] print(&quot;\n\nROOT Update...&quot;)</span>
        <span class="c1"># générique :</span>
        <span class="n">resized</span> <span class="o">=</span> <span class="n">RealContainer</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># self._LayerManager.trace()</span>
        <span class="k">if</span> <span class="n">resized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_updated</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_publication_surface</span><span class="p">()</span></div>

<div class="viewcode-block" id="RootContainer.on_resize_event"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.RootContainer.html#labpyproject.core.pygame.core.RootContainer.on_resize_event">[docs]</a>    <span class="k">def</span> <span class="nf">on_resize_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Méthode appelée par CustomEventManager lorsque survient l&#39;événement pygame.VIDEORESIZE. </span>
<span class="sd">        Rq : attributs : size, w, h</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s2">&quot;100%&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publicationRefRect</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discard_resize</span><span class="p">()</span></div></div>


<span class="c1">#-----&gt; Z indexs : gestionnaire de couches</span>
<div class="viewcode-block" id="LayerManager"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager">[docs]</a><span class="k">class</span> <span class="nc">LayerManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Objet modélisant la gestion des couches (z-indexs), utilisé par composition par</span>
<span class="sd">    un RealContainer.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            root (RealContainer)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># RealContainer associé :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="c1"># LayerStack Root :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span> <span class="o">=</span> <span class="n">LayerStack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># dict cont / LayerStack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span> <span class="o">=</span> <span class="p">{</span><span class="n">root</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="p">}</span>
        <span class="c1"># liste des couches à supprimer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unusedlayerlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<div class="viewcode-block" id="LayerManager.trace"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.trace">[docs]</a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debug.&quot;&quot;&quot;</span>
        <span class="c1"># debug</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LayerManager... &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Couches réelles de &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;  ---&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">layers</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt; layer = &quot;</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>
            <span class="n">layersprites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">get_sprites_from_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">full</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">layersprites</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;publication_layer&quot;</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;  - &quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot; publication_layer=&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">publication_layer</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - &quot;</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -&gt; layersprites : &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">layersprites</span><span class="p">),</span> <span class="s2">&quot; éléments.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerManager.register_layerstack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.register_layerstack">[docs]</a>    <span class="k">def</span> <span class="nf">register_layerstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stackobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre un nouvel objet LayerStack associé à un conteneur.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            stackobj (LayerStack)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stackobj</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="n">stackobj</span><span class="o">.</span><span class="n">container</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">stackobj</span></div>

<div class="viewcode-block" id="LayerManager.unregister_layerstack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.unregister_layerstack">[docs]</a>    <span class="k">def</span> <span class="nf">unregister_layerstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stackobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime la référence à stackobj</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            stackobj (LayerStack)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stackobj</span><span class="o">.</span><span class="n">container</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="p">[</span><span class="n">stackobj</span><span class="o">.</span><span class="n">container</span><span class="p">]</span></div>

<div class="viewcode-block" id="LayerManager.batch_add_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.batch_add_item">[docs]</a>    <span class="k">def</span> <span class="nf">batch_add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Publication en batch d&#39;une liste d&#39;items.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            *items (list): liste de VirtualItem ou VirtualContainer</span>
<span class="sd">                </span>
<span class="sd">        Définit l&#39;attribut publication_layer de chaque item, gère les dépendances. </span>
<span class="sd">        Le process de publication fait en sorte que la hiérarchie de parents soit connue </span>
<span class="sd">        de ce manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">swaplist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Ajout délégué à l&#39;objet ContainerLayers parent</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">parentstack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stack_for_container</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">parentstack</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="c1"># application des offsets aux objets existants</span>
        <span class="n">swaplist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_changes_internal</span><span class="p">())</span>
        <span class="c1"># Gestion physique des couches de la display list :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_displaylist</span><span class="p">(</span><span class="n">swaplist</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerManager.batch_remove_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.batch_remove_item">[docs]</a>    <span class="k">def</span> <span class="nf">batch_remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dé publication en batch d&#39;une liste d&#39;items.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            *items (list): liste de VirtualItem ou VirtualContainer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">swaplist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Ajout délégué à l&#39;objet ContainerLayers parent</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">parentstack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stack_for_container</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">parentstack</span><span class="o">.</span><span class="n">remove_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="c1"># application des offsets aux objets existants</span>
        <span class="n">swaplist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_changes_internal</span><span class="p">())</span>
        <span class="c1"># Gestion physique des couches de la display list :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_displaylist</span><span class="p">(</span><span class="n">swaplist</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerManager.handle_changes_internal"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.handle_changes_internal">[docs]</a>    <span class="k">def</span> <span class="nf">handle_changes_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique les décallages de couches portés par les offsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># mise à jour interne :</span>
        <span class="n">swaplist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="o">.</span><span class="n">apply_offset</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">swaplist</span></div>

<div class="viewcode-block" id="LayerManager.update_displaylist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.update_displaylist">[docs]</a>    <span class="k">def</span> <span class="nf">update_displaylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changelist</span><span class="p">,</span> <span class="n">doadd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique les décallages de couches à la displaylist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">doadd</span><span class="p">:</span>
            <span class="c1"># offsets &gt; 0</span>
            <span class="n">changelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">changelist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">changelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">changelist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">changetup</span> <span class="ow">in</span> <span class="n">changelist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">doswap_layers</span><span class="p">(</span><span class="o">*</span><span class="n">changetup</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerManager.clean"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Nettoyage des structures de données.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># liste des LayerStacks :</span>
        <span class="n">stacklist</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">stacklist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">stacklist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;locallayer&quot;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># suppression récursive des couches locales vides :</span>
        <span class="n">changelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">stack</span> <span class="ow">in</span> <span class="n">stacklist</span><span class="p">:</span>
            <span class="n">layerindices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
            <span class="n">layerindices</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">layerindices</span><span class="p">:</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
                    <span class="n">globalrange</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
                    <span class="n">changelist</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">globalrange</span><span class="p">])</span>
                    <span class="n">stack</span><span class="o">.</span><span class="n">delete_layer</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="c1"># définition des offsets :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="o">.</span><span class="n">handle_changelist</span><span class="p">(</span><span class="n">changelist</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># application des offsets :</span>
        <span class="n">swaplist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootstack</span><span class="o">.</span><span class="n">apply_offset</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># décallages physiques :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_displaylist</span><span class="p">(</span><span class="n">swaplist</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerManager.get_stack_for_container"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerManager.html#labpyproject.core.pygame.core.LayerManager.get_stack_for_container">[docs]</a>    <span class="k">def</span> <span class="nf">get_stack_for_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cont</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne l&#39;objet LayerStack associé à un VirtualContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cont</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackdict</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="LayerStack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack">[docs]</a><span class="k">class</span> <span class="nc">LayerStack</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Modélise la pile de couches d&#39;un conteneur.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">parentstack</span><span class="p">,</span> <span class="n">parentlayer</span><span class="p">,</span> <span class="n">layerMngr</span><span class="p">,</span> <span class="n">locallayer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            container (VirtualContainer): le container considéré</span>
<span class="sd">            parentstack (LayerStack): LayerStack de son parent</span>
<span class="sd">            parentlayer (LocalLayer): couche locale du parent</span>
<span class="sd">            layerMngr (LayerManager): gestionnaire de zindexs mobilisé</span>
<span class="sd">            locallayer (int): indice local dans la pile parente</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># VirtualContainer associé :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">container</span> <span class="o">=</span> <span class="n">container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;LS de &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># LayerStack associé au conteneur parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span> <span class="o">=</span> <span class="n">parentstack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># couche locale du parent :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentlayer</span> <span class="o">=</span> <span class="n">parentlayer</span>
        <span class="c1"># ref au LayerManager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span> <span class="o">=</span> <span class="n">layerMngr</span>
        <span class="c1"># indice local dans la pile parente :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locallayer</span> <span class="o">=</span> <span class="n">locallayer</span>
        <span class="c1"># couche globale associée à la couche locale 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">container</span><span class="p">,</span> <span class="n">RealContainer</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># offset pour différer les décallages de couches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># dict d&#39;indice de couche locale / LocalLayer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># création de la couche 0 :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_base_layer</span><span class="p">()</span>

<div class="viewcode-block" id="LayerStack.create_base_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.create_base_layer">[docs]</a>    <span class="k">def</span> <span class="nf">create_base_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée la couche 0 à l&#39;initialisation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newlayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_locallayer</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">newlayer</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_create_layer</span><span class="p">(</span><span class="n">newlayer</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerStack.get_base_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.get_base_layer">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la couche 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LayerStack.trace"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.trace">[docs]</a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debug.&quot;&quot;&quot;</span>
        <span class="c1"># debug</span>
        <span class="n">px</span> <span class="o">=</span> <span class="s2">&quot;   &quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">px</span>
            <span class="o">+</span> <span class="s2">&quot; &gt; LayerStack de &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">name</span>
            <span class="o">+</span> <span class="s2">&quot;[local=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locallayer</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; global=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; offset=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; globalrange=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">())</span>
            <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">locallayer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">locallayer</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerStack.is_empty"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.is_empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si la stack est vide de couches.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="LayerStack.add_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.add_item">[docs]</a>    <span class="k">def</span> <span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute un VirtualItem ou VirtualContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newlayer</span> <span class="o">=</span> <span class="n">newstackobj</span> <span class="o">=</span> <span class="n">change1</span> <span class="o">=</span> <span class="n">change2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># liste des couches globales mobilisées</span>
        <span class="n">changelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Création de la couche locale au besoin :</span>
        <span class="n">local_layer</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">local_layer</span>
        <span class="k">if</span> <span class="n">local_layer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">change1</span><span class="p">,</span> <span class="n">newlayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_locallayer</span><span class="p">(</span><span class="n">local_layer</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">change1</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">changelist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">change1</span><span class="p">)</span>
                <span class="c1"># Gestion des modifications par offsets:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_changelist</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">change1</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Enregistrement après propagation des offsets :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_create_layer</span><span class="p">(</span><span class="n">newlayer</span><span class="p">)</span>
        <span class="c1"># En fonction de l&#39;item :</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_stacked</span><span class="p">:</span>
                <span class="n">change2</span><span class="p">,</span> <span class="n">newstackobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_container</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span><span class="o">.</span><span class="n">register_layerstack</span><span class="p">(</span><span class="n">newstackobj</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">change2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">changelist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">change2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">)</span>
        <span class="c1"># Gestion des modifications par offsets:</span>
        <span class="k">if</span> <span class="n">change2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_changelist</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">change2</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Enregistrement après propagation des offsets :</span>
        <span class="k">if</span> <span class="n">newstackobj</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_add_stack</span><span class="p">(</span><span class="n">newstackobj</span><span class="p">)</span>
        <span class="c1"># Retour :</span>
        <span class="k">return</span> <span class="n">changelist</span></div>

<div class="viewcode-block" id="LayerStack.remove_item"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.remove_item">[docs]</a>    <span class="k">def</span> <span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime l&#39;item (son éventuelle hiérarchie est prise en charge par le LayerManager).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># liste des couches globales libérées</span>
        <span class="n">changelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># En fonction de l&#39;item :</span>
        <span class="n">local_layer</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">local_layer</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">VirtualItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_stacked</span><span class="p">:</span>
                <span class="n">change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_container</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">change</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">changelist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_element</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">)</span>
        <span class="c1"># Gestion des modifications :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_changelist</span><span class="p">(</span><span class="n">changelist</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Retour :</span>
        <span class="k">return</span> <span class="n">changelist</span></div>

<div class="viewcode-block" id="LayerStack.handle_changelist"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.handle_changelist">[docs]</a>    <span class="k">def</span> <span class="nf">handle_changelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changelist</span><span class="p">,</span> <span class="n">doadd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gestion des décallages de couches.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">changelist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">doadd</span><span class="p">:</span>
                <span class="n">changelist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">changelist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">changelist</span><span class="p">:</span>
                <span class="n">fromlayer</span> <span class="o">=</span> <span class="n">change</span>
                <span class="k">if</span> <span class="n">doadd</span><span class="p">:</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="c1"># propagation vers le RealContainer</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fire_offset_change</span><span class="p">(</span><span class="n">fromlayer</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerStack.add_element"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.add_element">[docs]</a>    <span class="k">def</span> <span class="nf">add_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute un VirtualItem dans la couche locale local_layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># les éléments sont ajoutés dans la couche globale de base de</span>
        <span class="c1"># la couche locale</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LayerStack.add_container"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.add_container">[docs]</a>    <span class="k">def</span> <span class="nf">add_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute un conteneur dans la couche locale local_layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span>
        <span class="n">newstack</span> <span class="o">=</span> <span class="n">LayerStack</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">)</span>
        <span class="n">changes</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">add_stack</span><span class="p">(</span><span class="n">newstack</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">changes</span><span class="p">,</span> <span class="n">newstack</span></div>

<div class="viewcode-block" id="LayerStack.post_add_stack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.post_add_stack">[docs]</a>    <span class="k">def</span> <span class="nf">post_add_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stackobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistrement d&#39;un LayerStack dans sa couche locale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_layer</span> <span class="o">=</span> <span class="n">stackobj</span><span class="o">.</span><span class="n">locallayer</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">register_stack</span><span class="p">(</span><span class="n">stackobj</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerStack.remove_element"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.remove_element">[docs]</a>    <span class="k">def</span> <span class="nf">remove_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime un VirtualItem de la couche locale local_layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">remove_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LayerStack.remove_container"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.remove_container">[docs]</a>    <span class="k">def</span> <span class="nf">remove_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">local_layer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime un conteneur de la couche locale local_layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span>
        <span class="n">stackobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span><span class="o">.</span><span class="n">get_stack_for_container</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">changes</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">remove_stack</span><span class="p">(</span><span class="n">stackobj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">changes</span></div>

<div class="viewcode-block" id="LayerStack.create_locallayer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.create_locallayer">[docs]</a>    <span class="k">def</span> <span class="nf">create_locallayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crée une couche locale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">indice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># création :</span>
            <span class="n">newlocallayer</span> <span class="o">=</span> <span class="n">LocalLayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span><span class="p">)</span>
            <span class="c1"># placement dans la pile :</span>
            <span class="n">returnrange</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">globind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
                <span class="k">if</span> <span class="n">indice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">indice</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">prevlayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">prevrange</span> <span class="o">=</span> <span class="n">prevlayer</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
                            <span class="n">globind</span> <span class="o">=</span> <span class="n">prevrange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">returnrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">globind</span><span class="p">,</span> <span class="n">globind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">newlocallayer</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">=</span> <span class="n">globind</span>
            <span class="k">return</span> <span class="n">returnrange</span><span class="p">,</span> <span class="n">newlocallayer</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LayerStack.post_create_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.post_create_layer">[docs]</a>    <span class="k">def</span> <span class="nf">post_create_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layerobj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistrement d&#39;une nouvelle couche locale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_layer</span> <span class="o">=</span> <span class="n">layerobj</span><span class="o">.</span><span class="n">locallayer</span>
        <span class="k">if</span> <span class="n">local_layer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">local_layer</span><span class="p">]</span> <span class="o">=</span> <span class="n">layerobj</span></div>

<div class="viewcode-block" id="LayerStack.delete_layer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.delete_layer">[docs]</a>    <span class="k">def</span> <span class="nf">delete_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime l&#39;entrée associée à l&#39;indice de la couche.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">indice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span></div>

<div class="viewcode-block" id="LayerStack.apply_offset"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.apply_offset">[docs]</a>    <span class="k">def</span> <span class="nf">apply_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">swaplist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique les décallages cumulés de couches, retourne une liste de swaps à appliquer</span>
<span class="sd">        aux couches globales physiques.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">swaplist</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">swaplist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">swaptup</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">swaptup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">swaplist</span><span class="p">:</span>
                <span class="n">swaplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">swaptup</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">publication_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span>
        <span class="k">for</span> <span class="n">locallayer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">locallayer</span><span class="o">.</span><span class="n">apply_offset</span><span class="p">(</span><span class="n">swaplist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">swaplist</span></div>

<div class="viewcode-block" id="LayerStack.fire_offset_change"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.fire_offset_change">[docs]</a>    <span class="k">def</span> <span class="nf">fire_offset_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remonte l&#39;événement de décallage jusqu&#39;au RealContainer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">container</span> <span class="o">==</span> <span class="n">RealContainer</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># on propage vers le bas :</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">delta</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">register_offset</span><span class="p">(</span><span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># on remonte :</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span><span class="o">.</span><span class="n">fire_offset_change</span><span class="p">(</span><span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></div>

<div class="viewcode-block" id="LayerStack.register_offset"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.register_offset">[docs]</a>    <span class="k">def</span> <span class="nf">register_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre un décallage delta à appliquer ultérieurement aux couches globales &gt;= fromlayer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">&gt;=</span> <span class="n">fromlayer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="n">delta</span>
        <span class="k">for</span> <span class="n">locallayer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">locallayer</span><span class="o">.</span><span class="n">register_offset</span><span class="p">(</span><span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_globallayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span>

    <span class="k">def</span> <span class="nf">_set_globallayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">=</span> <span class="n">val</span>
        <span class="c1"># initialisation au besoin de la couche de base :</span>
        <span class="n">baselayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_base_layer</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">baselayer</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">baselayer</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">baselayer</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span>

    <span class="n">globallayer</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_globallayer</span><span class="p">,</span> <span class="n">_set_globallayer</span>
    <span class="p">)</span>  <span class="c1">#: indice de la couche globale associée</span>

<div class="viewcode-block" id="LayerStack.get_globalrange"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LayerStack.html#labpyproject.core.pygame.core.LayerStack.get_globalrange">[docs]</a>    <span class="k">def</span> <span class="nf">get_globalrange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste consécutive de couches globales associées à la hiérarchie.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">globalrange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">startind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="n">stopind</span> <span class="o">=</span> <span class="n">startind</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">locallayer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locallayerdict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">childrange</span> <span class="o">=</span> <span class="n">locallayer</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">childrange</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">childrange</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">stopind</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">stopind</span><span class="p">,</span> <span class="n">childrange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">stopind</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">stopind</span><span class="p">,</span> <span class="n">startind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">globalrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">startind</span><span class="p">,</span> <span class="n">stopind</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">globalrange</span></div></div>


<div class="viewcode-block" id="LocalLayer"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer">[docs]</a><span class="k">class</span> <span class="nc">LocalLayer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Modélise une couche locale de conteneur.**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentstack</span><span class="p">,</span> <span class="n">locallayer</span><span class="p">,</span> <span class="n">layerMngr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructeur</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            parentstack (LayerStack): LayerStack du conteneur parent    </span>
<span class="sd">            locallayer (int): indice local dans la pile parente</span>
<span class="sd">            layerMngr (LayerManager): gestionnaire de zindexs mobilisé</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># LayerStack associé au conteneur parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span> <span class="o">=</span> <span class="n">parentstack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;- LL &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">locallayer</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; de &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># ref au LayerManager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span> <span class="o">=</span> <span class="n">layerMngr</span>
        <span class="c1"># indice local dans la pile parente :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locallayer</span> <span class="o">=</span> <span class="n">locallayer</span>
        <span class="c1"># couche globale associée à la couche de base :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># offset pour différer les décallages de couches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># liste des VirtualItems de la couche de base :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Liste des LayerStack au dessus de la couche de base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<div class="viewcode-block" id="LocalLayer.trace"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.trace">[docs]</a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debug.&quot;&quot;&quot;</span>
        <span class="c1"># debug</span>
        <span class="n">px</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">px</span> <span class="o">=</span> <span class="s2">&quot;   &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentstack</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">px</span>
            <span class="o">+</span> <span class="s2">&quot; * LocalLayer&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;[local=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locallayer</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; global=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; offset=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; globalrange=&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">())</span>
            <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="o">+</span> <span class="n">px</span>
                    <span class="o">+</span> <span class="s2">&quot; - &quot;</span>
                    <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span>
                    <span class="o">+</span> <span class="s2">&quot; layers : glob.=&quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">global_layer</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot; pub.=&quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">publication_layer</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">childstack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="n">childstack</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">)</span></div>

<div class="viewcode-block" id="LocalLayer.is_empty"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.is_empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indique si la couche est vide d&#39;éléments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="LocalLayer.add_element"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.add_element">[docs]</a>    <span class="k">def</span> <span class="nf">add_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute un VirtualItem à la couche de base.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="n">child</span><span class="o">.</span><span class="n">publication_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span></div>

<div class="viewcode-block" id="LocalLayer.add_stack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.add_stack">[docs]</a>    <span class="k">def</span> <span class="nf">add_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childstack</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute un LayerStack au dessus de la couche de base, sans l&#39;enregistrer (cf propagation offsets). </span>
<span class="sd">        Retourne une range de couches globales utilisées par la pile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">globalrange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
        <span class="n">indice</span> <span class="o">=</span> <span class="n">globalrange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">childstack</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="n">childstack</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">=</span> <span class="n">indice</span>
            <span class="n">returnrange</span> <span class="o">=</span> <span class="n">childstack</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">returnrange</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LocalLayer.register_stack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.register_stack">[docs]</a>    <span class="k">def</span> <span class="nf">register_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childstack</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ajoute la pile à la liste des piles locales.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">childstack</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">childstack</span><span class="p">)</span></div>

<div class="viewcode-block" id="LocalLayer.remove_element"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.remove_element">[docs]</a>    <span class="k">def</span> <span class="nf">remove_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime un VirtualItem de la couche de base.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span></div>

<div class="viewcode-block" id="LocalLayer.remove_stack"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.remove_stack">[docs]</a>    <span class="k">def</span> <span class="nf">remove_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childstack</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supprime un layerStack. </span>
<span class="sd">        Retourne une range de couches globales libérées par la pile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">childstack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="n">returnrange</span> <span class="o">=</span> <span class="n">childstack</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">childstack</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layerMngr</span><span class="o">.</span><span class="n">unregister_layerstack</span><span class="p">(</span><span class="n">childstack</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">returnrange</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LocalLayer.apply_offset"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.apply_offset">[docs]</a>    <span class="k">def</span> <span class="nf">apply_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">swaplist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applique les décallages cumulés de couches, retourne une liste de swaps à appliquer</span>
<span class="sd">        aux couches globales physiques.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">swaptup</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">swaptup</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">swaplist</span><span class="p">:</span>
                <span class="n">swaplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">swaptup</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">childstack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="n">childstack</span><span class="o">.</span><span class="n">apply_offset</span><span class="p">(</span><span class="n">swaplist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsetlocked</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="LocalLayer.update_items"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.update_items">[docs]</a>    <span class="k">def</span> <span class="nf">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Met à jour les couches globales des items.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemslist</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">publication_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span></div>

<div class="viewcode-block" id="LocalLayer.register_offset"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.register_offset">[docs]</a>    <span class="k">def</span> <span class="nf">register_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enregistre un décallage delta à appliquer ultérieurement aux couches globales &gt;= fromlayer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">&gt;=</span> <span class="n">fromlayer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="n">delta</span>
        <span class="k">for</span> <span class="n">childstack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
            <span class="n">childstack</span><span class="o">.</span><span class="n">register_offset</span><span class="p">(</span><span class="n">fromlayer</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_globallayer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span>

    <span class="k">def</span> <span class="nf">_set_globallayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globallayer</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">globallayer</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_get_globallayer</span><span class="p">,</span> <span class="n">_set_globallayer</span>
    <span class="p">)</span>  <span class="c1">#: indice de la couche globale associée</span>

<div class="viewcode-block" id="LocalLayer.get_globalrange"><a class="viewcode-back" href="../../../../api/labpyproject.core.pygame.core.LocalLayer.html#labpyproject.core.pygame.core.LocalLayer.get_globalrange">[docs]</a>    <span class="k">def</span> <span class="nf">get_globalrange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne la liste consécutive de couches globales associées à la hiérarchie.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">globalrange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">startind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globallayer</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
            <span class="n">stopind</span> <span class="o">=</span> <span class="n">startind</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">childstack</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childstacklist</span><span class="p">:</span>
                <span class="n">childrange</span> <span class="o">=</span> <span class="n">childstack</span><span class="o">.</span><span class="n">get_globalrange</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">childrange</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">stopind</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">stopind</span><span class="p">,</span> <span class="n">childrange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">stopind</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">stopind</span><span class="p">,</span> <span class="n">startind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">globalrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">startind</span><span class="p">,</span> <span class="n">stopind</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">globalrange</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 - Gabriel Leroy - Licence GPL

    </p>
  </div>
    
    
    
    Compilé avec <a href="http://sphinx-doc.org/">Sphinx</a> en utilisant un
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">thème</a>
    
    fourni par <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>